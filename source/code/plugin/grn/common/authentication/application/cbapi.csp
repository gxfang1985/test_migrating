<?php
/**
 * CBApi Login/Authentication Driver Name
 *
 * @author  Eiji TAEN 2006/08
 * @version 1.0
 */

require_once('grn/authentication.csp');

function plugin_grn_common_authentication_application_cbapi($page_parts)
{
    $driver_name = null;

    if (strcmp($page_parts[0], 'cbapi') !== 0) {
        return $driver_name;
    }

    global $G_INPUT;
    $api_id = array_key_exists('api_id', $G_INPUT) ? $G_INPUT['api_id'] : '';
    require_once('cbapi/resources.csp');
    if (defined('GRN_CBAPI_API_CODE_' . strtoupper($api_id)) !== false
        && strcmp($api_id, 'time') !== 0
        && strcmp($api_id, 'auth') !== 0
        && strcmp($api_id, 'default') !== 0
    ) {
        $driver_name = 'cbapi';
    }

    //Return Driver Name
    return $driver_name;
}


