<?php

/**
 * @author  T.Tosaka        2006/03
 * @package grn.workflow
 */

require_once('cellular/component.csp');

class plugin_grn_workflow_cellular_component extends GRN_Cellular_ComponentBase
{

    function __construct()
    {
        parent::__construct('workflow');
    }

    function isAvailable()
    {
        global $G_container_base;
        $uum =& $G_container_base->getInstance('uum');
        $login =& $uum->getLoginUser();

        require_once('workflow/application.csp');
        $app_locator = GRN_ApplicationLocator::instance();
        /** @var GRN_Workflow_Application $app */
        $app =& $app_locator->getInstance(GRN_WORKFLOW_APPLICATION_ID);
        if ( ! $app) {
            return false;
        }

        /* GTM-529
        if( method_exists( $app, 'isAvailableFor_cellular' ) )
            return $app->isAvailableFor_cellular( $login );
        */

        return true;
    }

    function isSupported($key)
    {
        if ($key == 'icon') {
            return true;
        }
        if ($key == 'index') {
            return true;
        }

        return false;
    }

    function getContent($key)
    {
        if ($key == 'icon') {
            return $this->getIcon();
        }
        if ($key == 'index') {
            return $this->getIndex();
        }

        return false;
    }

    function getIcon()
    {
        return 'ok';
    }

    function getIndex()
    {
        return [
            'type'   => 'link',
            'page'   => 'workflow/cellular/list',
            'icon'   => $this->getIcon(),
            'params' => null,
        ];
    }
}


