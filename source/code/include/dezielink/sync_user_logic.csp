<?php

/**
 * Dezie/Office Link Sync User Logic
 */
require_once('dezielink/resources.csp');
require_once('dezielink/sync_user_logic_base.csp');
require_once('dezielink/error_code.csp');

/**
 * Class For DezieLink Sync User Logic
 */
class GRN_DezieLink_SyncUserLogic extends GRN_Connector_SyncUserLogicBase
{
    /**
     * Constructor for DezieLink Sync User
     *
     * @param string $url
     */
    function __construct($url)
    {
        $this->_url = $url;
        $this->_charset = 'SJIS-win';
        $this->_user_account
            = GRN_DZLK_SYNC_USER_ACCOUNT;
        $this->_temp_file_name
            = GRN_DZLK_POST_DATA_XML_TEMP_FILE_NAME;
        $this->_sync_user_lock_file
            = GRN_DZLK_SYNC_USER_LOCK_FILE;
        $this->_logger_message_http_error
            = GRN_DZLK_LOGGER_MESSAGE_HTTP_ERROR;
        $this->_logger_message_auth_error
            = GRN_DZLK_LOGGER_MESSAGE_AUTH_ERROR;
        $this->_logger_message_connection_error
            = GRN_DZLK_LOGGER_MESSAGE_CONNECTION_ERROR;
        $this->_error_key_http_error
            = E_GRN_DZLK_HTTP_ERROR;
        $this->_error_key_auth_error
            = E_GRN_DZLK_SYNC_USER_SERVER_ERROR;
        $this->_error_key_connection_error
            = E_GRN_DZLK_DEZIE_CONNECTION_ERROR;
        $this->_error_key_auth_method_incompatible
            = E_GRN_DZLK_AUTH_METHOD_INCOMPATIBLE;
        $this->_error_key_auth_method_disabled
            = E_GRN_DZLK_AUTH_METHOD_DISABLED;
        $this->error_key_sync_user_script_already_running
            = E_GRN_DZLK_SYNC_USER_SCRIPT_ALREADY_RUNNING;
        parent::__construct();
    }

    /**
     * @param string $url
     *
     * @return GRN_DezieLink_SyncUserLogic
     */
    public static function getInstance($url)
    {
        static $_instance = null;
        if (is_null($_instance)) {
            $_instance = new GRN_DezieLink_SyncUserLogic($url);
        }

        return $_instance;
    }
}

/**
 * Class For OfficeLink Sync User Logic
 */
class GRN_OfficeLink_SyncUserLogic extends GRN_Connector_SyncUserLogicBase
{
    /**
     * Constructor for OfficeLink Sync User
     *
     * @param string $url
     */
    function __construct($url)
    {
        $this->_url = $url;
        $this->_charset = 'UTF-8';
        $this->_user_account
            = GRN_OFLK_SYNC_USER_ACCOUNT;
        $this->_temp_file_name
            = GRN_OFLK_POST_DATA_XML_TEMP_FILE_NAME;
        $this->_sync_user_lock_file
            = GRN_OFLK_SYNC_USER_LOCK_FILE;
        $this->_logger_message_http_error
            = GRN_OFLK_LOGGER_MESSAGE_HTTP_ERROR;
        $this->_logger_message_auth_error
            = GRN_OFLK_LOGGER_MESSAGE_AUTH_ERROR;
        $this->_logger_message_connection_error
            = GRN_OFLK_LOGGER_MESSAGE_CONNECTION_ERROR;
        $this->_error_key_http_error
            = E_GRN_OFLK_HTTP_ERROR;
        $this->_error_key_auth_error
            = E_GRN_OFLK_SYNC_USER_SERVER_ERROR;
        $this->_error_key_connection_error
            = E_GRN_OFLK_OFFICE_CONNECTION_ERROR;
        $this->_error_key_auth_method_incompatible
            = E_GRN_OFLK_AUTH_METHOD_INCOMPATIBLE;
        $this->_error_key_auth_method_disabled
            = E_GRN_OFLK_AUTH_METHOD_DISABLED;
        $this->error_key_sync_user_script_already_running
            = E_GRN_OFLK_SYNC_USER_SCRIPT_ALREADY_RUNNING;
        parent::__construct();
    }

    /**
     * @param string $url
     *
     * @return GRN_OfficeLink_SystemLogic
     */
    public static function getInstance($url)
    {
        static $_instance = null;
        if (is_null($_instance)) {
            $_instance = new GRN_OfficeLink_SyncUserLogic($url);
        }

        return $_instance;
    }
}
