<?php

namespace grn\mail\screen\personal\automation\command;

use grn\mail\automation\AutomaticEventFacade;
use grn\mail\automation\MailAutomaticEventValidator;

class CommandDelete implements CommandAutomationResponse
{

    private $accountId;
    private $eventId;
    private $user;

    public function __construct($input)
    {
        $this->user = cb_get_login_user();
        $this->accountId = $input["accountId"];
        $this->eventId = $input["eventId"];
        $this->facade = new AutomaticEventFacade();
    }

    public function getResponse()
    {

        $this->facade->deleteEventByEventId(
            $this->user->getOID(),
            $this->accountId,
            $this->eventId
        );

        return [
            "result"   => "ok",
            "redirect" => cb_format_url(
                "mail/personal/automation",
                [
                    "accountId" => $this->accountId
                ]
            )
        ];
    }
}
