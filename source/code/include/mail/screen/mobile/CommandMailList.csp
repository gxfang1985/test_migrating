<?php

namespace grn\mail\screen\mobile;

class CommandMailList extends MobileMailScreenBase
{
    private $_mail_ids;

    public function __construct($input)
    {
        parent::__construct($input);
        $this->_mail_ids = cb_at($input, 'ids');
    }

    public function read()
    {
        $mail_ids = $this->_mail_ids;
        if (is_array($mail_ids) && (count($mail_ids) > 0)) {
            $mail_logic = $this->getMailLogic();
            $timestamp = new \CB_TimeStampEx();
            foreach ($mail_ids as $mail_id) {
                $mail_logic->readMail($mail_id, $timestamp, false, true);
            }

            return $mail_ids;
        }

        return false;
    }

    public function unread()
    {
        $user = cb_get_login_user();
        $mail_ids = $this->_mail_ids;
        if (is_array($mail_ids) && (count($mail_ids) > 0)) {
            return $this->getMailLogic()->unreadMails($user, $mail_ids);
        }

        return false;
    }
}
