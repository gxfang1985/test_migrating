<?php
require_once('grn/application.csp');
require_once('presence/error_code.csp');
require_once('presence/resources.csp');

/**
 *  Presence Applicaton
 *
 * @pakage grn.presence
 */
class GRN_Presence_Application extends GRN_ApplicationBase
{
    /**
     * Contructor
     */
    function __construct()
    {
        parent::__construct(GRN_PRESENCE_APPLICATION_ID);
    }

    /**
     * System Setting
     */
    function getSystemConfigArray()
    {
        $config = [];
        $config[] = [
            'page' => 'presence/system/common_set',
            'icon' => 'general32'
        ];
        $config[] = [
            'page' => 'presence/system/status_set',
            'icon' => 'presence32'
        ];
        $config[] = [
            'page' => 'presence/system/access_index',
            'icon' => 'groupadmin32'
        ];
        $config[] = [
            'page' => 'presence/system/access_import1',
            'icon' => 'import32'
        ];
        $config[] = [
            'page' => 'presence/system/access_export',
            'icon' => 'export32'
        ];

        return ['presence_config' => $config];
    }

    /**
     * Personal Setting
     */
    function getPersonalConfigArray()
    {
        $config = [];
        $config[] = [
            'page' => 'presence/personal/status_set',
            'icon' => 'presence32'
        ];

        require_once('presence/config.csp');
        $config_manager = GRN_Presence_ConfigManager::getInstance();
        $system_config = $config_manager->getSystemConfig();
        if ($system_config->getShowProxySettingsMenu()) {
            $config[] = [
                'page' => 'presence/personal/agent_set',
                'icon' => 'groupadmin32'
            ];
        }

        return ['presence_config' => $config];
    }

    /**
     * Portlet list
     *
     * @return array
     */
    function getPortletList()
    {
        $ret = [
            [
                'name'          => cb_msg('grn.presence', 'view_attendee'),
                'type'          => 'grn.presence.attendee',
                'version'       => '1.0',
                'view_template' => 'presence/portlet/view_attendee.csp'
            ]
        ];

        return $ret;
    }
}


