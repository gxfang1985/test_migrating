<?php

/**
 * Cabinet設定クラス
 *
 * @author  TrungNguyen        2007/06
 * @package grn.cabinet
 */

define('GRN_CABINET_CONFIG_TRASH_PERIOD', 'trash_period');
define('GRN_CABINET_CONFIG_MAX_DOWNLOAD_SIZE', 'bundle_download_max_size');

/**
 * @package grn.cabinet
 */
class GRN_Cabinet_SystemConfig
{
    /** @var GRN_Cabinet_SystemConfig */
    private static $_instance = null;

    /**
     * @return GRN_Cabinet_SystemConfig
     */
    public static function getInstance()
    {
        if ( ! isset(self::$_instance)) {
            $c = __CLASS__;
            self::$_instance = new $c;
        }

        return self::$_instance;
    }

    /**
     * @access private
     */
    var $_profile = null;

    function __construct()
    {
        require_once('fw/profile.csp');
        $this->_profile = cb_get_system_profile('grn.cabinet');
    }


    function _set($attr_name, $value)
    {
        if ( ! $this->_profile->updateAttribute($attr_name, $value)) {
            return $this->_profile->createAttribute($attr_name, $value);
        }

        return true;
    }

    function getTrashPeriod()
    {
        $value = 5; // default value //GTM-528
        $this->_profile->getAttribute(GRN_CABINET_CONFIG_TRASH_PERIOD, $value);

        return $value;
    }


    function setTrashPeriod($value)
    {
        $this->_set(GRN_CABINET_CONFIG_TRASH_PERIOD, $value);
    }

    /**
     * 一括ダウンロードでのサイズ上限
     */
    function setBundleDownloadMaxSize($size)
    {
        $this->_set(GRN_CABINET_CONFIG_MAX_DOWNLOAD_SIZE, $size);
    }

    function getBundleDownloadMaxSize()
    {
        $value = 30720; // default value
        $this->_profile->getAttribute(GRN_CABINET_CONFIG_MAX_DOWNLOAD_SIZE,
            $value);

        return $value;
    }
}

