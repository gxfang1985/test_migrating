<?php

namespace grn\schedule\api\model;


class RepeatInfo
{
    const EVERY_DAY = 'EVERY_DAY';
    const EVERY_WEEKDAY = 'EVERY_WEEKDAY';
    const EVERY_WEEK = 'EVERY_WEEK';
    const EVERY_1STWEEK = 'EVERY_1STWEEK';
    const EVERY_2NDWEEK = 'EVERY_2NDWEEK';
    const EVERY_3RDWEEK = 'EVERY_3RDWEEK';
    const EVERY_4THWEEK = 'EVERY_4THWEEK';
    const EVERY_LASTWEEK = 'EVERY_LASTWEEK';
    const EVERY_MONTH = 'EVERY_MONTH';

    const TYPE = "type";
    const PERIOD = 'period';
    const PERIOD_START = 'start';
    const PERIOD_END = 'end';
    const TIME = 'time';
    const TIME_START = 'start';
    const TIME_END = 'end';
    const IS_START_ONLY = 'isStartOnly';
    const IS_ALL_DAY = 'isAllDay';
    const DAY_OF_MONTH = 'dayOfMonth';
    const DAY_OF_WEEK = 'dayOfWeek';
    const TIME_ZONE = 'timeZone';

    /**
     * @var RepeatInfoRange $range
     */
    private $range;
    /**
     * @var string $type Condition of repeating
     */
    private $type;
    /**
     * @var string $startDate Start Date
     */
    private $startDate;
    /**
     *
     * @var string $endDate End Date
     */
    private $endDate;
    /**
     * @var string $startTime Start Time
     */
    private $startTime;

    /**
     * @var string $endTime End Time
     */
    private $endTime;


    /**
     * @var string $timeZone Time zone
     */
    private $timeZone;
    /**
     * @var boolean $isAllday is all day schedule
     */
    private $isAllday;

    /**
     * @var boolean $startOnly is start Only schedule
     */
    private $isStartOnly;

    /**
     * @var string $dayOfWeek The day of week (MON/TUE/WED/THU/FRI/SAT/SUN)
     */
    private $dayOfWeek;
    /**
     * @var string $dayOfMonth The day which is if repeatInfo/type is "month"
     */
    private $dayOfMonth;
    /**
     * @var ExclusiveDateTime[] $exclusiveDateTimes The list of exclusive datetime
     */
    private $exclusiveDateTimes;

    public function __construct(
        $type = null,
        $start_date = null,
        $end_date = null,
        $time_zone = null,
        $day_of_week = null,
        $day_of_month = null,
        $range = null,
        $exclusive_date_times = null
    ) {
        $this->type = $type;
        $this->startDate = $start_date;
        $this->endDate = $end_date;
        $this->timeZone = $time_zone;
        $this->dayOfWeek = $day_of_week;
        $this->dayOfMonth = $day_of_month;
        $this->range = $range;
        $this->exclusiveDateTimes = $exclusive_date_times;
    }

    public function getRange()
    {
        return $this->range;
    }

    public function setRange($range)
    {
        $this->range = $range;
    }

    public function getType()
    {
        return $this->type;
    }

    public function setType($type)
    {
        $this->type = $type;
    }

    public function getStartDate()
    {
        return $this->startDate;
    }

    public function setStartDate($start_date)
    {
        $this->startDate = $start_date;
    }

    public function getEndDate()
    {
        return $this->endDate;
    }

    public function setEndDate($end_date)
    {
        $this->endDate = $end_date;
    }

    public function getTimeZone()
    {
        return $this->timeZone;
    }

    public function setTimeZone($time_zone)
    {
        $this->timeZone = $time_zone;
    }

    public function getDayOfWeek()
    {
        return $this->dayOfWeek;
    }

    public function setDayOfWeek($day_of_week)
    {
        $this->dayOfWeek = $day_of_week;
    }

    public function getDayOfMonth()
    {
        return $this->dayOfMonth;
    }

    public function setDayOfMonth($day_of_month)
    {
        $this->dayOfMonth = $day_of_month;
    }

    public function getExclusiveDateTimes()
    {
        return $this->exclusiveDateTimes;
    }

    public function getStartTime()
    {
        return $this->startTime;
    }

    public function setStartTime($startTime)
    {
        $this->startTime = $startTime;
    }

    public function getEndTime()
    {
        return $this->endTime;
    }

    public function setEndTime($endTime)
    {
        $this->endTime = $endTime;
    }

    public function getIsAllday()
    {
        return $this->isAllday;
    }

    public function setIsAllday($isAllday)
    {
        $this->isAllday = $isAllday;
    }

    public function getIsStartOnly()
    {
        return $this->isStartOnly;
    }

    public function setIsStartOnly($is_start_only)
    {
        $this->isStartOnly = $is_start_only;
    }

    public function addExclusiveDateTime(ExclusiveDateTime $exclusiveDateTime)
    {
        $exclusive_date_times = $this->exclusiveDateTimes ?? [];
        $exclusive_date_times[] = $exclusiveDateTime;
        $this->exclusiveDateTimes = $exclusive_date_times;
    }

    public function setExclusiveDateTimes($exclusive_date_times)
    {
        $this->exclusiveDateTimes = $exclusive_date_times;
    }

    public static function getMappingType($repeat_type)
    {
        $type = null;
        switch ($repeat_type) {
            case 'DAY':
                $type = self::EVERY_DAY;
                break;
            case 'WEEKDAY':
                $type = self::EVERY_WEEKDAY;
                break;
            case 'WEEK':
                $type = self::EVERY_WEEK;
                break;
            case '1STWEEK':
                $type = self::EVERY_1STWEEK;
                break;
            case '2NDWEEK':
                $type = self::EVERY_2NDWEEK;
                break;
            case '3RDWEEK':
                $type = self::EVERY_3RDWEEK;
                break;
            case '4THWEEK':
                $type = self::EVERY_4THWEEK;
                break;
            case 'LASTWEEK':
                $type = self::EVERY_LASTWEEK;
                break;
            case 'MONTH':
                $type = self::EVERY_MONTH;
                break;
        }

        return $type;
    }

    public function toArray()
    {
        $data = [];
        if ($this->type !== null) {
            $data['type'] = $this->type;
        }
        if ($this->startDate !== null) {
            $data['period']['start'] = $this->startDate;
        }
        if ($this->endDate !== null) {
            $data['period']['end'] = $this->endDate;
        }
        if ($this->startTime !== null) {
            $data['time']['start'] = $this->startTime;
        }
        if ($this->endTime !== null) {
            $data['time']['end'] = $this->endTime;
        }
        if ($this->timeZone !== null) {
            $data['timeZone'] = $this->timeZone;
        }
        if ($this->isAllday !== null) {
            $data['isAllDay'] = $this->isAllday;
        }
        if ($this->isStartOnly !== null) {
            $data['isStartOnly'] = $this->isStartOnly;
        }
        if ($this->dayOfWeek !== null) {
            $data['dayOfWeek'] = $this->dayOfWeek;
        }
        if ($this->dayOfMonth !== null) {
            $data['dayOfMonth'] = $this->dayOfMonth;
        }
        if ($this->range !== null) {
            $data['range'] = $this->range->toArray();
        }
        if ($this->exclusiveDateTimes !== null) {
            $data['exclusiveDateTimes'] = $this->exclusiveDateTimes;
        }

        return $data;
    }
}
