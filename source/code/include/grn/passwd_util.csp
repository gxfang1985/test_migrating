<?php
/**
 * Garoon Password Utility for Old Version
 *
 * @author  Yuichi, Nakamura 2005/03
 * @version 1.0
 */

/**
 * Provide utility routines to implement passwords.
 *
 * @package fw.core
 */
class GRN_PasswordUtil
{
    /**
     * Constructor
     *
     * @access private
     */
    function __construct()
    {

    }

    /**
     *
     * Hash Password (MD5)
     *
     * @param  string $password //Raw Password
     *
     * @return string $hashed_password           //Hashed Password
     */
    function hashPassword($password)
    {
        $hashed_password = md5($password);

        return $hashed_password;
    }

    /**
     * Validate user-supplied password.
     *
     * @param  string $password        //Raw Password
     * @param  string $hashed_password //Hashed Password
     *
     * @return bool   $result                    //Validate Result
     */
    public static function validatePassword($password, $hashed_password)
    {
        //Check Empty Password
        if ($password === '' && $hashed_password === '') {
            return true;
        }

        //Check Password
        return (strcasecmp(md5($password), $hashed_password) === 0);
    }
}


