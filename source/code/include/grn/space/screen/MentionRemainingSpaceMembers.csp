<?php
declare(strict_types=1);

namespace grn\grn\space\screen;

use grn\grn\mention\screen\MentionRemainingMembers;
use grn\grn\mention\MentionController;
use grn\space\common\logic\CommentLogic;

require_once('grn/smarty.csp');

class MentionRemainingSpaceMembers extends MentionRemainingMembers
{
    /**
     * @param int $offset
     *
     * @return array
     * @throws \grn\space\common\exception\GrnDataNotFoundException
     * @throws \grn\space\common\exception\GrnDatabaseException
     */
    protected function getMembers(int $offset = 0): array
    {
        global $G_INPUT;
        $comment_id = isset($G_INPUT['comment_id'])
            ? intval($G_INPUT['comment_id']) : null;
        $comment_logic = new CommentLogic();
        $comment = $comment_logic->getComment($comment_id);
        $mention = $comment->getMention();
        $members
            = MentionController::createMemberListsForView([$comment_id => $mention],
            $offset);

        return $members[$comment_id] ?? [];
    }
}
