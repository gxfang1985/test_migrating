<?php

namespace grn\grn\mobile;

use grn\grn\GrnScreenCommon;

class MobileScreenCommon extends GrnScreenCommon
{
    /**
     * @param \grn\grn\GrnGenericScreenBase $main_screen Main screen object
     */
    public function __construct($main_screen)
    {
        parent::__construct($main_screen);
        $this->setCommonTemplateFile('grn/mobile_common.tpl');
    }

    /**
     * Override GrnScreenCommon::extendFetch
     *
     * @param \GRN_Smarty $smarty
     */
    protected function extendFetch($smarty)
    {
        $smarty->assign('remove_footer', $this->getRemoveFooter());
        $smarty->assign('product_term', cb_get_product_term(CB_TYPE_TEXT));
        $smarty->assign('copyright', cb_get_copyright(CB_TYPE_TEXT));
        $smarty->assign('application_id', $this->getApplicationId());
        $smarty->assign('application_menu', $this->getApplicationMenu());
        $smarty->assign('operate_menu', $this->getOperateMenu());
        $smarty->assign('footer_bar', $this->getFooterBar());
        global $G_state_set;
        $smarty->assign('kunai_api_version',
            $G_state_set->get('kunai_api_version'));
        $smarty->assign('is_cybozu_browser',
            $G_state_set->get('is_cybozu_browser'));
    }

    /**
     * Get application id from the main screen
     *
     * @return string
     */
    protected function getApplicationId()
    {
        return $this->getMainScreen()->getMobileApplicationId();
    }

    /**
     * Get setting "remove_footer" from the mail screen
     *
     * @return boolean TRUE: remove the footer; FALSE: leave the footer
     */
    protected function getRemoveFooter()
    {
        return $this->getMainScreen()->getRemoveFooter();
    }

    public function getSitePosition()
    {
        return [];
    }

    /**
     * Get application menu
     *
     * @return array
     */
    protected function getApplicationMenu()
    {
        return $this->getMainScreen()->getMobileApplicationMenu();
    }

    /**
     * Get operate menu
     *
     * @return array
     */
    protected function getOperateMenu()
    {
        return $this->getMainScreen()->getMobileOperateMenu();
    }

    /**
     * Get footer bar
     *
     * @return array
     */
    protected function getFooterBar()
    {
        return $this->getMainScreen()->getMobileFooterBar();
    }
}
