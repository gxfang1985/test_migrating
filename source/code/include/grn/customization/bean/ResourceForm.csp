<?php

namespace grn\grn\customization\bean;

class ResourceForm
{
    /**
     * @var array
     */
    private $input;

    /**
     * @var \GRN_UploadFile[]
     */
    private $uploadedFiles;

    public function __construct(array $input)
    {
        $this->input = $input;

        require_once('grn/upload.csp');
        $upload_ticket = $input['upload_ticket'] ?? null;
        $upload_file_ids = array_merge($this->getJsInputFileIds(),
            $this->getCssInputFileIds());
        $this->uploadedFiles = \GRN_UploadFile::getUploadedFiles($upload_ticket,
            $upload_file_ids, true);
    }

    /**
     * @return string[]
     */
    public function getJsInputFileIds()
    {
        return $this->removeEmptyElement($this->input['js_ids'] ?? []);
    }

    /**
     * @return string[]
     */
    public function getCssInputFileIds()
    {
        return $this->removeEmptyElement($this->input['css_ids'] ?? []);
    }

    /**
     * @return string[]
     */
    public function getJsLinks()
    {
        return $this->removeEmptyElement($this->input['js_links'] ?? []);
    }

    /**
     * @return string[]
     */
    public function getCssLinks()
    {
        return $this->removeEmptyElement($this->input['css_links'] ?? []);
    }

    /**
     * @param array $elements
     *
     * @return array
     */
    private function removeEmptyElement(array $elements)
    {
        return array_filter($elements);
    }

    /**
     * @return \GRN_UploadFile[]
     */
    public function getUploadedFiles()
    {
        return $this->uploadedFiles;
    }
}
