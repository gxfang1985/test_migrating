<?php

namespace grn\grn\customization\schedule;

use grn\grn\customization\JsApiEventInterface;

class CalendarDayIndexShowJsApiEvent implements JsApiEventInterface
{
    /**
     * @var array
     */
    private $input;

    /**
     * CalendarMonthShowJsApiEvent constructor.
     *
     * @param array $screen_properties
     */
    public function __construct(array $screen_properties)
    {
        $this->input = $screen_properties;
    }

    /**
     * @return string
     */
    public function getEventName(): string
    {
        return 'schedule.calendar.dayIndex.show';
    }

    /**
     * @return array
     */
    public function getInitData(): array
    {
        $init_data = [];
        //When display the portlet screen
        if (isset($this->input['portletId'])) {
            $init_data['portletId'] = $this->input['portletId'];
        }

        return $init_data;
    }

    /**
     * @return array
     */
    public function getEventData(): array
    {
        $dates = [];
        foreach ($this->input['week'] as $week) {
            $dates[] = $week['format'];
        }

        $event_data = ['viewType' => 'DAY', 'dates' => $dates];
        if (isset($this->input['no_trigger'])) {
            $event_data['no_trigger'] = $this->input['no_trigger'];
        }

        return $event_data;
    }
}
