<?php

namespace grn\grn\security;

class XXssProtectionHttpHeader
{
    /**
     * Set "X-XSS-Protection" header according to the x_xss_protection setting.
     */
    public static function setHeaderIfNeeded()
    {
        if (self::isNeeded()) {
            header('X-XSS-Protection: 1; mode=block');
        }
    }

    /**
     * @return bool Returns TRUE if x_xss_protection setting is ON. Otherwise, return FALSE.
     */
    private static function isNeeded()
    {
        if (defined('ON_FOREST')) {
            return false;
        }

        global $G_config_common;
        $x_xss_protection = $G_config_common->get('Global', 'x_xss_protection');
        $is_needed = $x_xss_protection !== "0";

        return $is_needed;
    }
}
