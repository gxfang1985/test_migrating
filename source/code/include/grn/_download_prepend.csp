<?php
require_once('fw/miscFunctions.csp');
require_once('fw/ui.csp');
require_once('grn/error_code.csp');

if ( ! cb_is_need_download_ticket()) {
    return;
}

require('fw/csrf_list.csp');
if (in_array(cb_get_pagename(), $G_download_ticket_white_list)) {
    return;
}

global $G_INPUT;
$ticket = @ $G_INPUT['ticket'];

require_once('grn/ticket.csp');
if ( ! GRN_Ticket::validate($ticket)) {
    cb_throw_error(E_GRN_USERS_FILE_NOT_FOUND);
}

