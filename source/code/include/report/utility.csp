<?php

/**
 * ユーティリティ関数
 *
 * @package grn.report
 * @version 1.0
 */

/**
 * N件ナビゲーションUIデータを生成する
 *
 * @param $total_count int  一覧の総数
 *
 * @reutrn array
 */
function grn_make_n_navigation($total_count, $params = null, $limit = 5)
{
    require_once('grn/controller.csp');
    $utility = new GRN_ControllerUtil();

    global $G_INPUT;

    $offset = grn_report_get_offset();

    //Update Start Position
    $utility->setNaviStartPosition($offset);

    //Return Navigation Infomation
    return $utility->makeNaviInformation($offset, $limit, $total_count,
        $params);
}

function grn_report_get_offset()
{
    global $G_INPUT;

    $offset = 0;
    if (array_key_exists('sp', $G_INPUT)) {
        //Get Start Position from SP Value
        $offset = intval($G_INPUT['sp']);
    } elseif (array_key_exists('sf', $G_INPUT)) {
        if ($G_INPUT['sf'] === '1') {
            //Get Start Position from Session
            require_once('grn/controller.csp');
            $utility = new GRN_ControllerUtil();
            $offset = $utility->getNaviStartPosition();
        }
    }

    return $offset;
}

