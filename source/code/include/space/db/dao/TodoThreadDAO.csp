<?php

namespace grn\space\db\dao;

use grn\space\common\db\dao\DataAccessControlAbstract;
use grn\space\common\exception\GrnDatabaseException;


/**
 * Database Back Layer
 * This layer mediates the database front layer and the DB.
 *
 * TodoThread Facade Data Access Object Class
 * Accept requests from the database front layer for all TodoThread
 **/
class TodoThreadDAO extends DataAccessControlAbstract
{
    /**
     * The insert of thread todo is executed to the database.
     *
     * @param string $todoId   todo sequence id
     * @param string $threadId thread sequence id
     *
     * @throws GrnDatabaseException     Any error in the database.
     */
    public function insertTodoThread($todoId, $threadId)
    {
        try {
            $dbConn = $this->getDatabaseConnection();

            $query
                = "INSERT INTO tab_grn_space_todo_thread (col_todo, col_thread) VALUES ";
            $query .= "(";
            $query .= "'" . $dbConn->escape($todoId) . "', ";
            $query .= "'" . $dbConn->escape($threadId) . "'  ";
            $query .= ")";
            $query .= ";";

            $dbConn->query($query);
        } catch (GrnDatabaseException $e) {
            //将来的にはGrnDatabaseExceptionをキャッチしたい。
            //In the future you want to catch the GrnDatabaseException.
            throw $e;
        }
    }
}
