<?php

namespace grn\space\db\dao;

use grn\space\common\db\dao\DataAccessControlAbstract;
use grn\space\common\exception\GrnDatabaseException;
use grn\space\common\exception\GrnDataNotFoundException;


/**
 * Database Back Layer
 * This layer mediates the database front layer and the DB.
 *
 * TodoFile Data Access Object Class
 * Accept requests from the database front layer for all TodoFile
 **/
class TodoFileDAO extends DataAccessControlAbstract
{
    /**
     * The insert of todo-file-relation is executed to the database.
     *
     * @param string $todoId todo sequence id
     * @param string $fileId file sequence id
     *
     * @throws GrnDatabaseException     Any error in the database.
     */
    public function insertTodoFileReletion($todoId, $fileId)
    {
        try {
            $dbConn = $this->getDatabaseConnection();

            $query
                = "INSERT INTO tab_grn_space_todo_file (col_todo, col_file) VALUES ";
            $query .= "('" . $dbConn->escape($todoId) . "','"
                      . $dbConn->escape($fileId) . "')";
            $query .= ";";

            $dbConn->query($query);
        } catch (GrnDatabaseException $e) {
            //将来的にはGrnDatabaseExceptionをキャッチしたい。
            //In the future you want to catch the GrnDatabaseException.
            throw $e;
        }
    }
}
