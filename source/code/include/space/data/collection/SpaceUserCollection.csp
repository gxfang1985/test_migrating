<?php

namespace grn\space\data\collection;

use grn\space\common\data\collection\SpaceMemberCollection;
use grn\space\data\bean\SpaceUser;
use grn\space\common\data\bean\BeanAbstract;

/**
 * Class SpaceUserCollection
 *
 */
class SpaceUserCollection extends SpaceMemberCollection
{
    /**
     * コンストラクタ
     */
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * 保持するBeanオブジェクト配列に、SpaceUserオブジェクトを追加する
     *
     * @param     BeanAbstract $bean Object that implements Space
     * @param     bool         $is_count
     */
    public function appendBean(BeanAbstract $bean, $is_count = true)
    {
        assert('$bean instanceof grn\space\data\bean\SpaceUser');
        parent::appendBean($bean);
    }

    /**
     * @param $offset
     * @param $limit
     *
     * @return SpaceUserCollection
     */
    public function getTop($offset = 0, $limit = -1)
    {
        $no_limit = ($limit == -1);

        $result = new SpaceUserCollection();

        $all_user = $this->getIterator();
        $count = 0;

        foreach ($all_user as $user) {
            $count++;
            if ($count < $offset) {
                continue;
            }
            if (( ! $no_limit) && $count > $limit) {
                break;
            }

            $result->appendBean($user);
        }

        return $result;
    }
}
