<?php
declare(strict_types=1);

namespace grn\api\http;

use grn\api\exception\request\MethodNotAllowedException;

class HttpMethod
{
    const GET = "GET";
    const POST = "POST";
    const PUT = "PUT";
    const PATCH = "PATCH";
    const DELETE = "DELETE";

    const ALLOWED_METHOD
        = [
            self::GET,
            self::POST,
            self::PUT,
            self::PATCH,
            self::DELETE
        ];

    const REQUIRED_CONTENT_TYPE_METHOD
        = [
            self::POST,
            self::PUT,
            self::PATCH
        ];

    /**
     * @return string
     * @throws MethodNotAllowedException
     */
    public static function getRequestMethod(): string
    {
        $request_method = $_SERVER["REQUEST_METHOD"] ?? "";
        if ( ! in_array($request_method, self::ALLOWED_METHOD)) {
            throw new MethodNotAllowedException();
        }

        return $request_method;
    }

    /**
     * @param string $http_method
     *
     * @return bool
     */
    public static function isRequiredContentType(string $http_method)
    {
        if (in_array($http_method, HttpMethod::REQUIRED_CONTENT_TYPE_METHOD)) {
            return true;
        }

        return false;

    }
}
