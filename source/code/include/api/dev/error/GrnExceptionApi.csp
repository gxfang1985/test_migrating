<?php
declare(strict_types=1);

namespace grn\api\dev\error;

use grn\api\http\HttpStatus;
use grn\api\ResponseEntity;
use grn\api\http\response\Record;
use grn\api\RestApi;
use grn\grn\GrnException;

class GrnExceptionApi extends RestApi
{
    public function execute(array $params): ResponseEntity
    {
        $input = $this->getInput();
        $message = $input["message"] ?? null;
        $cause = $input["cause"] ?? null;
        $counter = $input["counter"] ?? null;
        $developer = $input["developer"] ?? null;

        $is_throw_error = true;
        if ($is_throw_error) {
            if (array_key_exists('code', $params)) {
                $grn_exception = new GrnException($params['code']);
                $grn_exception->setDiagnosis($message);
                $grn_exception->setCause($cause);
                $grn_exception->setCounter($counter);
                $grn_exception->setDeveloperInfo($developer);
                throw $grn_exception;
            }
            throw new GrnException();
        }
        $response_entity = new ResponseEntity(new Record(null),
            new HttpStatus(HttpStatus::OK));

        return $response_entity;
    }
}
