<?php

class NotificationFacade
{
    private function getConnection($userId)
    {
        require_once("grn/notification.csp");

        return grn_notification_get_connection($userId);
    }

    private function getPersonalTableName($userId, $tableName)
    {
        require_once("grn/notification.csp");

        return grn_get_personal_tablename($userId, $tableName);
    }

    /**
     *
     * @param string                         $userId
     * @param GrnNotificationSearchCondition $searchCondition
     * @param                                $number_of_all
     *
     * @return array
     */
    public function searchForNotificationByCondition(
        $userId,
        $searchCondition,
        & $number_of_all
    ) {
        try {
            $dataObj = [
                "db" => $this->getConnection($userId),
            ];

            $daoFctry = DAOFactory::getDAOFactory(DAOFactory::$MYSQL);
            $dao = $daoFctry->getGrnNotificationDAO();

            return $dao->searchForNotification($dataObj, $searchCondition,
                $number_of_all);
        } catch (CBException $e) {

        }
    }

    /**
     *
     * @param   string $userId
     * @param   object $searchCondition
     *
     * @return array
     */
    public function getSpaceIdWithinNotification($userId, $searchCondition)
    {
        $dataObj = [
            "db" => $this->getConnection($userId),
        ];
        $daoFctry = DAOFactory::getDAOFactory(DAOFactory::$MYSQL);
        $dao = $daoFctry->getGrnNotificationDAO();

        return $dao->getSpaceIdWithinNotification($dataObj, $searchCondition);
    }

    /**
     * @param string $userId
     * @param        $searchCondition
     *
     * @return array
     */
    public function getSpaceNotifyIds($userId, $searchCondition)
    {
        $dataObj = [
            "db" => $this->getConnection($userId),
        ];
        $daoFactory = DAOFactory::getDAOFactory(DAOFactory::$MYSQL);
        $dao = $daoFactory->getGrnNotificationDAO();

        return $dao->getSpaceNotifyIds($dataObj, $searchCondition);
    }
}

