<?php

namespace grn\kunai\screen;

use grn\kunai\data\bean\log\KunaiAvailabilityDeleteAllLog;
use grn\kunai\service\KunaiService;

class SystemAvailabilityUserDeleteAll extends KunaiScreenBase
{
    public function fetch()
    {
        $page_name = $this->getPageName();
        require_once('grn/smarty.csp');
        $smarty = new \GRN_Smarty();

        return $smarty->fetch($page_name . '.tpl');
    }

    public function post($input)
    {
        $kunai_service = new KunaiService();
        $result = $kunai_service->deleteAllAvailability();
        if ($result) {
            $kunai_service->getKunaiLogLogic()
                          ->notice(new KunaiAvailabilityDeleteAllLog);
        }
    }

    public function getSitePosition()
    {
        $page_infos = [
            'availability_user_list'       => [],
            'availability_user_delete_all' => null
        ];

        return $this->makeSitePosition(self::PATH_SYSTEM, $page_infos);
    }
}
