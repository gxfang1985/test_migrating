<?php

namespace grn\kunai\data\bean\log;

use grn\space\common\data\LogInterface;

class KunaiAvailabilityModifyLog implements LogInterface
{
    const ACTION_MODIFY = 'modify';
    const OBJECT_AVAILABILITY_MODIFY = 'availability_user_modify';

    /**
     * @var string
     */
    private $_action;

    /**
     * @var string
     */
    private $_object;

    /**
     * @var string
     */
    private $_target_type;

    /**
     * @var string
     */
    private $_target_id;

    /**
     * @var object
     */
    private $_availability;

    public function __construct()
    {
        $this->setAction(self::ACTION_MODIFY);
        $this->setObject(self::OBJECT_AVAILABILITY_MODIFY);
        $this->_target_type = '';
        $this->_target_id = '';
        $this->_availability = '';
    }

    /**
     * @param string $action
     */
    public function setAction($action)
    {
        $this->_action = $action;
    }

    /**
     * @return string
     */
    public function getAction()
    {
        return $this->_action;
    }

    /**
     * @param string $object
     */
    public function setObject($object)
    {
        $this->_object = $object;
    }

    /**
     * @return string
     */
    public function getObject()
    {
        return $this->_object;
    }

    /**
     * @param string $target_type
     */
    public function setTargetType($target_type)
    {
        $this->_target_type = $target_type;
    }

    /**
     * @return string
     */
    public function getTargetType()
    {
        return $this->_target_type;
    }

    /**
     * @param string $target_id
     */
    public function setTargetId($target_id)
    {
        $this->_target_id = $target_id;
    }

    /**
     * @return string
     */
    public function getTargetId()
    {
        return $this->_target_id;
    }

    /**
     * @param object $availability
     */
    public function setAvailability($availability)
    {
        $this->_availability = $availability;
    }

    /**
     * @param  string $key
     *
     * @return object
     */
    public function getAvailability()
    {
        return $this->_availability;
    }

    public function getParameters()
    {
        $retval = [];
        $retval[$this->getTargetType()] = $this->getTargetId();
        $availability = $this->getAvailability();
        $app_status = $availability->getAppStatus();
        foreach ($app_status as $app => $status) {
            $retval[$app] = $status ? 1 : 0;
        }

        return $retval;
    }
}
