<?php

namespace grn\fts;

class AddressView
{
    /* @var string $name */
    private $name;
    /* @var string $historyUrl */
    private $historyUrl;

    const HISTORY_URL = "mail/exchange_history";

    /**
     *
     * @param string $from
     * @param string $mailId
     */
    public function __construct($from, $mailId)
    {
        require_once('fw/mail_message.csp');
        $fromInfo = \CB_MailAddress::static_parse($from);

        $name = (strlen($fromInfo->name) > 0) ? $fromInfo->name
            : $fromInfo->address;
        $this->setName($name);
        $this->setHistoryUrl($this->createHistoryUrl($mailId,
            $fromInfo->address));
    }

    /**
     *
     * @param string $name
     */
    public function setName($name)
    {
        $this->name = $name;
    }

    /**
     *
     * @return string
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     *
     * @param string $historyUrl
     */
    public function setHistoryUrl($historyUrl)
    {
        $this->historyUrl = $historyUrl;
    }

    /**
     *
     * @return string
     */
    public function getHistoryUrl()
    {
        return $this->historyUrl;
    }

    /**
     *
     * @param string $mailId
     * @param string $email
     *
     * @return string
     */
    private function createHistoryUrl($mailId, $email)
    {
        $params = ['mid' => $mailId, 'email' => $email];

        return cb_format_url(self::HISTORY_URL, $params);
    }
}

