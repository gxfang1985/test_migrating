<?php

namespace grn\fts;

use grn\fts\bulletin\DocumentConverter as BulletinDocumentConverter;
use grn\fts\message\DocumentConverter as MessageDocumentConverter;
use grn\fts\cabinet\DocumentConverter as CabinetDocumentConverter;
use grn\fts\space\DocumentConverter as SpaceDocumentConverter;
use grn\fts\mail\DocumentConverter as MailDocumentConverter;

class DocumentConverter implements DocumentConverterInterface
{
    /**
     * Convert a search result to view data of Garoon.
     *
     * @param \grn\fts\SearchDocumentInterface $document
     *
     * @return \grn\fts\DocumentView
     */
    public function convert(SearchDocumentInterface $document)
    {
        $converter = $this->getApplicationDocumentConverter($document);

        return $converter->convert($document);
    }

    /**
     * @param \grn\fts\SearchDocumentInterface $document
     *
     * @return \grn\fts\DocumentConverterInterface
     */
    private function getApplicationDocumentConverter(
        SearchDocumentInterface $document
    ) {
        switch ($document->getApplication()) {
            case SearchConstants::APPLICATION_BULLETIN:
                $converter = new BulletinDocumentConverter();
                break;
            case SearchConstants::APPLICATION_MESSAGE:
                $converter = new MessageDocumentConverter();
                break;
            case SearchConstants::APPLICATION_CABINET:
                $converter = new CabinetDocumentConverter();
                break;
            case SearchConstants::APPLICATION_SPACE:
                $converter = new SpaceDocumentConverter();
                break;
            case SearchConstants::APPLICATION_MAIL:
                $converter = new MailDocumentConverter();
                break;
            default:
                assert('FALSE');
                break;
        }

        /* @var \grn\fts\DocumentConverterInterface $converter */

        return $converter;
    }
}
