<?php

namespace grn\fts;

require_once('grn/cli.csp');

class IndexerLogger implements IndexerLoggerInterface
{
    /** @var bool */
    private $debug = false;

    public function __construct(array $input)
    {
        $this->parseInput($input);
    }

    private function parseInput(array $input)
    {
        if (isset($input['debug']) && $input['debug']) {
            $this->setDebug(true);
        }
    }

    /**
     * Log a message.
     *
     * @param $message
     */
    public function log($message)
    {
        $date = date("r");
        $line = "[{$date}] {$message}\n";

        echo($line);

        if ($this->isDebug()) {
            echo("Memory Current Usage: " . memory_get_usage(true) . "\n");
            echo("Memory Peak Usage: " . memory_get_peak_usage(true) . "\n");
        }
    }

    /**
     * @param boolean $debug
     */
    public function setDebug($debug)
    {
        $this->debug = $debug;
    }

    /**
     * @return boolean
     */
    public function isDebug()
    {
        return $this->debug;
    }
}
