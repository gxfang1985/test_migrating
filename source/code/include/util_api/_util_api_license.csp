<?php
require_once('util_api/error_code.csp');

// Check product license.
$lic = cb_get_license_driver();
if ( ! cb_is_versionup_process() && ($lic->forceRedirect()) !== false) {
    cb_throw_error(E_GRN_UTIL_API_LICENSE_EXPIRED);
}

//Check expire
require_once('grn/license.csp');
$lm = GRN_LicenseManager::getInstance();
$license = $lm->getLicense(GRN_LICENSE_BASESYSTEM);

if ($lm->isDemoLicense($license['type'])) {
    $remind_days = $lm->getRemindDays($license['limit']);
    if ($remind_days < 0) {
        cb_throw_error(E_GRN_UTIL_API_LICENSE_EXPIRED);
    }
} else {
    $remind_days = $lm->getRemindDays($license['service_limit'],
        GRN_LICENSE_SERVICE_EXPIRED_OFFSET);
    if ($remind_days < 0) {
        cb_throw_error(E_GRN_UTIL_API_LICENSE_EXPIRED);
    }
}

