<?php

namespace grn\cydec\mq;

/**
 * Class BlobRemoveJobPolicy
 * This class express message for blob remove
 *
 * @package grn\cydec\mq
 */
class BlobRemoveJobMessage extends JobMessage
{

    const NUM_OF_BLOB_LIMIT = 1000;

    /**
     * @param array       $argument
     * @param mixed       $nextArgument
     * @param string|null $nextArgumentType
     *
     * @return bool
     */
    public function exceedsSize(
        array $argument,
        $nextArgument,
        $nextArgumentType = null
    ) {
        return count($argument) + 1 > self::NUM_OF_BLOB_LIMIT;
    }


    /**
     * @param array $arguments
     *
     * @return array
     */
    public function constructMessage(array $arguments)
    {
        return $arguments;
    }

    /**
     * @return string
     */
    public function getJobName()
    {
        return JobNameConstants::BLOB_REMOVER;
    }
}
