<?php

namespace grn\bulletin\logic;

require_once("bulletin/BulletinFacade.csp");

class BulletinUserProfileLogic
{
    const BULLETIN_PERSONAL_ADJUST_SUBSCRIBE = "adjust_subscribe";

    private static $_instance = null;

    /**
     * Constructor
     */
    public function __construct()
    {

    }

    /**
     * @return BulletinUserProfileLogic
     */
    public static function getInstance()
    {
        if ( ! isset(self::$_instance)) {
            $c = __CLASS__;
            self::$_instance = new $c;
        }

        return self::$_instance;
    }

    /**
     *
     * @param \CB_User $user
     * @param string   $adjust_subscribe
     *
     * @return int
     */
    public function setAdjustSubscribe(\CB_User $user, $adjust_subscribe)
    {
        $user_id = $user->getOID();
        if ($adjust_subscribe) {
            $subscribe = 1;
        } else {
            $subscribe = 0;
        }
        $dao = new \BulletinFacade();

        return $dao->insertPersonalAdjustSubscribe($user_id, $subscribe);
    }

    /**
     * @param \CB_User $user
     *
     * @return boolean
     */
    public function getAdjustSubscribe(\CB_User $user)
    {
        $user_id = $user->getOID();
        $dao = new \BulletinFacade();
        $adjust_subscribe = $dao->selectPersonalAdjustSubscribe($user_id);
        if (isset($adjust_subscribe[$user_id]) && $adjust_subscribe[$user_id]) {
            return true;
        }

        return false;
    }
}
