<?php

/**
 * Timecard設定クラス
 *
 * @author  Tanaka, Yoshiaki        2005/03
 * @package grn.timecard
 */

require_once('fw/module.csp');


/**
 * @package grn.timecard
 */
class GRN_Timecard_SystemConfig
{
    private static $_instance = null;

    /**
     * @static
     * @return GRN_Timecard_SystemConfig
     */
    public static function getInstance()
    {
        if ( ! isset(self::$_instance)) {
            $c = __CLASS__;
            self::$_instance = new $c;
        }

        return self::$_instance;
    }

    /**
     * @access private
     */
    var $_profile = null;


    function __construct()
    {
        require_once('fw/profile.csp');
        $this->_profile = cb_get_system_profile('grn.timecard');
    }

    function _set($attr_name, $value)
    {
        if ( ! $this->_profile->updateAttribute($attr_name, $value)) {
            return $this->_profile->createAttribute($attr_name, $value);
        }

        return true;
    }

    // 不在記録の最大数

    function getAbsenceLimit()
    {
        return 6;
    }

    function getAbsenceMax()
    {
        $value = 1;
        $this->_profile->getAttribute('absence_max', $value);

        return $value;
    }

    function setAbsenceMax($value)
    {
        $this->_set('absence_max', $value);
    }

    // 編集許可

    function getEnableModifyRecord()
    {
        $value = true;
        $this->_profile->getAttribute('enable_modify_record', $value);

        return $value;
    }

    function setEnableModifyRecord($value)
    {
        $this->_set('enable_modify_record', $value);
    }

    // 自動打刻

    function getEnableAutoPunchOut()
    {
        $value = true;
        $this->_profile->getAttribute('enable_auto_punchout', $value);

        return $value;
    }

    function setEnableAutoPunchOut($value)
    {
        $this->_set('enable_auto_punchout', $value);
    }

    // 集計開始日

    function getOffsetDay()
    {
        $value = 1; // 初期値
        $this->_profile->getAttribute('offset_day', $value);

        return $value;
    }

    function setOffsetDay($value)
    {
        $this->_set('offset_day', $value);
    }

    // 月度表示

    function getOffsetMonth()
    {
        $value = 0; // 初期値
        $this->_profile->getAttribute('offset_month', $value);

        return $value;
    }

    function setOffsetMonth($value)
    {
        $this->_set('offset_month', $value);
    }

    // 日付の切り替わり

    function getChangeOfDay()
    {
        $value = new CB_Time();
        $value->hour = 4;
        $value->minute = 0;
        $value->second = 0;
        $this->_profile->getAttribute('change_of_day', $value);

        return $value;
    }

    function setChangeOfDay($value)
    {
        $this->_set('change_of_day', $value);
    }
}


