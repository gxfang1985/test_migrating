<?php

namespace grn\system\screen\api;

use grn\grn\customization\logic\ProxySettingLogic;

class CommandProxySettingDelete extends ProxySettingBase
{
    public function post($input)
    {
        $proxy = $this->getProxySetting();
        $proxy_setting_logic = new ProxySettingLogic();
        $proxy_setting_logic->delete($proxy->getId());

        require_once('grn/logger.csp');
        $logger_manager = \CB_LoggerManager::getInstance();
        $logger = $logger_manager->getLogger('grn.common');
        $log_action = 'delete';
        $log_target = 'proxy_api';
        $log_params = sprintf("id:%s, code:'%s'", $proxy->getId(),
            $proxy->getCode());
        $log_message = sprintf("[%s] %s (%s)", $log_action, $log_target,
            $log_params);
        $logger->noticeEx($log_action, $log_target, $log_message);

        cb_redirect('system/api/proxy_list');
    }
}
