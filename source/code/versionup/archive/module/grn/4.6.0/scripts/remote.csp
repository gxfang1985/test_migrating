<?php

function grn460_remote_main()
{
    //////////////////////////////
    // resource update
    //////////////////////////////
    cb_export_log('Started grn460_remote_main. ', false);

    // Start common.ini file
    global $G_config_common;
    cb_export_log("Start update common.ini.", false);

    cb_export_log("Start set API section.", false);
    $G_config_common->set('API', 'version', '1.10.0');
    cb_export_log("End set API section.", false);

    $G_config_common->save();
    cb_export_log("End update common.ini.", false);
    // End common.ini file

    // Start garoon.ini file
    global $G_config_grn;
    cb_export_log("Start update garoon.ini.", false);

    $version = '4.6.0';
    cb_export_log("Start set Locale section.", false);
    $G_config_grn->set('System', 'version', $version);
    $G_config_grn->set('Locale', 'ja_version', $version);
    $G_config_grn->set('Locale', 'en_version', $version);
    $G_config_grn->set('Locale', 'zh_version', $version);
    cb_export_log("End set Locale section.", false);

    $G_config_grn->save();
    cb_export_log("End update garoon.ini.", false);
    // End garoon.ini file

    // Start applications ini file
    $grn_ini_dir = cb_basedir() . '/grn/';
    cb_export_log("Start update 11space.ini.", false);
    $space_ini = $grn_ini_dir . '11space.ini';
    write_ini_item($space_ini, 'version', '4.6.0');
    cb_export_log("End update 11space.ini.", false);

    $websrv_ini = $grn_ini_dir . '40cbwebsrv.ini';
    remove_ini_item($websrv_ini, 'post_url');
    remove_ini_item($websrv_ini, 'tool_research_url');
    remove_ini_item($websrv_ini, 'tool_address_url');
    remove_ini_item($websrv_ini, 'tool_map_url');
    remove_ini_item($websrv_ini, 'tool_route_url');
    $cybozu_web_service_host = "https://cybozu.net";
    write_ini_item($websrv_ini, 'weather_url',
        "{$cybozu_web_service_host}/v1/weather/forecasts.xml");
    write_ini_item($websrv_ini, 'rokuyo_url',
        "{$cybozu_web_service_host}/v1/rokuyo.xml");
    write_ini_item($websrv_ini, 'transit_url',
        "{$cybozu_web_service_host}/v1/transit");
    cb_export_log("End update 40cbwebsrv.ini.", false);

    cb_export_log('Finished grn460_remote_main. ', false);
    // End applications ini file
}

grn460_remote_main();
