<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    global $G_INPUT;

    //Instantiate an Smarty object
    require_once("grn/smarty.csp");
    $t = new GRN_Smarty;

    //Create Parameter Translation Map
    $translation_map = [
        'popup' => 'popup_set',
    ];

    //Do Parameter Translation
    $properties = [];
    foreach ($translation_map as $view_name => $model_name) {
        $properties[$model_name] = @ $G_INPUT[$view_name];
    }

    //Get Link Controller Utility
    require_once('link/controller_util.csp');
    $link_util = GRN_Link_Link_Controller_Utility::getInstance();
    $link_util->setType('system');

    //Set general Configuration
    $link_util->setGeneralConfig($properties);

    //Check Inspection Message Enabled
    require_once('link/inspection.csp');
    $inspection = GRN_Link_Inspection::getInstance();
    if ($inspection->isEnabled()) {
        //Create Popup Information
        if ($properties['popup_set'] == 1) {
            $popup_set = 'title/url';
        } else {
            $popup_set = 'icon';
        }

        //Write Inspection Message
        $inspection->writeInspectionLog('config', 'system_general',
            ['popup_set' => $popup_set]);

    }

    //Redirect Next Page
    cb_redirect('system/application_list', ['app_id' => 'link']);
}

