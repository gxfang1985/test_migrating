<?php

global $G_INPUT;

if ( ! isset($t) || ! is_a($t, 'GRN_Smarty')) {
    require_once("grn/smarty.csp");
    $t = new GRN_Smarty;
}

$category_id = @ $G_INPUT['cid'];

if ( ! array_key_exists('aid', $G_INPUT)) {
    cb_throw_error(E_GRN_BULLETIN_ARTICLE_NOT_FOUND);
}

$article_id = $G_INPUT['aid'];

$t->assign('category_id', $category_id);

// 記事の取得
if ( ! ($article =& $G_bulletin->getArticle($G_bulletin_login, $article_id))) {
    cb_throw_error(E_GRN_BULLETIN_ARTICLE_NOT_FOUND);
}

$article_for_view = [
    'aid'   => $article_id,
    'cid'   => $category_id,
    'title' => $article->get('subject'),
];

$t->assign('article', $article_for_view);

