<?php
// Smarty をインスタンス化
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

$node_id = cb_at($G_INPUT, 'nid');
$node_row = $G_bulletin->getCategory($G_bulletin_login, $node_id);
if ( ! $node_row) {
    cb_throw_error(E_GRN_BULLETIN_CATEGORY_NOT_FOUND);
}

$node = [];
$node['name'] = $node_row->get('name');

$t->assign('node_id', $node_id);
$t->assign('node', $node);

$eid = cb_at($G_INPUT, 'eid');
$t->assign('eid', $eid);
$t->assign('count', is_array($eid) ? count($eid) : 0);

// page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

// site position 
$site_position = [
    [
        'page' => 'bulletin/system/privilege_index',
        'name' => grn_get_page_display_name('bulletin/system/privilege_index'),
        'nid'  => $node_id
    ],
    [
        'page' => 'bulletin/system/privilege_list',
        'name' => grn_get_page_display_name('bulletin/system/privilege_list'),
        'nid'  => $node_id
    ],
    ['page' => '', 'name' => $page_title],
];
$t->assign('site_position', $site_position);

// Smarty実行
$t->display(cb_get_pagename() . ".tpl");

