<?php

global $G_INPUT;

if ( ! isset($t) || ! is_a($t, 'GRN_Smarty')) {
    require_once("grn/smarty.csp");
    $t = new GRN_Smarty;
}

$category_id = GRN_BULLETIN_ROOT_CATEGORY_ID;

if (array_key_exists('nid', $G_INPUT) && strlen($G_INPUT['nid']) > 0
    && $G_INPUT['nid'] > 0
) {
    $category_id = $G_INPUT['nid'];
}

$t->assign('category_id', $category_id);

if ( ! ($category =& $G_bulletin->getCategory($G_bulletin_login,
    $category_id))
) {
    cb_throw_error(E_GRN_BULLETIN_CATEGORY_NOT_FOUND);
}

$t->assign('node_id', $category->getOID());
$t->assign('node', [
    'nid'  => $category->getOID(),
    'name' => $category->get('name'),
]);

$t->assign('poid', @ $G_INPUT['poid']);

$t->assign('notify', ['force' => $category->get('force_notify')]);


