<?php

global $G_INPUT;

if ( ! isset($t) || ! is_a($t, 'GRN_Smarty')) {
    require_once("grn/smarty.csp");
    $t = new GRN_Smarty;
}

$category_id = @ $G_INPUT['cid'];

if ( ! array_key_exists('aid', $G_INPUT)) {
    cb_throw_error(E_GRN_BULLETIN_ARTICLE_NOT_FOUND);
}
if ( ! array_key_exists('follow_id', $G_INPUT)) {
    cb_throw_error(E_GRN_BULLETIN_FOLLOW_NOT_FOUND);
}
$article_id = $G_INPUT['aid'];
$follow_id = $G_INPUT['follow_id'];


if ( ! ($article =& $G_bulletin->getArticle($G_bulletin_login, $article_id))) {
    cb_throw_error(E_GRN_BULLETIN_ARTICLE_NOT_FOUND);
}
if ( ! ($follow =& $article->getFollow($follow_id))) {
    cb_throw_error(E_GRN_BULLETIN_FOLLOW_NOT_FOUND);
}
$follow->isDeletable($G_bulletin_login, true);
$article_for_view = [
    'aid'         => $article_id,
    'cid'         => $category_id,
    'follow_id'   => $follow_id,
    'follow_data' => $follow->get('data'),
];

$t->assign('article', $article_for_view);


