<?php

global $G_INPUT;

// Smarty をインスタンス化
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

//-- get parameters from URL parameters
$nid = @ $G_INPUT['nid'];

$session_name = 'bulletin.operation.notify_add';
$ous_params = ['nid' => $nid];
$can_select_role = true;
$search_login_name = false;
require_once('grn/org_user_role_select.csp');
$t->assign('ous_params', $ous_params);

$t->assign('listbox_size', $navigation_info['navi']['number_on_page'] + 1);

// tree link page
$t->assign('link_page', cb_get_pagename());

//-- page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

//-- site position
require_once('grn/controller.csp');
$controller_util = new GRN_ControllerUtil();


if (@$G_INPUT['nid']) {
    // GRN35-209
    require_once('bulletin/controller.csp');
    $utility = new GRN_Bulletin_ControllerUtil();
    $utility->prepareMakeSitePosition($t, @$G_INPUT['nid'], null,
        @$G_INPUT['nid'], null, null, null, @$G_INPUT['nid'],
        @$G_INPUT['poid']);
    // GRN35-209
} else {
    $t->assign('site_position',
        [
            [
                'page' => 'bulletin/index',
                'name' => grn_get_page_display_name('bulletin/index'),
                'cid'  => $nid,
                'sf'   => 1
            ],
            [
                'page' => 'bulletin/operation/category_view',
                'name' => grn_get_page_display_name('bulletin/operation/category_view'),
                'cid'  => $nid
            ],
            [
                'page'  => 'bulletin/operation/notify_list',
                'name'  => grn_get_page_display_name('bulletin/operation/notify_list'),
                'nid'   => $nid,
                'reset' => 1
            ],
            ['page' => null, 'name' => $page_title]
        ]
    );
}
$t->display(cb_get_pagename() . ".tpl");

