<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    $node_id = cb_at($G_INPUT, 'nid');
    $node_row = $G_bulletin->getCategory($G_bulletin_login, $node_id);
    if ( ! $node_row) {
        cb_throw_error(E_GRN_BULLETIN_CATEGORY_NOT_FOUND);
    }

    $eid = cb_at($G_INPUT, 'eid');
    if ( ! is_array($eid)) {
        $params = ['nid' => $node_id];
        cb_redirect('bulletin/operation/privilege_list', $params);
    }

    require('../_command_privilege_delete_multi.csp');
    if ( ! $privilege_manager->privileged($G_bulletin_login, $node_row,
        'operation')
    ) {
        cb_throw_error(E_GRN_BULLETIN_CANNOT_CHANGE_PRIVILEGE);
    }

    $params = ['nid' => $node_id];
    cb_redirect('bulletin/operation/privilege_list', $params);
}

