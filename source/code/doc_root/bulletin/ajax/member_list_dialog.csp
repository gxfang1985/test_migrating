<?php

use grn\grn\JSONResponse;
use grn\bulletin\screen\AjaxAuthorityReadUserDialogScreen;
use grn\bulletin\screen\AjaxNotificationUserDialogScreen;
use grn\bulletin\screen\AjaxMaintainerDialogScreen;

if (0 == strcasecmp(cb_at($_SERVER, 'REQUEST_METHOD'), 'POST')) {
    global $G_INPUT;
    $anchor_id = cb_at($G_INPUT, 'anchor_id', '');

    if (preg_match('/^user_list_dialog_authority_read_/', $anchor_id)) {
        $screen = new AjaxAuthorityReadUserDialogScreen($G_INPUT);
    } elseif (preg_match('/^user_list_dialog_notification_/', $anchor_id)) {
        $screen = new AjaxNotificationUserDialogScreen($G_INPUT);
    } elseif (preg_match('/^maintainer_list_dialog_/', $anchor_id)) {
        $screen = new AjaxMaintainerDialogScreen($G_INPUT);
    }

    $json = JSONResponse::create();
    $json->response([
        'content'         => $screen->fetch('grn/ajax/member_list_dialog.tpl'),
        'title'           => $screen->getDialogTitle(),
        'use_back_button' => $screen->useBackButton()
    ]);

}
