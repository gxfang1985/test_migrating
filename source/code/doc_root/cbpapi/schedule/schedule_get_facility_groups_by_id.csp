<?php

if (isset($cbpapi_service)) {
    $node_parameters = $cbpapi_service->getRequestParameters();
    $facility_group_ids = $cbpapi_service->selectNodesValue($node_parameters,
        'facility_group_id');
    if ( ! isset($facility_group_ids)) {
        require_once('cbpapi/error_code.csp');
        cb_throw_error(E_GRN_CBPAPI_MISSING_PARAMETER, null,
            ['param' => 'facility_group_id']);
    }

    require_once('cbpapi/schedule_logic.csp');
    $facilitygroupViews
        = grn_cbpapi_get_facilitygroups_by_id_list($facility_group_ids);

    //response SOAP message
    require_once("grn/smarty.csp");
    $t = new GRN_Smarty;
    $t->assign('xml_namespaces', [grn_cbpapi_get_namespace('schedule')]);
    $t->assign('groups', $facilitygroupViews);

    grn_cbpapi_response($t, __FILE__);
}

