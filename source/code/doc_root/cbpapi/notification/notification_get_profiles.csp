<?php
if (isset($cbpapi_service)) {
    $request = $cbpapi_service->getRequestParameters();

    global $G_container_base;
    $uum = $G_container_base->getInstance('uum');
    $login = $uum->getLoginUser();
    unset($uum);

    require_once('grn/notification.csp');
    $notification_service = GRN_Notification_Service::getInstance();
    $personal_conf = $notification_service->getPersonalConfig($login);
    $ret1 = $personal_conf->getSaveDays('notify',
        $notify_savedays);
    $ret2 = $personal_conf->getSaveDays('history',
        $history_savedays);
    if ( ! $ret1 || ! $ret2) {
        cb_throw_error(E_GRN_CMMN_NTFC_FAILED_TO_GET_PROFILE_DATA);
    }
    // SOAP response
    require_once('grn/smarty.csp');
    $t = new GRN_Smarty();
    $t->assign('action', $cbpapi_service->getAction());
    $t->assign('xml_namespaces', [grn_cbpapi_get_namespace('notification')]);
    $t->assign('notify_savedays', $notify_savedays);
    $t->assign('history_savedays', $history_savedays);

    grn_cbpapi_response($t, __FILE__);
}
