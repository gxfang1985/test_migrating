<?php

global $G_INPUT;

require_once('system/logging/file.csp');
$fm = new GRN_Logging_FileManager_Core();

if ( ! ($file_id = @ $G_INPUT['fid'])) {
    cb_throw_error(E_GRN_LOGGING_FILE_NOT_FOUND);
}

if ( ! ($file = &$fm->getFile($file_id))) {
    cb_throw_error(E_GRN_LOGGING_FILE_NOT_FOUND);
}

$body = null;
$body = &$file->getCurrentBody();

if ( ! $body) {
    cb_throw_error(E_GRN_LOGGING_FILE_BODY_NOT_FOUND);
}

$body->download(true);

cb_safe_exit();
