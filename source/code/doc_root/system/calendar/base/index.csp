<?php

require_once('grn/smarty.csp');
$t = new GRN_Smarty;

require_once("grn/controller.csp");
$utility = new GRN_ControllerUtil();

global $G_container_base;
$uum = $G_container_base->getInstance("uum");
$login = $uum->getLoginUser();
require_once('grn/ui.csp');
$uiconfig_manager = GRN_UIConfigManager::getInstance();
$user_config = $uiconfig_manager->getUserConfig($login);
$limit = $user_config->getListMax();

// 一覧開始位置
$offset = $utility->getNaviStartPosition();
$utility->setNaviStartPosition($offset);

require_once("fw/i18n/base.csp");
$t->assign("bases", CB_BaseManager::getBasesView($offset, $limit));

// 一覧ナビゲーション
$t->assign('navi', $utility->makeNaviInformation($offset, $limit,
    count(CB_BaseManager::getBases())));

$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

$t->assign(
    'site_position', [
        0 =>
            [
                'page' => '',
                'name' => $page_title,
            ],
    ]
);

$t->display(cb_get_pagename() . '.tpl');
