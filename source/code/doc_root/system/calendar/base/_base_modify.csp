<?php

require_once('fw/i18n/base.csp');
$base_id = $G_INPUT["bid"];
$base = CB_Base::select($base_id);

if (is_null($base)) {
    cb_throw_error(E_COMMON_BASE_WAS_NOT_FOUND);
}

require_once('fw/i18n/system_config.csp');
$t->assign('display_timezones', CB_I18N_SystemConfig::getDisplayTimezones());

require_once('grn/calendar.csp');
$t->assign('calendars',
    GRN_CalendarManager::getInstance()->listSystemCalendarNames());

$t->assign('base', $base->toViewArray());

require_once('schedule/system_logic.csp');
$systemlogic = GRN_Schedule_SystemLogic::getInstance();
$t->assign('minute_interval', $systemlogic->getScheduleUnit());

$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

$t->assign('site_position', [
    [
        'page' => 'system/calendar/base/index',
        'name' => grn_get_page_display_name("system/calendar/base/index"),
    ],
    [
        'page' => 'system/calendar/base/base_detail',
        'name' => grn_get_page_display_name("system/calendar/base/base_detail"),
        'bid'  => $base->getId()
    ],
    [
        'page' => '',
        'name' => $page_title,
    ],
]);
