<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    // instantiate an Smarty object
    require_once('grn/smarty.csp');
    $t = new GRN_Smarty;

    $scid = @$G_INPUT['scid'];
    $event = @$G_INPUT['event'];

    require_once('grn/calendar.csp');
    $cm = GRN_CalendarManager::getInstance();
    $c = $cm->getSystemCalendar($scid);
    if ( ! $c) {
        cb_throw_error(E_GRN_CALENDAR_CALENDAR_NOT_FOUND);
    }
    $e = $c->getDayInfoById($event);
    if ( ! $e) {
        cb_throw_error(E_GRN_CALENDAR_DAY_NOT_FOUND);
    }
    $c->removeDayInfoById($event);
    $date = $e->get('date');

    cb_redirect('system/calendar/systemcalendar_list',
        ['scid' => $scid, 'bdate' => $date->year]);
}


