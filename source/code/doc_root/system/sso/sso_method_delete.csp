<?php

// instantiate an Smarty object
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

//Get SSO Method ID
$sso_method_id = @ $G_INPUT['smid'];

//Get SSO Method Object
require_once('grn/sso.csp');
$sso_service = GRN_SSO_Service::getInstance();
$sso_method =& $sso_service->getSSOMethod($sso_method_id);

//Create Parameter Translation Map
$translation_Map = [
    'smid'         => '_id',              //SSO Method ID
    'display_name' => 'display_name',     //Display Name
];

//Do Parameter Translation
$sso_method_for_view = [];
foreach ($translation_Map as $view_name => $model_name) {
    if ($model_name === '_id') {
        $sso_method_for_view[$view_name] = $sso_method->getOID();
    } else {
        $sso_method_for_view[$view_name] = $sso_method->get($model_name);
    }
}

//Assign Display Infomation
$t->assign('sso_method', $sso_method_for_view);

//-- set page title and site position

//page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

//site position
$t->assign(
    'site_position', [
        [
            'page' => "system/sso/sso_method_list",
            'name' => grn_get_page_display_name('system/sso/sso_method_list'),
            'sf'   => 1
        ],
        [
            'page' => "system/sso/sso_method_view",
            'name' => grn_get_page_display_name('system/sso/sso_method_view'),
            'smid' => $sso_method_id
        ],
        ['page' => "", 'name' => $page_title]
    ]
);

//Display Smarty Template
$doc_name = cb_get_pagename();
$t->display("{$doc_name}.tpl");


