<?php

$logic = &_grn_get_privilege_logic();

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    /** @var GRN_Uum $uum */
    $uum =& $G_container_base->getInstance('uum');

    $org_id = @ $G_INPUT['oid'];
    $eid = @ $G_INPUT['eid'];

    if (is_array($eid)) {
        $users = $uum->getGroupUsers($org_id);
        foreach ($eid as $uid) {
            unset($users[$uid]);
        }
        $eids = array_keys($users);
        $uum->setGroupUsers($org_id, $eids);
    } else {
        $eid = [];
        $uum->setGroupUsers($org_id, $eid);
    }

    $uum->execInspection('group', 'delete_assign',
        ['gid' => $org_id, 'uids' => implode(',', $eid)]);
    cb_redirect('system/user/org_list', ['oid' => $org_id]);
}
