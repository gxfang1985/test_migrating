<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    // instantiate an Smarty object
    require_once("grn/smarty.csp");
    $t = new GRN_Smarty;

    require_once('grn/system_logic.csp');
    $system = GRN_System::getInstance();
    $permission_to_select_role_before = $system->getPermissionToSelectRole();

    $permission_to_select_role = cb_at($G_INPUT, "permission_to_select_role")
                                 === "1" ? 1 : 0;
    $system->setPermissionToSelectRole($permission_to_select_role);

    if ($permission_to_select_role_before != $permission_to_select_role) {
        $uum = cb_lwc_uum();
        $uum->execInspection('role', 'config', [
            'permission_to_select_role' => ($permission_to_select_role == 1)
                ? 'on' : 'off'
        ]);
    }

    cb_redirect('system/user/role_list');
}
