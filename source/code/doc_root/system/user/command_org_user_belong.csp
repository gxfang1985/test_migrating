<?php

$logic = &_grn_get_privilege_logic();

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    $org_id = @ $G_INPUT['oid'];
    $user_id = @ $G_INPUT['uid'];
    if (0 == strlen($user_id)) {
        assert('FALSE');
    }

    require_once('fw/session_manager.csp');
    $session_manager = CB_SessionManager::getInstance();
    $session
        =& $session_manager->getSession('grn.system.org_user_belong');
    $org_ids = $session->get('org_ids');

    global $G_container_base;
    /** @var GRN_Uum $uum */
    $uum =& $G_container_base->getInstance('uum');
    $uum->setUserGroups($user_id, array_keys($org_ids));
    $uum->execInspection('user', 'belong',
        ['uid' => $user_id, 'gids' => implode(',', array_keys($org_ids))]);

    cb_redirect('system/user/org_user_view',
        ['oid' => $org_id, 'uid' => $user_id]);
}


