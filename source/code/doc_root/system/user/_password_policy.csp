<?php

require_once('grn/system_logic.csp');
$system = GRN_System::getInstance();
$set['is_empty_login'] = $system->getPasswordEmptyLogin();
$set['is_personal_config'] = $system->getPasswordEnablePersonalConfig();
$set['password_length'] = [
    'options'  => [0, 1, 2, 3, 4, 5, 6, 7, 8],
    'selected' => $system->getPasswordLength()
];
$set['expiration_interval'] = $system->getPasswordExpirationInterval();
$set['warning_before'] = $system->getPasswordWarningBefore();

require_once('grn/strong_password.csp');
$strong_passwd_available_options = [
    'alpha'        => GRN_STRONG_PASSWD_OPTION_ALPHA,
    'alphamix'     => GRN_STRONG_PASSWD_OPTION_ALPHAMIX,
    'numeral'      => GRN_STRONG_PASSWD_OPTION_NUMERAL,
    'symbol'       => GRN_STRONG_PASSWD_OPTION_SYMBOL,
    'banned_words' => GRN_STRONG_PASSWD_OPTION_BANNEDWORDS
];

$strong_passwd_set = $system->getPasswordComplex();
$strong_passwd_for_view = [];
if ($strong_passwd_set == false) {
    $strong_passwd_for_view['options'] = $strong_passwd_available_options;
} else {
    $strong_passwd_for_view['enable'] = $strong_passwd_set['enable'];
    foreach ($strong_passwd_available_options as $option => $value) {
        if (($strong_passwd_set['options'] & $value) == $value) {
            $strong_passwd_for_view['options'][$option] = true;
        }
    }
}

$set['strong_password'] = $strong_passwd_for_view;

$t->assign('set', $set);

$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);
$t->assign(
    'site_position',
    [
        ['page' => "", 'name' => $page_title],
    ]
);


