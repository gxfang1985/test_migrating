<?php

require_once('fw/session_manager.csp');
$session_manager = CB_SessionManager::getInstance();
$session =& $session_manager->getSession('system');
$role_list = $session->get('role_list');
if (is_null($role_list)) {
    $role_list = [];
}

$func = @ $G_INPUT['role_set_func'];
if ($func == 'add_roles') {
    $rids = $G_INPUT['c_rid'];
    foreach ($rids as $id) {
        $role_list[] = $id;
    }
    $role_list = array_unique($role_list);
    sort($role_list);
} elseif ($func == 'remove_roles') {
    $rids = $G_INPUT['s_rid'];
    foreach ($rids as $id) {
        unset($role_list[array_search($id, $role_list)]);
    }
}

$session->set('role_list', $role_list);

