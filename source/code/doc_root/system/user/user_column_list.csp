<?php

//-- instantiate Smarty object
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

global $G_container_base;
/** @var GRN_Uum $uum */
$uum =& $G_container_base->getInstance('uum');


$item_values = &$uum->getDefaultDisplayItemProperties();
$default_columns_for_view = [];
foreach ($item_values as $id => $properties) {
    $properties['display_name'] = $uum->getRealDefaultItemName($id);
    $properties['id'] = $id;
    $default_columns_for_view[$id] = $properties;
}


//hide attendee 公開する and 一覧表示
$default_columns_for_view['attendee']['show_disabled'] = 1;
$default_columns_for_view['attendee']['show'] = 1;
$default_columns_for_view['attendee']['display_disabled'] = 1;
$default_columns_for_view['attendee']['display'] = 1;

$extension_columns = $uum->listItems();
$static_extensions = $uum->staticExtensionProperties($extension_columns);

$extension_columns_for_view = [];
$keys = array_keys($extension_columns);
foreach ($keys as $key) {
    $column =& $extension_columns[$key];

    $extension_columns_for_view[$column->getOID()] = [
        'display_name'        => $column->get('display_name'),
        'id'                  => $column->get('id'),
        'type'                => $column->get('type'),
        'use'                 => $column->get('use'),
        'necessary'           => $column->get('necessary'),
        'not_modify'          => $column->get('not_modify'),
        'show'                => $column->get('show'),
        'display'             => $column->get('display'),
        'search'              => $column->get('search'),
        'use_disabled'        => $static_extensions[$key]['use_disabled'],
        'necessary_disabled'  => $static_extensions[$key]['necessary_disabled'],
        'not_modify_disabled' => $static_extensions[$key]['not_modify_disabled'],
        'show_disabled'       => $static_extensions[$key]['show_disabled'],
        'display_disabled'    => $static_extensions[$key]['display_disabled'],
        'search_disabled'     => $static_extensions[$key]['search_disabled'],
        'sso_disabled'        => $static_extensions[$key]['sso_disabled']
    ];
    if (_isApplicationLicensed('cellular')) {
        $extension_columns_for_view[$column->getOID()]['cellular']
            = $column->get('cellular');
        $extension_columns_for_view[$column->getOID()]['cellular_disabled']
            = $static_extensions[$key]['cellular_disabled'];
    }
    unset($column);
}
unset($keys);
unset($extension_columns);

$t->assign('default_columns', $default_columns_for_view);
$t->assign('extension_columns', $extension_columns_for_view);

//-- set page title and site position

// use $page_title for both page title and site position
$page_title = grn_get_current_page_display_name();

// set page title
$t->assign('page_title', $page_title);

// set site position
$t->assign(
    'site_position',
    [
        ['page' => "", 'name' => $page_title],
    ]
);


//-- show page
$t->display(cb_get_pagename() . '.tpl');


