<?php

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    $role_id = @ $G_INPUT['role_id'];   // ロールID
    $user_ids = @ $G_INPUT['eid'];  // 削除する付与ユーザーID

    if (is_null($role_id) || 0 == strlen($role_id)) {
        assert('FALSE');
    }

    if (is_array($user_ids) && 0 < count($user_ids)) {
        global $G_container_base;
        /** @var GRN_Uum $uum */
        $uum =& $G_container_base->getInstance('uum');
        foreach ($user_ids as $user_id) {
            $uum->removeUserRole($user_id, $role_id);
        }
    }

    $uum->execInspection('role', 'delete_assign',
        ['rid' => $role_id, 'uids' => implode(',', $user_ids)]);

    // 組織一覧ページにリダイレクトする
    cb_redirect('system/user/role_list', ['role_id' => $role_id]);
}


