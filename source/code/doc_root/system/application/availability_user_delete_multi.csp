<?php

global $G_INPUT;

require_once('grn/smarty.csp');
$t = new GRN_Smarty;

$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);
$page_name = cb_get_pagename();

$selected_dynamic_roles = "";
if (array_key_exists('selected_dynamic_roles', $G_INPUT)
    && array_key_exists('string', $G_INPUT['selected_dynamic_roles'])
) {
    $selected_dynamic_roles
        = trim($G_INPUT['selected_dynamic_roles']['string']);
}
$t->assign('selected_dynamic_roles', $selected_dynamic_roles);

$selected_static_roles = "";
if (array_key_exists('selected_static_roles', $G_INPUT)
    && array_key_exists('string', $G_INPUT['selected_static_roles'])
) {
    $selected_static_roles = trim($G_INPUT['selected_static_roles']['string']);
}
$t->assign('selected_static_roles', $selected_static_roles);

$selected_groups = "";
if (array_key_exists('selected_groups', $G_INPUT)
    && array_key_exists('string', $G_INPUT['selected_groups'])
) {
    $selected_groups = trim($G_INPUT['selected_groups']['string']);
}
$t->assign('selected_groups', $selected_groups);

$selected_users = "";
if (array_key_exists('selected_users', $G_INPUT)
    && array_key_exists('string', $G_INPUT['selected_users'])
) {
    $selected_users = trim($G_INPUT['selected_users']['string']);
}
$t->assign('selected_users', $selected_users);

$selected_dynamic_roles_number = ($selected_dynamic_roles == "") ? 0
    : count(explode(":", $selected_dynamic_roles));
$selected_static_roles_number = ($selected_static_roles == "") ? 0
    : count(explode(":", $selected_static_roles));
$selected_groups_number = ($selected_groups == "") ? 0
    : count(explode(":", $selected_groups));
$selected_users_number = ($selected_users == "") ? 0
    : count(explode(":", $selected_users));

$t->assign('user_total',
    $selected_dynamic_roles_number + $selected_static_roles_number
    + $selected_groups_number + $selected_users_number);

//Page Information
$page_infos = [
    'availability_user_list'         => [],
    'availability_user_delete_multi' => null
];
require_once('grn/controller.csp');
$controller_util = new GRN_ControllerUtil($page_name);
$site_position = $controller_util->makeSitePosition('system/application/',
    $page_infos);
$t->assign('site_position', $site_position);

$t->display("{$page_name}.tpl");


