<?php

use grn\grn\access\utility\AppAvailabilityUtil;

//-- instantiate Smarty object
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

$session_name = 'system.availability_user_add';
$ous_params = [];
//GRN35-321
$can_select_role = true;
//GRN35-321
$search_login_name = true;
require_once('grn/org_user_role_select.csp');
$t->assign('ous_params', $ous_params);

$t->assign('listbox_size', $navigation_info['navi']['number_on_page'] + 1);

// tree link page
$t->assign('link_page', cb_get_pagename());

//-- page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

//-- site position
require_once('grn/controller.csp');
$controller_util = new GRN_ControllerUtil();
$page_info = [
    'availability_user_list' => [],
    'availability_user_add'  => null
];
$site_position = $controller_util->makeSitePosition('system/application/',
    $page_info);
$t->assign('site_position', $site_position);

$applications_for_view = [];
$app_ids = AppAvailabilityUtil::getActiveAppIds();

foreach ($app_ids as $app_id) {
    $applications_for_view[$app_id] = ['app_id' => $app_id, 'active' => true];

}
$t->assign('can_use_external_access',
    \grn\grn\access\logic\AvailabilitySettingLogic::getExternalAccessSetting());
$t->assign('display_app_list',
    1);// this is flag display or not displayed applist
$t->assign('menu_list', $applications_for_view);
$t->display(cb_get_pagename() . '.tpl');

