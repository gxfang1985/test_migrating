<?php

use grn\grn\access\bean\Availability;
use grn\grn\access\logic\AvailabilitySettingLogic;

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    global $G_INPUT;

    $app_setting_logic = new AvailabilitySettingLogic();
    $target_type_map = [
        Availability::DYNAMIC_ROLE,
        Availability::STATIC_ROLE,
        Availability::GROUP,
        Availability::USER
    ];
    foreach ($target_type_map as $type) {
        $app_setting_logic->deleteAll($type);
    }

    //writing the log
    require_once('grn/logger.csp');
    $logger_manager = CB_LoggerManager::getInstance();
    $_logger = &$logger_manager->getLogger('grn.common');
    $message = [];
    $_logger->noticeEx('delete', 'availability_user_delete_all', $message);
    cb_redirect('system/application/availability_user_list', []);
}


