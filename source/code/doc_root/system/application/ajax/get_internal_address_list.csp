<?php

use grn\grn\access\logic\InternalIpAddressLogic;
use grn\grn\JSONResponse;

if (strcasecmp(cb_at($_SERVER, 'REQUEST_METHOD'), 'POST') == 0) {

    global $G_INPUT;
    global $G_state_set;

    $internal_ip_address_logic = new InternalIpAddressLogic();
    $ip_collection = $internal_ip_address_logic->getAll();
    $ip_list = [];

    foreach ($ip_collection as $ip) {
        $ip_list[] = $ip->toArray();
    }

    $json = JSONResponse::create();
    $json->response(['ip_list' => $ip_list]);

    $G_state_set->set('html_should_be_closed', false);
    $G_state_set->set('copyright_should_be_written', false);
}
