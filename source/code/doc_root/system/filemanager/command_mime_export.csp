<?php

$charset = 'SJIS';
if (array_key_exists('charset', $G_INPUT)) {
    $charset = $G_INPUT['charset'];
}
$put_title = @$G_INPUT['title'];

cb_prepare_download('mime.csv', 'application/csv', false);

require_once('fw/csv.csp');
$csv = new CB_CSVWriter($charset);

if ($put_title) {
    require_once('fw/i18n.csp');
    $line = [];
    $line[] = cb_msg('grn.common.mime', 'col_extension');
    $line[] = cb_msg('grn.common.mime', 'col_mime');
    $csv->writeLine($line);
}

require_once('grn/mime.csp');
$mm = GRN_MIMEConfigManager::getInstance();
$table = $mm->getMIMETable();
$rowset = new CB_Rowset($table);
while ($row = $rowset->iterate()) {
    $line = [];
    $line[] = $row->get('extension');
    $line[] = $row->get('mime');
    $csv->writeLine($line);
}

$csv->close();


