<?php

global $G_INPUT;

global $G_container_app;
$uum =& $G_container_app->getInstance('uum');
$login =& $uum->getLoginUser();

require_once("grn/smarty.csp");
$t = new GRN_Smarty;

$page_name = cb_get_pagename();

//Assign Form Name
$t->assign('form_name', $page_name);

$check_creator = true;
require('_file_upload.csp');

$view_page = 'view';
if (isset($report['draft']) && 1 == $report['draft']) {
    $view_page = 'view_draft';
}

//Assign Site Position
$page_path = [
    "index"       => [
        'cid' => $category_id,
        'sf'  => 1
    ],
    $view_page    => [
        'cid' => $category_id,
        'rid' => $report_id
    ],
    "file_view"   => [
        'cid'       => $category_id,
        'rid'       => $report_id,
        'follow_id' => $follow_id,
        'fid'       => $file_id
    ],
    "file_upload" => null,
];

$utility = new GRN_Report_ControllerUtil($page_name);
$site_position = $utility->makeSitePosition('report/', $page_path);

$t->assign('site_position', $site_position);

//generate upload ticket
include('grn/_upload_prepend.csp');

$t->display($page_name . ".tpl");

