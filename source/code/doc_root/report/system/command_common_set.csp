<?php

if (strcasecmp(cb_at($_SERVER, 'REQUEST_METHOD'), 'POST') == 0) {
    global $G_INPUT;

    $locator = GRN_ApplicationLocator::instance();
    $app = $locator->getInstance('report');

    $system_config = $app->getSystemConfig($G_report_login_user);
    $follow = cb_at($G_INPUT, 'enable_follow') ? true : false;
    $htmleditor = cb_at($G_INPUT, 'enable_htmleditor') ? true
        : false;
    $enable_follow_autolink = cb_at($G_INPUT, 'enable_follow_autolink') ? true
        : false;
    $report_allusers = cb_at($G_INPUT, 'security_setattendees');
    $system_config->setEnableFollow($follow);
    $system_config->setEnableHtmlEditor($htmleditor);
    $system_config->setEnableFollowAutoLink($enable_follow_autolink);
    $system_config->setAllUsersAttendeesUsers($report_allusers);
    if ($follow) {
        $follow = "TRUE";
    } else {
        $follow = "FALSE";
    }
    if ($htmleditor) {
        $htmleditor = "TRUE";
    } else {
        $htmleditor = "FALSE";
    }
    if ($enable_follow_autolink) {
        $enable_follow_autolink = "TRUE";
    } else {
        $enable_follow_autolink = "FALSE";
    }

    $common = [
        'enable_follow'                  => $follow,
        'enable_htmleditor'              => $htmleditor,
        'enable_follow_link'             => $enable_follow_autolink,
        'report_allusers_attendeesusers' => $report_allusers
    ];

    cb_redirect('system/application_list', ['app_id' => 'report']);

}
