<?php

$form_id = @$G_INPUT['fid'];
$name = @$G_INPUT['name'];
$foreign_key = @$G_INPUT['foreign_key'];
$memo = @$G_INPUT['memo'];
$enable_follow = @$G_INPUT['enable_follow'];
$enable_member = @$G_INPUT['enable_member'];
$enable_partner = @$G_INPUT['enable_partner'];

require_once('report/form_logic.csp');
$form_logic = GRN_Report_Form_Logic::getInstance();
$form_logic->modify($form_id, $name, $foreign_key, $enable_follow,
    $enable_member, $enable_partner, $memo);

//監査する
require_once('report/inspection.csp');
$inspection = GRN_Report_Form_Inspection::getInstance();
if ($inspection->isEnabled()) {
    $inspection_enable_follow = $inspection->setEnableFollow($enable_follow);
    $inspection_enable_member = $inspection->setEnableMember($enable_member);
    $inspection_enable_partner = $inspection->setEnablePartner($enable_partner);

    $message_type = 'form_modify';

    $message_args['fid'] = $form_id;
    $message_args['name'] = $name;
    $message_args['foreign_key'] = $foreign_key;
    $message_args['enable_follow'] = $inspection_enable_follow;
    $message_args['enable_member'] = $inspection_enable_member;
    $message_args['enable_partner'] = $inspection_enable_partner;
    $message_args['memo'] = $memo;

    //Record Inspection
    $inspection->record($message_type, $message_args);
}


