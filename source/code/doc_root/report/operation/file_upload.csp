<?php

global $G_INPUT;

global $G_container_app;
$uum =& $G_container_app->getInstance('uum');
$login =& $uum->getLoginUser();

require_once("grn/smarty.csp");
$t = new GRN_Smarty;

$form_id = @$G_INPUT['frm'];
$t->assign('form_id', $form_id);

$page_name = cb_get_pagename();

//Assign Form Name
$t->assign('form_name', $page_name);

//Check File Manage
require_once('report/file.csp');
$file_manager = GRN_Report_FileManager::getInstance();
$file_manager->isManage(@$G_INPUT['fid']);

require('../_file_upload.csp');

//Assign Site Position
$page_path = [
    "report_list" => ['cid' => $category_id],
    "report_view" => [
        'cid' => $category_id,
        'rid' => $report_id
    ],
    "file_view"   => [
        'cid'       => $category_id,
        'frm'       => $form_id,
        'rid'       => $report_id,
        'follow_id' => $follow_id,
        'fid'       => $file_id
    ],
    "file_upload" => null,
];

$utility = new GRN_Report_ControllerUtil($page_name);
$site_position = $utility->makeSitePosition('report/operation/', $page_path);

$t->assign('site_position', $site_position);

//generate upload ticket
include('grn/_upload_prepend.csp');

$t->display($page_name . ".tpl");

