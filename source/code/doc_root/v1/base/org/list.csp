<?php
require_once dirname(dirname(__DIR__)) . '/_api.csp';

$in = JSON::getInput();

function setStringAttribute($row, $name, $value)
{
    $row->$name = $value ? $value : '';
}

global $G_container_base;
$uum = $G_container_base->getInstance('uum');
$groups = $uum->getGroupInfoList();

$rows = [];
foreach ($groups as $key => $item) {
    $group = $uum->getGroup($key);
    $row = new stdClass();
    $row->id = intval($group->getOID());
    $row->name = $group->get('name');
    $parent = $group->get('parent');
    $row->parentId = is_object($parent) ? intval($parent->getOID()) : null;
    $rows[] = $row;
}

$result = new stdClass();
$result->success = true;
$result->rows = $rows;
echo json_encode($result);
