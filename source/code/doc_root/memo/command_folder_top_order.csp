<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    global $G_INPUT;

    global $G_container_app;
    $uum =& $G_container_app->getInstance('uum');
    $login =& $uum->getLoginUser();

    $folder_id = null;
    if (array_key_exists('did', $G_INPUT) && strlen($G_INPUT['did']) > 0) {
        $folder_id = $G_INPUT['did'];
    }

    require_once('memo/logic.csp');
    $logic = GRN_Memo_Logic::getInstance();

    $logic->setRootFolders($login, $G_INPUT['order']);

    require_once('memo/folder_tree.csp');
    GRN_Memo_FolderTree::_memo_rebuild_folder_tree();

    cb_redirect('memo/index', ['did' => $folder_id]);
}
