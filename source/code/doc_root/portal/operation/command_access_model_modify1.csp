<?php

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    require_once("_access_util.csp");

    // 入力フォームデータを取得する
    $security_model = @ $G_INPUT['security_model']; // セキュリティ・モデル

    if ($security_model == $logic->getSecurityModel($object_id)) {
        // アクセス権ページにリダイレクトする
        cb_redirect('portal/operation/access_list',
            [
                'pid'  => $portal_id,
                'plid' => $layout_id
            ]);
    }

    require_once('fw/session_manager.csp');

    $session_manager = CB_SessionManager::getInstance();
    $session =& $session_manager->getSession(GRN_PRTL_MODULE_ID);

    // セキュリティ・モデルをセッションに書き込む
    $session->set('security_model', $security_model);

    // セキュリティ・モデルの変更1/2ページにリダイレクトする
    cb_redirect('portal/operation/access_model_modify2',
        [
            'pid'  => $portal_id,
            'plid' => $layout_id
        ]);
}


