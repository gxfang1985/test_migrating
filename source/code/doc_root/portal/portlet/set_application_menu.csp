<?php

require_once('portal/error_code.csp');
if ( ! isset($portlet)) {
    cb_throw_error(E_GRN_PRTL_PORTLET_INVALID_ACCESS);
}

//Get Smarty Instance
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

//Get Portlet Settings
$portlet_setting = null;
if (array_key_exists('settings', $portlet)) {
    $portlet_settings =& $portlet['settings'];
} else {
    $portlet_settings = [];
}

//Set Default Portlet Setting
if ( ! array_key_exists('font_size', $portlet_settings)) {
    $portlet_settings['font_size'] = 'normal';              //Default Font Size
}
if ( ! array_key_exists('use_turnup', $portlet_settings)) {
    $portlet_settings['use_turnup'] = '0';                  //Default Use Turnup
}
if ( ! array_key_exists('turnup_size', $portlet_settings)) {
    $portlet_settings['turnup_size']
        = '5';                 //Default Turnup Size
}
if ( ! array_key_exists('display_type', $portlet_settings)) {
    $portlet_settings['display_type']
        = '0';                //Default Display Type
}


//Create Font Options Array
global $G_portal_app_name;
$font_options = [
    [
        'value' => 'small',
        'label' => cb_msg('grn.portal', 'font_size_small',
            ['app_name' => $G_portal_app_name])
    ],
    [
        'value' => 'normal',
        'label' => cb_msg('grn.portal', 'font_size_normal',
            ['app_name' => $G_portal_app_name])
    ],
    [
        'value' => 'large',
        'label' => cb_msg('grn.portal', 'font_size_large',
            ['app_name' => $G_portal_app_name])
    ],
];
$font_size = @$portlet['settings']['font_size'];
switch ($font_size) {
    case 'small':
        $font_options[0]['selected'] = true;
        break;
    case 'normal':
        $font_options[1]['selected'] = true;
        break;
    case 'large':
        $font_options[2]['selected'] = true;
        break;
    default:
        $font_options[1]['selected'] = true;
        break;
}

//Create Turnup Array
$turnup_options = [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];


$t->assign(
    'select1', [
        'name'    => 'turnup_size',
        'options' => [
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20
        ],
        'padding' => '&nbsp;',
    ]
);


// Assign View Infomation
// Assign Portlet Settings Infomation
$t->assign('settings', $portlet_settings);

//Assign include_php Parameter
$t->assign('portlet', $portlet);
$t->assign('display', $display);

// Assign Font Options
$t->assign('font_options', $font_options);

// Assign Turnup Options
$t->assign('turnup_options', $turnup_options);

//-- set page title and site position

// Ignore Licence Warnning
$t->skipWarning();

// Display Smarty Template
$doc_name = cb_get_pagename();
$t->display("portal/portlet/set_application_menu.tpl");


