<?php

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    // 入力フォームデータを取得する
    $poid = @ $G_INPUT['poid'];           // 選択されている組織

    require_once('fw/session_manager.csp');
    $session_manager = CB_SessionManager::getInstance();
    $session =& $session_manager->getSession(GRN_PRTL_MODULE_ID);

    require_once('portal/access_logic.csp');
    $logic = GRN_Portal_MyPortalAccessLogic::getInstance();
    $object =& $logic->getObject();
    $object_id = $object->getOID();

    // セキュリティ・モデルを変更する
    $security_model = $session->get('security_model');
    $logic->setSecurityModel($object_id, $security_model);

    // アクセス権ページにリダイレクトする
    cb_redirect('portal/system/availability_list', ['poid' => $poid]);
}


