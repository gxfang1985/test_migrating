<?php

// instantiate an Smarty object
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

//Get Portal ID
$eid = [];
if (array_key_exists('eid', $G_INPUT)) {
    //Get Checked Portal ID
    $eid =& $G_INPUT['eid'];
} else {
    // Get My Portlet Template ID
    require_once("portal/system_logic.csp");
    $system_logic = GRN_Portal_SystemLogic::getInstance();
    $my_portal_template_id = $system_logic->getMyPortaltemplate();

    //Get All Portal ID
    require_once('portal/portal_logic.csp');
    $system_portallogic = GRN_Portal_SystemPortalLogic::getInstance();
    $portal_list = $system_portallogic->getList();
    if ($portal_list) {
        $eid = array_keys($portal_list);
        $key = array_search($my_portal_template_id, $eid);
        if (false !== $key) {
            unset($eid[$key]);
        }
    }
}

// Assign Portal Display Infomation
$t->assign(
    'portals', [
        'delete_numbers' => count($eid),
        'portal'         => $eid,
    ]
);

//-- set page title and site position

// page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

// site position
$t->assign(
    'site_position', [
        [
            'page' => "portal/system/list",
            'name' => grn_get_page_display_name('portal/system/list')
        ],
        ['page' => "", 'name' => $page_title]
    ]
);

// Display Smarty Template
$doc_name = cb_get_pagename();
$t->display("{$doc_name}.tpl");


