<?php

//-- instantiate Smarty object
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

$ous_params = [];
$session_name = 'portal.system.availability_add';
$can_select_role = true;
$search_login_name = true;
require_once('grn/org_user_role_select.csp');
$t->assign('ous_params', $ous_params);

$t->assign('listbox_size', $navigation_info['navi']['number_on_page'] + 1);

// tree link page
$t->assign('link_page', cb_get_pagename());

//-- page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

require_once('grn/controller.csp');

//-- site position
$t->assign('site_position',
    [
        [
            'page'  => 'portal/system/availability_list',
            'name'  => grn_get_page_display_name('portal/system/availability_list'),
            'reset' => 1
        ],
        ['page' => null, 'name' => $page_title],
    ]
);

//Get Security Model
require_once('portal/access_logic.csp');

$logic = GRN_Portal_MyPortalAccessLogic::getInstance();

$object =& $logic->getObject();
$object_id = $object->getOID();
$security_model = $logic->getSecurityModel($object_id);
$t->assign('is_grant', $security_model == 'grant');

// exec smarty
$t->display(cb_get_pagename() . '.tpl');

