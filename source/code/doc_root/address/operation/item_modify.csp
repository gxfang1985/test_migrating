<?php

require_once('grn/smarty.csp');
$t = new GRN_Smarty;

////////////////////////////////////////////////////////////////

// GET/POSTされたパラメータを取得する
$bid = null;
if (array_key_exists('bid', $G_INPUT)) {
    $bid = $G_INPUT['bid'];
}
if (0 == strlen($bid)) {
    cb_throw_error(E_GRN_ADDRESS_INVALID_BOOK_ID);
}
$biid = null;
if (array_key_exists('biid', $G_INPUT)) {
    $biid = $G_INPUT['biid'];
}
$eiid = null;
if (array_key_exists('eiid', $G_INPUT)) {
    $eiid = @ $G_INPUT['eiid'];
}
if (0 < strlen($eiid)) {
    require('SmartyValidate.class.php');
    SmartyValidate::connect($t);
    SmartyValidate::register_form(cb_get_pagename(), true);
} elseif (0 == strlen($biid) || 'subject' == $biid) {
    cb_throw_error(E_GRN_ADDRESS_ITEM_NOT_FOUND);
}

include('_item_modify.csp');

// Smartyを実行する
$t->display(cb_get_pagename() . '.tpl');


