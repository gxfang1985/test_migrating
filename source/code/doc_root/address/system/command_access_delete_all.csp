<?php

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    require_once('_access_util.csp');

    // GET/POSTされたパラメータを取得する
    if (0 == strlen($node_id)) {
        cb_throw_error(E_GRN_ADDRESS_INVALID_BOOK_ID);
    }

    // 全てのアクセス権を削除する
    $row =& $node_row->getRow();
    $authorities = ['browse' => 0, 'editing' => 0, 'operation' => 1];
    require_once('address/access.csp');
    $access_manager = GRN_Address_AccessManager::getInstance();
    $access_manager->removeAccesses($row, $authorities);

    cb_redirect('address/system/access_list',
        ['poid' => $poid, 'nid' => $node_id]);
}

