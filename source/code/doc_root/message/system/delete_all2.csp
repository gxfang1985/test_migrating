<?php

//-- instantiate Smarty object
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

//-- get parameters from URL parameters
$year = @ $G_INPUT['year'];
$month = @ $G_INPUT['month'];
$day = @ $G_INPUT['day'];
$set_date = new CB_Date();
$set_date->year = intval($year);
$set_date->month = intval($month);
$set_date->day = intval($day);
$t->assign('str_date', cb_date_format('DateFull_YMDW', $set_date));

$t->assign('year', $year);
$t->assign('month', $month);
$t->assign('day', $day);

// page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

// site position
$t->assign(
    'site_position', [
        [
            'page' => "",
            'name' => $page_title
        ]
    ]
);

require_once('grn/application.csp');
$locator = GRN_ApplicationLocator::instance();
if ( ! ($message = $locator->getInstance('message'))) {
    require_once('message/error_code.csp');
    $name = $locator->getName('message');
    $name = htmlspecialchars($name);
    cb_throw_error(E_GRN_MESSAGE_DEACTIVATED,
        ['app_name' => $name], ['app_name' => $name]);
}
$t->assign('app_name', $message->getName());

//-- show page
$doc_name = cb_get_pagename();
$t->display("{$doc_name}.tpl");

