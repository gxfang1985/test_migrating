<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    $year = @ $G_INPUT['term_year'];
    $month = @ $G_INPUT['term_month'];
    $day = @ $G_INPUT['term_day'];

    if ($year == '' || $month == '' || $day == '') {
        require_once('message/error_code.csp');
        cb_throw_error(E_GRN_MESSAGE_WRONG_PARAMETER);
    }

    $timestamp = mktime(0, 0, 0, $month, $day, $year);

    require_once('message/system_logic.csp');
    $system_logic = GRN_Message_SystemLogic::getInstance();
    $system_logic->deleteMessages($timestamp);

    //Logging
    require_once('message/inspection.csp');
    $logger = GRN_Message_Logger_25::getInstance();
    $params = ['timestamp' => $timestamp];
    $logger->notice('delete_all', 'message', $params);
    //End Logging
    cb_redirect('message/system/delete_all4');
}


