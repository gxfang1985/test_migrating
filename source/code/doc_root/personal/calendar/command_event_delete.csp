<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    // instantiate an Smarty object
    require_once('grn/smarty.csp');
    $t = new GRN_Smarty;

    $event = @$G_INPUT['event'];

    global $G_container_base;
    $uum = $G_container_base->getInstance('uum');
    $login = $uum->getLoginUser();

    require_once('grn/calendar.csp');
    $cm = GRN_CalendarManager::getInstance();
    $c = $cm->getPreferenceUserCalendar($login);
    if ( ! $c) {
        cb_throw_error(E_GRN_CALENDAR_CALENDAR_NOT_FOUND);
    }
    $e = $c->getDayInfoById($event);
    if ( ! $e) {
        cb_throw_error(E_GRN_CALENDAR_DAY_NOT_FOUND);
    }
    $date = $e->get('date');
    $c->removeDayInfoById($event);

    cb_redirect('personal/calendar/calendar_view', ['bdate' => $date->year]);
}


