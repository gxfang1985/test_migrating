<?php

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    // ログインユーザーを取得する
    global $G_container_base;
    $uum = $G_container_base->getInstance('uum');
    $login = $uum->getLoginUser();

    // ユーザ個別の設定ロジックを取得する
    require_once('grn/ui.csp');
    $manager = GRN_UIConfigManager::getInstance();
    $system_config = $manager->getSystemConfig();
    if ( ! $system_config->getCanUserChangeHeaders()) {
        cb_throw_error(E_GRN_NO_SYSTEM_PRIVILEGE);
    }
    assert('is_object( $manager ) && is_a( $manager, \'GRN_UIConfigManager\' )');
    $config = $manager->getUserConfig($login);
    assert('is_object( $config ) && is_a( $config, \'GRN_UIConfig\' )');

    // 入力フォームデータを取得する
    $display_application_menu = @ $G_INPUT['display_application_menu'];
    $application_menu_style = @ $G_INPUT['application_menu_style'];

    // アプリケーションメニューの表示
    $config->setDisplayApplicationMenu(1 == $display_application_menu);

    // アプリケーションメニューの表示形式
    $config->setApplicationMenuStyle($application_menu_style);
}

cb_redirect('personal/common_list', ['id' => 'ui']);


