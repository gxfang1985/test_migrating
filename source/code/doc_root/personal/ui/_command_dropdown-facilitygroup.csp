<?php

$uum = $G_container_base->getInstance('uum');
require_once('grn/uum_util.csp');
$login = $uum->getLoginUser();


if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    require_once('fw/session_manager.csp');
    $session_manager = CB_SessionManager::getInstance();
    $session
        = $session_manager->getSession('grn.personal.ui.dropdown-facilitygroup');
    $org_ids = $session->get('org_ids');

    $order = @ $G_INPUT['order'];
    $order = explode(':', $order);

    $ordered_ids = [];
    foreach ($order as $order_id) {
        if (array_key_exists($order_id, $org_ids)) {
            $ordered_ids[] = $order_id;
            unset($org_ids[$order_id]);
        }
    }
    foreach (array_keys($org_ids) as $org_id) {
        $ordered_ids[] = $org_id;
    }

    require_once('schedule/facility_system_logic.csp');
    $hm = GRN_Facility_HistoryManager::getInstance();

    $hm->setOftenusedFacilityGroups($login->getOID(), $ordered_ids);
}

