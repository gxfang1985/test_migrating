<?php
require_once('grn/system_logic.csp');
$system = GRN_System::getInstance();
$is_password_config = $system->getPasswordEnablePersonalConfig();

if ( ! $is_password_config) {
    cb_redirect('personal/common_list', ['id' => 'user']);
}

require_once('grn/system_logic.csp');
$system = GRN_System::getInstance();
$t->assign('password_length', $system->getPasswordLength());

// page title
$page_title = grn_get_page_display_name('personal/user/password');

// set page title
$t->assign('page_title', $page_title);

// 入力文字の制限の設定情報を取得して、画面に表示する。
$setting = $system->getPasswordComplex();
if (isset($setting['enable']) && $setting['enable']) {
    $strong_pwd_options = $setting['options'];

    require_once('grn/strong_password.csp');
    $pwd_validator = new GRN_StrongPasswordValidator();
    $pwd_validator->setOptions($strong_pwd_options);

    $t->assign('optionsArray', $pwd_validator->getOptionsArray());
}
// site position
$t->assign('site_position', [['page' => '', 'name' => $page_title]]);


