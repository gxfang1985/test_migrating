<?php

require_once('grn/smarty.csp');
$t = new GRN_Smarty();

$path_info = array_key_exists('PATH_INFO', $_SERVER) ? $_SERVER['PATH_INFO']
    : '';
$uri = $_SERVER['SCRIPT_NAME'] . $path_info;
$t->assign('url', $uri);

require_once('grn/system_logic.csp');
$system = GRN_System::getInstance();
$t->assign('necessary_password', ! $system->getPasswordEmptyLogin());

global $G_INPUT;
$params = $G_INPUT;
unset($params['_system']);
unset($params['_uid']);
unset($params['_exec']);
unset($params['_password']);
unset($params['_pwd_ticket']);
unset($params['_retype']);

$t->assign('params', $params);

require_once('grn/authentication.csp');
$service = GRN_Authentication_Service::getInstance();
$pwd_expired =& $service->getPasswordExpiredInfo();

if (is_null($pwd_expired)) {
    cb_switch_page('system_login.csp');
}

$t->assign('pwd_expired', $pwd_expired);

$t->display('system_pwd_expired.tpl');


