<?php

if ( ! array_key_exists('mid', $G_INPUT)
     ||
     ! is_numeric($G_INPUT['mid'])
) {
    cb_throw_error(E_GRN_ICON_NOT_FOUND);
} else {
    $mid = $G_INPUT['mid'];
}

require_once('grn/ui.csp');
$manager = GRN_UIConfigManager::getInstance();

$menu = $manager->getDefaultApplicationMenu();

// アイコンを取得する
$item = $menu->getMenu($mid);
$file =& $item['icon_file'];
if ( ! $file) {
    cb_throw_error(E_GRN_ICON_NOT_FOUND);
}

// ファイルをダウンロードする
$body =& $file->getCurrentBody();
$body->download(true);

cb_safe_exit();


