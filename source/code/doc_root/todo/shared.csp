<?php

use grn\space\screen\application\todo\TodoList;
use grn\space\screen\GenericScreenBase;
use grn\grn\access\service\AppAccess;

global $G_INPUT;

// Smarty をインスタンス化
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

require_once('grn/application.csp');
$locator = GRN_ApplicationLocator::instance();

if ( ! AppAccess::isAppAvailable('space')) {
    cb_redirect('todo/index');
}

$app =& $locator->getInstance('todo');

global $G_container_app;
$uum =& $G_container_app->getInstance('uum');
$login =& $uum->getLoginUser();

require_once('todo/controller.csp');
$utility = new GRN_ToDo_ControllerUtil();

$todo_list_service = new TodoList($G_INPUT);
$todo_list_for_view['todo'] = $todo_list_service->getMyTodo();

$t->assign('todo_list', $todo_list_for_view);
$t->assign('from_todo_index', GenericScreenBase::FROM_TODO_INDEX);
$t->assign('config', $utility->getConfigValues($login));

// サイトポジション
$utility->setSitePosition($t, null);

$t->display(cb_get_pagename() . ".tpl");

