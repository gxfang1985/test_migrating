<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    global $G_INPUT;

    if ( ! @ $G_INPUT['cancel']) {
        require_once('grn/application.csp');
        $locator = GRN_ApplicationLocator::instance();
        $app =& $locator->getInstance('todo');

        global $G_container_app;
        $uum =& $G_container_app->getInstance('uum');
        $login =& $uum->getLoginUser();

        require_once('todo/list.csp');

        $list = new GRN_ToDo_UserList($login);
        $list->setFinish(true);
        $list->delete();
    }

    cb_redirect('todo/history', ['cid' => @$G_INPUT['cid']]);
}
