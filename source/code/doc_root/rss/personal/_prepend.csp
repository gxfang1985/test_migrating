<?php

// application object
require_once('grn/application.csp');
require_once('rss/resources.csp');

use grn\grn\access\service\AppAccess;

$locator = GRN_ApplicationLocator::instance();

if ( ! AppAccess::isAppAvailableInternalAccess('rss')) {
    require_once('rss/error_code.csp');
    cb_throw_error(E_GRN_RSS_DEACTIVATED);
}
unset($locator);

// user object
global $G_container_base;
$uum =& $G_container_base->getInstance('uum');
global $G_rss_login;
$G_rss_login =& $uum->getLoginUser();

if ( ! is_object($G_rss_login) || ! is_a($G_rss_login, 'cb_user')) {
    require_once('fw/error_code.csp');
    cb_throw_error(E_COMMON_ACCOUNT_INVALIDATED);
}
unset($uum);

// initialize
require_once('rss/personal.csp');
$personal = GRN_RSS_PersonalLogic::getInstance();
$personal->initialize($G_rss_login);
unset($personal);


