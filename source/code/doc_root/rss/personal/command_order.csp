<?php
if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    require_once('rss/system.csp');
    $system = GRN_RSS_SystemLogic::getInstance();
    if (strcmp($system->getUsePersonalAttribute(), '0') === 0) {
        require_once('rss/error_code.csp');
        cb_throw_error(E_GRN_RSS_NO_PERSONAL_PERMISSION);
    }

    if (count($G_INPUT) > 0) {
        if ( ! array_key_exists('id', $G_INPUT)) {
            require_once('rss/error_code.csp');
            cb_throw_error(E_GRN_RSS_WRONG_PARAMETER);
        }

        $relation_list = [];
        foreach ($G_INPUT['id'] as $order => $rid) {
            $relation_list[$rid] = $order;
        }

        require_once('rss/personal.csp');
        $personal = GRN_RSS_PersonalLogic::getInstance();
        $personal->changePersonalRelationOrder($G_rss_login, $relation_list);
    }

    cb_redirect('rss/personal/list');
}

