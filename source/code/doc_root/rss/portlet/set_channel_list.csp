<?php

require_once('portal/error_code.csp');
if ( ! isset($portlet)) {
    cb_throw_error(E_GRN_PRTL_PORTLET_INVALID_ACCESS);
}

//Get Smarty Instance
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

// ----------

$settings = [];
if (array_key_exists('settings', $portlet)) {
    $settings = $portlet['settings'];
}

// font options
require_once('rss/resources.csp');
$font_options_for_view = [
    [
        'value' => 'small',
        'label' => cb_msg(GRN_RSS_APP_MODULEID, 'font_size_small')
    ],
    [
        'value' => 'normal',
        'label' => cb_msg(GRN_RSS_APP_MODULEID, 'font_size_normal')
    ],
    [
        'value' => 'large',
        'label' => cb_msg(GRN_RSS_APP_MODULEID, 'font_size_large')
    ],
];
$font_size = 'normal';
if (array_key_exists('font_size', $settings)) {
    $font_size = $settings['font_size'];
}
switch ($font_size) {
    case 'small':
        $font_options_for_view[0]['selected'] = true;
        break;
    case 'normal':
        $font_options_for_view[1]['selected'] = true;
        break;
    case 'large':
        $font_options_for_view[2]['selected'] = true;
        break;
    default:
        $font_options_for_view[1]['selected'] = true;
        break;
}
$t->assign('font_options', $font_options_for_view);

// display shared channels
require_once('rss/system.csp');
$system = GRN_RSS_SystemLogic::getInstance();
$use_shared_for_view = $system->getUseSharedAttribute();
$t->assign('use_shared', $use_shared_for_view);

// shared
$shared_for_view = true;
if (array_key_exists('shared', $settings)) {
    $shared_for_view = $settings['shared'];
}
$t->assign('shared', $shared_for_view);

// ----------

//Assign include_php Parameter
$t->assign('portlet', $portlet);
$t->assign('display', $display);

// Ignore Licence Warnning
$t->skipWarning();

//Display Smarty Template
$t->display('rss/portlet/set_channel_list.tpl');


