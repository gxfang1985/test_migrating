<?php
/** @var GRN_Util_Api_Service $sysapi_service */
/** @var GRN_Uum $uum */
if (isset($sysapi_service)) {
    // Get a list of userIds from parameters
    $request_params = $sysapi_service->getRequestParameters();

    global $G_container_base;
    $uum = $G_container_base->getInstance('uum');

    $userIds = $sysapi_service->selectNodesValue($request_params, 'userId',
        true);
    $userDetails = [];
    foreach ($userIds as $userId) {
        $user_info = $uum->getUserInfo($userId,
            ['col_foreign_key', 'col_display_name']);
        if ( ! $user_info) {
            continue;
        }

        $userDetails[] = [
            'userId'       => $userId,
            'login_name'   => $user_info['col_foreign_key'],
            'display_name' => $user_info['col_display_name']
        ];
    }

    require_once('grn/smarty.csp');
    $t = new GRN_Smarty;
    $t->assign('userDetails', $userDetails);

    $t->assign('xml_namespaces',
        "xmlns:admin=\"http://wsdl.cybozu.co.jp/admin/2008\"");
    grn_util_api_response($t, __FILE__);
}

