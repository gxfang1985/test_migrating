<?php

use grn\grn\JSONResponse;

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    $G_state_set->set('copyright_should_be_written', false);
    $G_state_set->set('html_should_be_closed', false);
    global $G_INPUT;
    $mail_ids = @ $G_INPUT['ids'];
    if ( ! is_array($mail_ids)) {
        return;
    }
    $new_category_id = @ $G_INPUT['dcid'];

    require_once('mail/utility.csp');
    $utility = GRN_Mail_Utility::getInstance();
    $mail_logic = $utility->getMailLogic();
    foreach ($mail_ids as $id) {
        $mail_logic->checkMailExist($id);
    }

    $json = JSONResponse::create();
    $json->response([
        'mail_move_count' => $mail_logic->moveMailDatas($mail_ids,
            $new_category_id)
    ]);
}

