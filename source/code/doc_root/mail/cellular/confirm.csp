<?php
// Smarty をインスタンス化
require_once('cellular/smarty.csp');
$smarty = new GRN_Cellular_Smarty;

// ページタイトル
$smarty->assign('pagetitle', grn_get_current_page_display_name());
// パス情報
$smarty->assign('pagepath', $G_pagepath);

$account_id = isset($G_INPUT['aid']) ? $G_INPUT['aid'] : null;
$category_id = isset($G_INPUT['cid']) ? $G_INPUT['cid'] : null;

//sessionから取得。
$sess_mail_add = $G_cellular_session->get('sess_mail_add');
$sess_mail_add['subject'] = $sess_mail_add['subject'];
$G_cellular_session->set('sess_mail_add', $sess_mail_add);

//署名がある場合、署名を取得
if ($sess_mail_add['signature'] != '0') {
    require_once('mail/utility.csp');
    $utility = GRN_Mail_Utility::getInstance();
    $send_logic = $utility->getSendLogic();
    require_once('mail/include_send.csp');

    $personal_config = $utility->getPersonalConfig($G_login_user);
    // アカウントの署名設定リストを取得
    $signature_list = $personal_config->getSignatureDataList($account_id, true);
    $signature_info = $signature_list[$sess_mail_add['signature']]['data'];
    $smarty->assign('signature_info', $signature_info);
}

//確認画面への出力のため。
$smarty->assign('mail_confirm_data', $sess_mail_add);

$smarty->assign('aid', $account_id);
$smarty->assign('cid', $category_id);

$smarty->display(cb_get_pagename() . '.tpl');

