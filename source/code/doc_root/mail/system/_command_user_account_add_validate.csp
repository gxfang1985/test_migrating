<?php

global $t;
$set =& $t->get_template_vars('set');
if ( ! isset($set) || is_null($set)) {
    $set = [];
    $set['title'] = '';
}

global $G_INPUT;

$server_id = is_null(@ $G_INPUT['mail_server']) ? ''
    : @ $G_INPUT['mail_server'];
$disabled = @ $G_INPUT['stop'];
$disabled = ! is_null($disabled) && ((int)$disabled == 1);

// set_data
$set['foreign_key'] = @ $G_INPUT['foreign_key'];
$set['name'] = @ $G_INPUT['name'];
$set['email'] = @ $G_INPUT['email'];
$set['account'] = @ $G_INPUT['account'];
$set['password'] = @ $G_INPUT['password'];
$set['send_account'] = @ $G_INPUT['send_account'];
$set['smtp_account_set'] = @ $G_INPUT['smtp_account_set'];
$set['send_password'] = @ $G_INPUT['email'];
$set['leave_server_mail'] = @ $G_INPUT['leave_server_mail'];
$send_vcard = null;
$default_bcc = null;
$sender = null;
$set['stop'] = $disabled;

foreach (array_keys($mail_servers) as $key) {
    $server_data =& $mail_servers[$key];
    $server_data['selected'] = ($key == $server_id);
}

//------------------

// mail_server
$t->assign('mail_server', $mail_servers);

// アカウント設定
$t->assign('set', $set);

// ユーザー情報
$t->assign('user', $user_for_view);


