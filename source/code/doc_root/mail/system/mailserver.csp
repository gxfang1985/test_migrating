<?php

//-- instantiate Smarty object
require_once("grn/smarty.csp");
$t = new GRN_Smarty;

//------------------
require_once('mail/system_config.csp');

// メールサーバー一覧
$system_config = GRN_Mail_SystemConfig::getInstance();
$data_list = $system_config->getServerDataList(false);

$mail_servers = [];
foreach (array_keys($data_list) as $key) {
    $server_data =& $data_list[$key];
    $server_info = $server_data['server_info'];
    $mail_servers[$key] = [
        'msid'            => $key,
        'title'           => $server_data['name'],
        'smtp_server'     => $server_info->smtp,
        'smtp_port'       => $server_info->smtp_port,
        'received_server' => $server_info->retrieve,
        'received_port'   => $server_info->retrieve_port,
    ];
}

//------------------

$t->assign('disabled_change_order', count($mail_servers) < 2 ? true : false);

// mailserver_set
$t->assign('mailservers', $mail_servers);

// page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

// site position
$t->assign('site_position', [['page' => '', 'name' => $page_title]]);

//-- show page
$t->display(cb_get_pagename() . ".tpl");

