<?php

require_once('mail/utility.csp');
$utility = GRN_Mail_Utility::getInstance();
$system_config = $utility->getSystemConfig();

// サイズ制限
$system_config->getSizeUserLimitSetting($settings, $user_id);
$user_limit = $settings['user_limit_' . $user_id];
$receive_limit = $settings['receive_limit_' . $user_id];
$send_limit = $settings['send_limit_' . $user_id];
$system_config->getSizeLimitSetting($setting_common);

// メールの総サイズ設定

$mailbox_size = [
    [
        'value'    => '-10',
        'label'    => cb_msg('grn.system', 'mail_limit_user_define'),
        'selected' => -10
    ],
    [
        'value'    => '',
        'label'    => '------------',
        'selected' => 0
    ],
    [
        'value'    => '10',
        'label'    => '10MB',
        'selected' => false
    ],
    [
        'value'    => '20',
        'label'    => '20MB',
        'selected' => false
    ],
    [
        'value'    => '30',
        'label'    => '30MB',
        'selected' => false
    ],
    [
        'value'    => '40',
        'label'    => '40MB',
        'selected' => false
    ],
    [
        'value'    => '50',
        'label'    => '50MB',
        'selected' => false
    ],
    [
        'value'    => '60',
        'label'    => '60MB',
        'selected' => false
    ],
    [
        'value'    => '70',
        'label'    => '70MB',
        'selected' => false
    ],
    [
        'value'    => '80',
        'label'    => '80MB',
        'selected' => false
    ],
    [
        'value'    => '90',
        'label'    => '90MB',
        'selected' => false
    ],
    [
        'value'    => '100',
        'label'    => '100MB',
        'selected' => false
    ],
    [
        'value'    => '150',
        'label'    => '150MB',
        'selected' => false
    ],
    [
        'value'    => '200',
        'label'    => '200MB',
        'selected' => false
    ],
    [
        'value'    => '300',
        'label'    => '300MB',
        'selected' => false
    ],
    [
        'value'    => '500',
        'label'    => '500MB',
        'selected' => false
    ],
    [
        'value'    => '750',
        'label'    => '750MB',
        'selected' => false
    ],
    [
        'value'    => '1024',
        'label'    => '1024MB',
        'selected' => false
    ],
    [
        'value'    => '',
        'label'    => '------------',
        'selected' => 0
    ],
    [
        'value'    => '-1',
        'label'    => cb_msg('grn.system', 'infinity'),
        'selected' => false
    ]
];
if ($user_limit > 0) {
    $userInput = [
        [
            'value'    => $user_limit,
            'label'    => $user_limit . "MB",
            'selected' => true
        ]
    ];

    $mailbox_size = array_merge($userInput, $mailbox_size);
} elseif ($user_limit == -1) {
    $userInput = [
        [
            'value'    => '-1',
            'label'    => cb_msg('grn.system', 'infinity'),
            'selected' => true
        ]
    ];
    $mailbox_size = array_merge($userInput, $mailbox_size);
}
// 受信メールサイズ設定
$receive_size = [
    [
        'value'    => '256',
        'label'    => '256KB',
        'selected' => ($receive_limit == 256)
    ],
    [
        'value'    => '512',
        'label'    => '512KB',
        'selected' => ($receive_limit == 512)
    ],
    [
        'value'    => '1024',
        'label'    => '1MB',
        'selected' => ($receive_limit == 1024)
    ],
    [
        'value'    => '3072',
        'label'    => '3MB',
        'selected' => ($receive_limit == 3072)
    ],
    [
        'value'    => '5120',
        'label'    => '5MB',
        'selected' => ($receive_limit == 5120)
    ],
    [
        'value'    => '10240',
        'label'    => '10MB',
        'selected' => ($receive_limit == 10240)
    ],
    [
        'value'    => '15360',
        'label'    => '15MB',
        'selected' => ($receive_limit == 15360)
    ],
    [
        'value'    => '20480',
        'label'    => '20MB',
        'selected' => ($receive_limit == 20480)
    ],
    [
        'value'    => '30720',
        'label'    => '30MB',
        'selected' => ($receive_limit == 30720)
    ],
    [
        'value'    => '102400',
        'label'    => '100MB',
        'selected' => ($receive_limit == 102400)
    ],
];


if ( ! defined('ON_FOREST')) {
    $receive_size[] = [
        'value'    => '',
        'label'    => '------------',
        'selected' => 0
    ];
    $receive_size[] = [
        'value'    => '-1',
        'label'    => cb_msg('grn.system', 'infinity'),
        'selected' => ($receive_limit == -1)
    ];
}
// 送信メールサイズ設定
$send_size = [
    [
        'value'    => '256',
        'label'    => '256KB',
        'selected' => ($send_limit == 256)
    ],
    [
        'value'    => '512',
        'label'    => '512KB',
        'selected' => ($send_limit == 512)
    ],
    [
        'value'    => '1024',
        'label'    => '1MB',
        'selected' => ($send_limit == 1024)
    ],
    [
        'value'    => '3072',
        'label'    => '3MB',
        'selected' => ($send_limit == 3072)
    ],
    [
        'value'    => '5120',
        'label'    => '5MB',
        'selected' => ($send_limit == 5120)
    ],
    [
        'value'    => '10240',
        'label'    => '10MB',
        'selected' => ($send_limit == 10240)
    ],
    [
        'value'    => '15360',
        'label'    => '15MB',
        'selected' => ($send_limit == 15360)
    ],
    [
        'value'    => '20480',
        'label'    => '20MB',
        'selected' => ($send_limit == 20480)
    ],
    [
        'value'    => '30720',
        'label'    => '30MB',
        'selected' => ($send_limit == 30720)
    ],
    [
        'value'    => '',
        'label'    => '------------',
        'selected' => 0
    ],
    [
        'value'    => '-1',
        'label'    => cb_msg('grn.system', 'infinity'),
        'selected' => ($send_limit == -1)
    ],
];
