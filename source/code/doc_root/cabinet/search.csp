<?php

use grn\fts\Application as FtsApplication;

if (FtsApplication::isViewable()) {
    require('_search_fts.csp');
} else {
    global $G_INPUT;

    require_once("grn/smarty.csp");
    $t = new GRN_Smarty;

    require_once('cabinet/controller.csp');
    $utility = new GRN_Cabinet_ControllerUtil();

    require_once('_search.csp');

    // GRN35-209
    if (@$G_INPUT['hid']) {
        if ( ! ($folder = $G_cabinet->getFolder($G_cabinet_login,
            $G_INPUT['hid']))
        ) {
            cb_throw_error(E_GRN_CABINET_FOLDER_NOT_FOUND);
        }

        $utility->prepareMakeSitePosition($t, @$G_INPUT['hid']);
    } else {
        $page_path = [
            'cabinet/index' => ['hid' => @$G_INPUT['hid']]
        ];
        $utility->setSitePosition($t, $page_path);
    }
    // GRN35-209

    $t->display(cb_get_pagename() . ".tpl");
}
