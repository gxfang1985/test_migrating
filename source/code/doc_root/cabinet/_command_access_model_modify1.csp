<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    global $G_INPUT;

    // doc_root/cabinet以下のディレクトリから読まれること前提
    require_once('../_access_util.csp');

    // access information
    require_once('cabinet/access.csp');
    $am = GRN_Cabinet_AccessManager::getInstance();
    $current_model = $am->getSecurityModelString($node_row);
    $security_model = @ $G_INPUT['security_model'];

    $page_parts = explode('/', cb_get_pagename());

    $params = $G_INPUT;

    if ($security_model == $current_model) {
        // not modified
        unset($params['security_model']);

        $page_parts[count($page_parts) - 1] = 'access_list';
        cb_redirect(implode('/', $page_parts), $params);
    }
    $page_parts[count($page_parts) - 1] = 'access_model_modify2';
    cb_redirect(implode('/', $page_parts), $params);
}

