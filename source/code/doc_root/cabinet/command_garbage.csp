<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    global $G_INPUT;

    if ( ! array_key_exists('hid', $G_INPUT)) {
        cb_throw_error(E_GRN_CABINET_FOLDER_NOT_FOUND);
    }
    $folder_id = $G_INPUT['hid'];

    if ( ! array_key_exists('eid', $G_INPUT) || ! is_array($G_INPUT['eid'])) {
        cb_redirect('cabinet/index', ['hid' => $folder_id]);
    }

    require_once('cabinet/controller.csp');
    $utility = new GRN_Cabinet_ControllerUtil('cabinet/index');

    $session =& $utility->getSession();
    $session->set('eid', $G_INPUT['eid']);

    // Restore file in Trash
    foreach ($G_INPUT['eid'] as $file_id) {
        $G_cabinet->restoreFileFromTrash($G_cabinet_login, $file_id);
    }
    cb_redirect('cabinet/garbage', ['hid' => $folder_id]);

}

