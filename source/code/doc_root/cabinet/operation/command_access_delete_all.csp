<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    global $G_INPUT;
    require_once('../_command_access_delete_all.csp');

    if ( ! isset($folder)) {
        $folder =& $G_cabinet->getFolder($G_cabinet_login, $G_INPUT['nid']);
    }

    require_once('cabinet/access.csp');
    $acc = GRN_Cabinet_AccessManager::getInstance();

    if ( ! $acc->access($G_cabinet_login, $folder, GRN_CABINET_ACCESS_R)) {
        cb_throw_error(E_GRN_CABINET_CANNOT_CHANGE_ACCESS);
    }

    cb_redirect('cabinet/operation/access_list',
        ['nid' => $G_INPUT['nid'], 'poid' => @$G_INPUT['poid']]);
}

