<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    global $G_INPUT;
    require_once('../_command_access_model_modify2.csp');

    assert('isset($node_row)');

    require_once('cabinet/access.csp');
    $acc = GRN_Cabinet_AccessManager::getInstance();

    if ( ! $acc->access($G_cabinet_login, $node_row, GRN_CABINET_ACCESS_R)) {
        if ($acc->getSecurityModel($node_row)
            == GRN_CABINET_SECURITY_MODEL_GRANT
        ) {
            $acc->addTarget($node_row, $G_cabinet_login,
                ['read' => 1, 'write' => 1, 'follow' => 1]);
        }
    }
    cb_redirect('cabinet/operation/access_list',
        ['nid' => $G_INPUT['nid'], 'poid' => @$G_INPUT['poid'], 'reset' => 1]);
}

