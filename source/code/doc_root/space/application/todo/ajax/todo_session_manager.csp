<?php

use grn\grn\JSONResponse;
use grn\space\screen\application\todo\TodoIndex;

global $G_INPUT;
global $G_state_set;

$G_state_set->set('html_should_be_closed', false);
$G_state_set->set('copyright_should_be_written', false);
$G_state_set->set('error_page_type', 'json');

$response = [];
if (array_key_exists(TodoIndex::SESSION_KEY_SEARCH_SELECTION, $G_INPUT)) {
    $search_selection = cb_at($G_INPUT,
        TodoIndex::SESSION_KEY_SEARCH_SELECTION);
    $todo_index = new TodoIndex($G_INPUT);
    $todo_index->setSearchSelection($search_selection);
}

$json = JSONResponse::create();
$json->response($response);
