<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    include('_access_util.csp');

    //Get Parameters
    $node_id = @ $G_INPUT['nid'];             //Category ID
    $security_model = @ $G_INPUT['security_model'];  //Security Model

    //Get Current Security Model
    require_once('workflow/access_logic.csp');
    $category_access_logic = GRN_Workflow_Category_Access_Logic::getInstance();
    $current_security_model
        = $category_access_logic->getSecurityModel($node_id);

    $params = $G_INPUT;
    if ($security_model == $current_security_model) {
        //Redirect Previous Page
        unset($params['security_model']);
        cb_redirect('workflow/operation/access_list', $params);
    } else {
        //Redirect Next Page
        cb_redirect('workflow/operation/access_model_modify2', $params);
    }
}


