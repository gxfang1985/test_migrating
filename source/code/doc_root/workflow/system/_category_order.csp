<?php

//Get Parameter
$parent_category_id = @ $G_INPUT['pcid'];   //Parent Category ID

//Get Workflow and Category Controller Utility
require_once('workflow/controller_util.csp');
$category_util = GRN_Workflow_Category_Controller_Utility::getInstance();

//Check Parent Category ID
require_once('workflow/resources.csp');
$parent_category_id = $parent_category_id ? $parent_category_id
    : GRN_WORKFLOW_CATEGORY_ROOT_ID;

//Create Parameter Translation Map
$translation_map = [
    'cid'  => '_id',
    'name' => 'name',
];

//Get Parent Category for View
$parent_category_for_view = $category_util->getView($parent_category_id,
    $translation_map, GRN_WORKFLOW_ACCESS_TYPE_SYSTEM);

//Get Child Category List for View
$child_category_list_for_view
    = $category_util->getChildListView($parent_category_id, $translation_map,
    GRN_WORKFLOW_ACCESS_TYPE_SYSTEM);

//Create Category Information
$category_information_for_view = $parent_category_for_view;
foreach ($child_category_list_for_view as $child_category_for_view) {
    $category_information_for_view['child_categories'][$child_category_for_view['cid']]
        = $child_category_for_view['name'];
}

//Assign Portlet Display Infomation
//Assign Parent Category Name
$t->assign('category', $category_information_for_view);
