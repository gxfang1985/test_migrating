<?php

use grn\grn\JSONResponse;

if (0 == strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST')) {
    global $G_state_set;
    $G_state_set->set('html_should_be_closed', false);
    $G_state_set->set('copyright_should_be_written', false);
    $G_state_set->set('error_page_type', 'json');

    global $G_INPUT;

    $petition_id = cb_at($G_INPUT, 'petition_id', '');

    $json = JSONResponse::create();

    $response = ['status' => 'ok'];

    require_once('workflow/controller_util.csp');

    $wf_controller = new GRN_Workflow_ControllerUtil();

    $wf_controller->registerSchedule($petition_id);

    $json->response($response);
    cb_safe_exit();
}
