<?php

// Smarty をインスタンス化
require_once("grn/smarty.csp");
$t = new GRN_Smarty;
// for site position
$t->assign('app_id', 'schedule');

// SmartyValidate should be initialized when an input form is there.
require('SmartyValidate.class.php');
SmartyValidate::connect($t);

//------------------

require_once('schedule/system_logic.csp');
$logic = GRN_Schedule_SystemLogic::getInstance();

$t->assign('unit', $logic->getScheduleUnit());
$t->assign('limitmonths', $logic->getRepeatLimit());
if ($logic->getUsePrivate() == '1') {
    $t->assign('private', true);
    $t->assign('private_initial_setting_disabled', false);
} else {
    $t->assign('private', false);
    $t->assign('private_initial_setting_disabled', true);
}

if ($logic->getHiddenPrivate() == '1') {
    $t->assign('hideprivate', true);
} else {
    $t->assign('hideprivate', false);
}

if ($logic->getManagedNotify() == '1') {
    $t->assign('managednotify', true);
} else {
    $t->assign('managednotify', false);
}

if ($logic->getShowOrganize() == '1') {
    $t->assign('showorganization', true);
} else {
    $t->assign('showorganization', false);
}


if ($logic->getShowHoliday() == '1') {
    $t->assign('publicholiday', true);
} else {
    $t->assign('publicholiday', false);
}

if ($logic->getAllowAllFacilities() == '1') {
    $t->assign('allowallfacilities', true);
} else {
    $t->assign('allowallfacilities', false);
}

if ($logic->getAllowFacilitiesName() == '1') {
    $t->assign('allowfacilitiesname', true);
} else {
    $t->assign('allowfacilitiesname', false);
}

if ($logic->getAllowFacilitiesNameOnRight() == '1') {
    $t->assign('nameonright', true);
} else {
    $t->assign('nameonright', false);
}

if ($logic->getActivateDragDrop() == '1') {
    $t->assign('activateDragDrop', 1);
} else {
    $t->assign('activateDragDrop', 0);
}

//GTM-1136
if ($logic->getAllowFileAttachment() == '1') {
    $t->assign('allow_file_attachment', 1);
} else {
    $t->assign('allow_file_attachment', 0);
}
//End GTM-1136

//GTM-1621
if ($logic->getAllowAttendanceCheck() == '1') {
    $t->assign('allow_attendance_check', true);
} else {
    $t->assign('allow_attendance_check', false);
}

if ($logic->getDefaultAttendanceCheck() == '1') {
    $t->assign('default_attendance_check', true);
} else {
    $t->assign('default_attendance_check', false);
}
//End GTM-1621

if ($logic->getDefaultPrivateSet() == GRN_PRIVATE_SETTING_PUBLIC) {
    $t->assign('default_public', true);
    $t->assign('default_private', false);
    $t->assign('default_setted', false);
} elseif ($logic->getDefaultPrivateSet() == GRN_PRIVATE_SETTING_PRIVATE) {
    $t->assign('default_public', false);
    $t->assign('default_private', true);
    $t->assign('default_setted', false);
} else {
    $t->assign('default_public', false);
    $t->assign('default_private', false);
    $t->assign('default_setted', true);
}

if ($logic->getAllowSettingGroupRoleToWatchers()) {
    $t->assign('allow_setting_group_role_to_watchers', true);
} else {
    $t->assign('allow_setting_group_role_to_watchers', false);
}


/*
GRN2-1931

if( $logic->getRegisterCheckAbsence() == '1' )
{
    $t->assign( 'registercheckabsence', TRUE );
}
else
{
    $t->assign( 'registercheckabsence', FALSE );
}

if( $logic->getDefault_checkabsence() == '1' )
{
    $t->assign( 'default_checkabsence', TRUE );
}
else
{
    $t->assign( 'default_checkabsence', FALSE );
}
*/

//------------------

// page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);
// site position 
$t->assign('site_position', [['page' => '', 'name' => $page_title]]);

// Smarty実行
$t->display(cb_get_pagename() . ".tpl");

