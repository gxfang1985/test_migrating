<?php
/**
 * システム設定 V-CUBE連携の設定
 *
 * @create:
 *    2011/06/08 VCBSCH0010 Sync for V-CUBE
 */

// Smarty をインスタンス化
require_once("grn/smarty.csp");
$t = new GRN_Smarty;
// for site position
$t->assign('app_id', 'schedule');

// SmartyValidate should be initialized when an input form is there.
require('SmartyValidate.class.php');
SmartyValidate::connect($t);
SmartyValidate::register_form('schedule/system/netmeeting_set', true);

//------------------

require_once('schedule/netmeeting_system_logic.csp');
$logic = GRN_Netmeeting_SystemLogic::getInstance();

$available = $logic->getNetmeetingAvailable();
if ( ! $available) {
    $available = '0';
}
$netmeeting_vcube_version = $logic->getNetmeetingVersion();
// 招待URLの表示
$invite_url_schedule_display = $logic->getNetmeetingUrlDisplay();
if ( ! $invite_url_schedule_display) {
    $invite_url_schedule_display = '0';
}
// 招待URLのE-mail通知
$invite_url_email_notification = $logic->getNetmeetingUrlMailSend();
if ( ! $invite_url_email_notification) {
    $invite_url_email_notification = '0';
}
// 外部招待者入力欄表示行数
$outside_member_input_rows = $logic->getNetmeetingOutsideMemberInputRows();

// V-CUBEシステムURL
$netmeeting_meeting_system_url = $logic->getNetmeetingURL();

// V-CUBEログイン情報取得
$login_info = $logic->getLoginItem();
// ログインID
$netmeeting_login_id = $login_info['id'];
// パスワード
$netmeeting_login_password = $login_info['pw'];

include('_netmeeting_set.csp');

// Smarty実行
$t->display(cb_get_pagename() . ".tpl");

