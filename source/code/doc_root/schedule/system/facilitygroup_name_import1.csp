<?php

// instantiate an Smarty object
require_once('grn/smarty.csp');
$t = new GRN_Smarty;
// for site position
$t->assign('app_id', 'schedule');

require('SmartyValidate.class.php');
SmartyValidate::connect($t);
SmartyValidate::register_form(cb_get_pagename(), true);

global $G_INPUT;

//-- set page title and site position
require_once('fw/session_manager.csp');

// �Z�b�V�����Ɋ֘A�t���ăt�@�C����ۑ�����B���AID �����񂪕ԋp�����B
$session_manager = CB_SessionManager::getInstance();
$session = $session_manager->getSession(cb_get_pagename());
// ��������ߋ��̃Z�b�V�����t�@�C�����폜
$file_infos = $session->getFiles('facilitygroup_name_files');
if (is_array($file_infos)) {
    foreach (array_keys($file_infos) as $id) {
        $session->unsetFile('facilitygroup_name_files', $id);
    }
}
$session->unset_by('import_option');

$t->assign('skip', @ $G_INPUT['skip']);
$t->assign('charset', @ $G_INPUT['charset']);

// page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);

// site position
$t->assign(
    'site_position', [
        [
            'page' => 'schedule/system/import_index',
            'name' => grn_get_page_display_name('schedule/system/import_index')
        ],
        ['page' => '', 'name' => $page_title]
    ]
);

if (array_key_exists('charset', $G_INPUT)) {
    $t->assign('charset', $G_INPUT['charset']);
}

if (array_key_exists('skip', $G_INPUT)) {
    $t->assign('skip', $G_INPUT['skip']);
}


// Display Smarty Template
$doc_name = cb_get_pagename();
$t->display("{$doc_name}.tpl");

