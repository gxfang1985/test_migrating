<?php

require_once('portal/error_code.csp');
if ( ! isset($portlet)) {
    cb_throw_error(E_GRN_PRTL_PORTLET_INVALID_ACCESS);
}

//Get Smarty Instance
require_once('grn/smarty.csp');
$t = new GRN_Smarty;

include('_member_select.csp');

if ($display == 'set-personal') {
    $page_name = 'schedule/portlet/set_personal_day/personal';
    $t->assign('page_name', 'schedule/portlet/set_personal_day/personal');
    $t->assign('form_name', 'schedule/portlet/set_personal_day/personal');
} elseif ($display == 'set-operation') {
    $page_name = 'schedule/portlet/set_personal_day/operation';
    $t->assign('page_name', 'schedule/portlet/set_personal_day/operation');
    $t->assign('form_name', 'schedule/portlet/set_personal_day/operation');
} else {
    $page_name = 'schedule/portlet/set_personal_day/system';
    $t->assign('page_name', 'schedule/portlet/set_personal_day/system');
    $t->assign('form_name', 'schedule/portlet/set_personal_day/system');
}

// Assign Portlet Settings Infomation
$t->assign('settings', $portlet_settings);

//Assign include_php Parameter
$t->assign('portlet', $portlet);
$t->assign('display', $display);

// Assign Font Options
$t->assign('font_options', $font_options);

//-- set page title and site position

// Ignore Licence Warnning
$t->skipWarning();

$doc_name = 'schedule/portlet/set_personal_day';

/////////////////////////////////////////////////
// For tree
require_once('schedule/portlet_view_util.csp');
$tree_data
    = GRN_Schedule_Portlet_Dropdown_Util::makeFacilityGroupsTreeMenu($page_name,
    'f', true);

$t->assign('fgroup_list', $tree_data['org']);
$t->assign('fgroup_selected_id', $tree_data['selected_id']);
$t->assign('ftree_name', $page_name);
if ($display == 'set-system') {
    $t->assign('ftree_async_page', "schedule/system/json/facility_tree");
} else {
    $t->assign('ftree_async_page', "schedule/json/accessible_facility_tree");
}
//Display Smarty Template
$t->display("{$doc_name}.tpl");


