<?php

use grn\grn\mobile\MobileScreenCommon;
use grn\schedule\screen\mobile\ScheduleCommentDelete;
use grn\grn\JSONResponse;

if (strcasecmp(@$_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    global $G_INPUT;
    $screen = new MobileScreenCommon(new ScheduleCommentDelete($G_INPUT));

    global $G_state_set;
    $G_state_set->set('error_page_type', 'json');

    $screen->post($G_INPUT);

    $json = JSONResponse::create();
    $params = [
        'event'       => cb_at($G_INPUT, 'event'),
        'bdate'       => cb_at($G_INPUT, 'bdate'),
        'uid'         => cb_at($G_INPUT, 'uid'),
        'gid'         => cb_at($G_INPUT, 'gid'),
        'referer_key' => cb_at($G_INPUT, 'referer_key')
    ];
    $json->response([
        'redirect' => cb_format_url('schedule/mobile/view', $params,
            'comment_top')
    ]);
}
