<?php

if (strcasecmp(@ $_SERVER['REQUEST_METHOD'], 'POST') == 0) {
    //Get Session
    require_once('fw/session_manager.csp');
    $session_manager = CB_SessionManager::getInstance();

    require_once('grn/controller.csp');
    $tmp_key = grn_get_temporary_key();

    $session_key = 'schedule-mobile-change-page-' . $tmp_key;
    $G_INPUT['session_key'] = $session_key;
    $session =& $session_manager->getSession($session_key);
    $session->set('G_INPUT_Session', $G_INPUT);

    grn_get_attached_file_info($session_key, 'schedule');

    $page_name = cb_at($G_INPUT, 'page_name');
    switch ($page_name) {
        case 'banner':
            $page_url = 'schedule/mobile/banner_add';
            break;
        case 'repeat':
            $page_url = 'schedule/mobile/repeat_add';
            break;
        default:
            $page_url = 'schedule/mobile/add';
    }
    cb_redirect($page_url, ['redirect_key' => $session_key]);
}
