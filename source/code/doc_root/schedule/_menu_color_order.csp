<?php

global $G_INPUT;

if ( ! isset($t) || ! is_a($t, 'GRN_Smarty')) {
    require_once('grn/smarty.csp');
    $t = new GRN_Smarty();
}

$menu_for_view = [];
require_once('schedule/system_logic.csp');
$logic = GRN_Schedule_SystemLogic::getInstance();
$menus = $logic->getMenus();

if (count($menus) > 0) {
    $children_for_view = [];

    foreach (array_keys($menus) as $cid) {    //support : two items the same menu-name, and menu-color
        $children_for_view[";#" . $menus[$cid][1] . ";#" . $cid]
            = $menus[$cid][0];
    }
    $menu_for_view['children'] = $children_for_view;
}
if (0 == count($menus)) {
    cb_redirect('schedule/system/menu_set');
    //cb_throw_error(E_GRN_SCHD_NOT_FOUND_MENU);
}
$t->assign('category', $menu_for_view);


