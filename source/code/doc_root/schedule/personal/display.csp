<?php

// Smarty をインスタンス化
require_once("grn/smarty.csp");
$t = new GRN_Smarty;
// for site position
$t->assign('app_id', 'schedule');

//------------------
global $G_container_base;
$uum = $G_container_base->getInstance('uum');
$login = $uum->getLoginUser();

require_once("schedule/personal_logic.csp");
$logic = GRN_Schedule_PersonalLogic::getInstance();

$sethour = 8;
$endhour = 19;
$logic->getViewHour($login, $sethour, $endhour);

// 右に月曜日を表示するかどうか
$t->assign('sundayalign', $logic->getCalendarWeekStart($login));

// 終了時間を表示するかどうか
$t->assign('showendtime', $logic->getShowEndTime($login));

if ($logic->getUsingDragDrop($login) == '1') {
    $t->assign('usingDragDrop', 1);
} else {
    $t->assign('usingDragDrop', 0);
}

require_once('schedule/system_logic.csp');
$system_logic = GRN_Schedule_SystemLogic::getInstance();
if ($system_logic->getActivateDragDrop() == '1') {
    $t->assign('activateDragDrop', true);
} else {
    $t->assign('activateDragDrop', false);
}

// page title
$page_title = grn_get_current_page_display_name();
$t->assign('page_title', $page_title);
// site position 
$t->assign('site_position', [['page' => '', 'name' => $page_title]]);

// select menu
$t->assign(
    'select1', [
        'name'     => 'sethour',
        'options'  => [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
        ],
        'padding'  => '0',
        'selected' => $sethour,
    ]
);

// select menu
$t->assign(
    'select2', [
        'name'     => 'endhour',
        'options'  => [
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
        ],
        'padding'  => '0',
        'selected' => $endhour,
    ]
);

// Smarty実行
$doc_name = cb_get_pagename();
$t->display("{$doc_name}.tpl");

