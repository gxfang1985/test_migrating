<?php

use grn\fts\BulkCommandKeys;
use grn\fts\ChildProcessRunner;
use grn\fts\bulletin\BulkArticleIndexer as ArticleIndexer;
use grn\fts\bulletin\BulkFileIndexer as BulletinFileIndexer;
use grn\fts\bulletin\BulkFollowIndexer as BulletinFollowIndexer;
use grn\fts\cabinet\BulkFileIndexer as CabinetFileIndexer;
use grn\fts\mail\BulkMessageIndexer as MailIndexer;
use grn\fts\mail\BulkReceiveFileIndexer as ReceiveFileIndexer;
use grn\fts\mail\BulkSendFileIndexer as SendFileIndexer;
use grn\fts\message\BulkMessageIndexer as MessageIndexer;
use grn\fts\message\BulkFileIndexer as MessageFileIndexer;
use grn\fts\message\BulkFollowIndexer as MessageFollowIndexer;
use grn\fts\message\BulkFolderMessageRelationIndexer as MessageUserFolderIndexer;
use grn\fts\space\BulkFileIndexer as SpaceFileIndexer;
use grn\fts\space\BulkDiscussionCommentIndexer as DiscussionCommentIndexer;
use grn\fts\space\BulkDiscussionIndexer as DiscussionIndexer;
use grn\fts\space\BulkSpaceIndexer as SpaceIndexer;
use grn\fts\space\BulkTodoCommentIndexer as TodoCommentIndexer;
use grn\fts\space\BulkTodoIndexer as TodoIndexer;

global $G_INPUT;
assert('isset($G_INPUT["command"])');

$childProcessRunner = new ChildProcessRunner();
$childProcessRunner->addCommander(BulkCommandKeys::BULLETIN_ARTICLE,
    new ArticleIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::BULLETIN_FILE,
    new BulletinFileIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::BULLETIN_FOLLOW,
    new BulletinFollowIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::CABINET_FILE,
    new CabinetFileIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::MAIL_MESSAGE,
    new MailIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::MAIL_RECEIVE_FILE,
    new ReceiveFileIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::MAIL_SEND_FILE,
    new SendFileIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::MESSAGE_FOLDER_RELATION,
    new MessageUserFolderIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::MESSAGE_MESSAGE,
    new MessageIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::MESSAGE_FILE,
    new MessageFileIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::MESSAGE_FOLLOW,
    new MessageFollowIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::SPACE_FILE,
    new SpaceFileIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::SPACE_DISCUSSION_COMMENT,
    new DiscussionCommentIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::SPACE_DISCUSSION,
    new DiscussionIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::SPACE_SPACE,
    new SpaceIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::SPACE_TODO_COMMENT,
    new TodoCommentIndexer($G_INPUT));
$childProcessRunner->addCommander(BulkCommandKeys::SPACE_TODO,
    new TodoIndexer($G_INPUT));

$childProcessRunner->run($G_INPUT['command']);
