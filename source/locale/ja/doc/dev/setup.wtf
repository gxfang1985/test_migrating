[[概要|section:abstract]]

フレームワークのソースは CVS で管理されています。CVS からチェックアウトしてきたソースツリーの動作をブラウザから直接確認するための作業が''開発環境のセットアップ''です。

開発環境のセットアップはソース管理された製品(ここではアゼリア本体 or [[製品開発用アーカイブ|doc:dev/utility/product_archive]] )のコードとインストールしたアゼリアを連動させるために必須です。そのため製品を開発する際には必ず一度は実行する必要があります。

以下は手動で連動させるための手順です。アゼリアには、セットアップ手順を簡易にするための[[ツール|run:developer/env]]が付属しているのでWindows環境ではそれを利用できます。

[[セットアップツール|section:tool]]
これを使用すると、製品コードのベースディレクトリ( code, locale. page ) などを配下にもつディレクトリを指定するだけで簡単に開発環境のセットアップを行うことができます。( この操作はローカルのwindowsマシンに対してのみ実行することができます。)

尚、webrootの設定に関しては、webサーバの設定ファイルに変更が必要なため行いません。もし、必要であればそこは各自行ってください。

unix上で実行しようとしたり(パーミッションの関係上禁止している)、存在しないディレクトリや不正なディレクトリ( 配下にcode, locale, pageなどが存在しない )ものを選択しようとすると例外が発生します。

また、事故を防ぐために、php.iniの書き換えに関しては、オリジナルのファイルが同ディレクトリにphp.ini.originalとしてバックアップされます。なにか問題が発生した場合は、このファイルをリネームして戻すことによって元の状態に戻せます。

[[手動での設定|section:tool]]

ここでは開発環境のセットアップの仕様を含めて、手動で設定するためにはどのようにすればよいのかを説明します。

#azalea をインストールする
#製品のソースを CVS から取得する
#インストールしたazaleaを CVS から取得したソースと連動させる

アゼリアのインストーラーは [[こちら|cb6:page=FileIndex&fCID=86422]] にて公開されていますので、ダウンロードして指示通りにインストールしてください。アゼリア自身を開発する場合、[[構成管理|doc:fw/scm]] に関してはこちらにかいてあるので、それを参照しながら、ソースをチェックアウトしてください。

インストールした azalea と CVS 管理下のソースと連動させるには、以下の各項目をマッピングする必要があります。
*PHP の doc_root
*PHP の インクルードディレクトリ(include, pear, smarty)
*PHP の auto_prepend_file, auto_append_file
*[[common.ini|doc:ext/config#common.ini]] のコピー
*(オプション) web_root の設定

[[PHP の doc_root|head:]]
CGI をインストールした先にある "''php.ini''" ファイル中の設定を書換えて、CVS管理ディレクトリの "code/doc_root" を参照させる。

[[src]]
{{;doc_root = C:\Inetpub\scripts\cbfw\code\doc_root}}
doc_root = C:\...\azalea_win\code\doc_root
[[/src]]

[[PHP の インクルードディレクトリ|head:]]
CGI をインストールした先にある "''php.ini''" ファイル中の設定を書換えて、CVS管理ディレクトリの "code/{include,pear,smarty/libs}" を参照させる。

[[src]]
{{;include_path = "C:\Inetpub\scripts\cbfw\code\include;
                   C:\Inetpub\scripts\cbfw\code\pear;
                   C:\Inetpub\scripts\cbfw\code\smarty\libs"}}
include_path = "C:\...\azalea_win\code\include;
                C:\...\azalea_win\code\pear;
                C:\...\azalea_win\code\smarty\libs"
[[/src]]

[[PHP の auto_prepend_file, auto_append_file|head:]]
CGI をインストールした先にある "''php.ini''" ファイル中の設定を書換えて、
CVS管理ディレクトリの "code/include" にある、"prepend.csp", "append.csp" を参照させる。

[[src]]
{{;auto_prepend_file = C:\Inetpub\scripts\cbfw\code\include\prepend.csp}}
{{;auto_append_file = C:\Inetpub\scripts\cbfw\code\include\append.csp}}
auto_prepend_file = C:\...\azalea_win\code\include\prepend.csp
auto_append_file = C:\...\azalea_win\code\include\append.csp
[[/src]]

[[common.ini のコピー|head:]]
"''common.ini''" ファイルは [[デプロイメント規約|doc:ext/deployment]] を利用して検出される。
 そのため、"azalea_win/common.ini" あるいは "azalea_unix/common.ini" となるように CGI ディレクトリからコピーする必要がある。 

例: Windows
[[src]]
cd C:\azalea_win
copy C:\Inetpub\scripts\cbfw\common.ini common.ini
[[/src]]

例: Unix
[[src]]
cd ~/azalea_unix
cp /var/www/cgi-bin/cbfw/common.ini common.ini
[[/src]]

[[web_root の設定|head:]]
さらに画像や CSS ファイルも参照する場合は、CVS管理ディレクトリの "web_root" を "''common.ini''" の "app_path" で指定された先でアクセス可能とするように、HTTP サーバーの''仮想ディレクトリ''を設定する。必要なら "common.ini" を書換える。

[[src]]
{{;app_path = "/cbfw"}}
app_path = "/some/where/to/azalea_win/web_root"
[[/src]]
