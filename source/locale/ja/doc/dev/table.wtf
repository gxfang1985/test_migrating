[[概要|section:abstract]]
Azaleaで使用している内部テーブルの解説を行います。
 [[永続化レイヤー|doc:dev/base/database]] や [[基盤機構|doc:dev/base]]、[[各種API|doc:dev/api]] と
密接に関連しますので、詳細に関しては各セクションを参照してください。

[[テーブル一覧|section:list]]

以下のようにMySQLコマンドを打てば、選択されているデータベース内に作成されているテーブルの一覧を確認することができます。

[[src]]
mysql> ''show tables;''
+-----------------------------+
| Tables_in_cb_cbfw           |
+-----------------------------+
| _table_info                 |
| tab_cb_cacheattribute       |
| tab_cb_cachemodule          |
| tab_cb_dbsession            |
| tab_cb_demobulletincategory |
| tab_cb_demobulletinelement  |
| tab_cb_demobulletinfile     |
| tab_cb_group                |
| tab_cb_logevent             |
| tab_cb_mailpop3uidtable     |
| tab_cb_profileattribute     |
| tab_cb_profilemodule        |
| tab_cb_role                 |
| tab_cb_scheduleevent        |
| tab_cb_sessionfile          |
| tab_cb_user                 |
| tab_cb_usergrouprelation    |
| tab_cb_userrolerelation     |
.....
[[/src]]

一応、テーブルがどのような用途で利用されているかを簡単に説明します。

[[html]]
<table class="cb_doc_table" border="1">

<tr><th width="30%" nowrap>テーブル</th><th width="70%" nowrap>概要</th></tr>

<tr>
<td nowrap>_table_info</td>
<td>
[[永続化レイヤー|doc:dev/base/database]] 管理下のメタテーブル<br>
テーブル名、カラム、インデックス等テーブル構成に関するデータを保存しています。
MySQLではテーブルに関する情報をDDLによって取得することができますが、解析するためにパーズ処理が必要になるため、
永続化レイヤーでは管理を自前で行っています。
</td>
</tr>

<tr>
<td nowrap>tab_cb_profilemodule</td>
<td>
[[プロファイル|doc:dev/api/profile]]で使用する。<br>
階層化されるモジュールを定義している。<br>
LDAPなどreadonlyベースになったとしても、階層化をきちんと表現するため
モジュールと各属性のテーブルが分離されています。

</td>
</tr>

<tr>
<td nowrap>tab_cb_profileattribute</td>
<td>
[[プロファイル|doc:dev/api/profile]]で使用します。<br>
各モジュールに設定された属性を保持する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_cachemodule</td>
<td>
[[キャッシュ機構|doc:dev/api/cache]]で使用する。<br>
階層化されるモジュールを定義している。<br>
プロファイルを同様の構成になっている。
</td>
</tr>

<tr>
<td nowrap>tab_cb_cacheattribute</td>
<td>
[[キャッシュ機構|doc:dev/api/cache]]で使用する。<br>
各モジュールに設定された属性を保持する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_dbsession</td>
<td>
[[セッション管理|doc:dev/base/session]] で使用する。<br>
セッション情報の保存先をファイルからデータベースに変更する際に使用する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_sessionfile</td>
<td>
[[セッション管理|doc:dev/base/session]] で使用する。<br>
セッション利用中にアップロードされたファイル情報を保持する。<br>
(ファイル自体はファイルシステムに保存されメタ情報のみが記録される。)
</td>
</tr>

<tr>
<td nowrap>tab_cb_logevent</td>
<td>
[[ロギング|doc:dev/api/azlogger]]で使用する。<br>
</td>
</tr>

<tr>
<td nowrap>tab_cb_user</td>
<td>
[[UUM|doc:dev/base/uum]] で使用する。<br>
ユーザー情報を保持する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_group</td>
<td>
[[UUM|doc:dev/base/uum]] で使用する。<br>
グループ情報を保持する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_role</td>
<td>
[[UUM|doc:dev/base/uum]] で使用する。<br>
ロール情報を保持する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_usergrouprelation</td>
<td>
[[UUM|doc:dev/base/uum]] で使用する。<br>
ユーザーとグループのリレーションを保持する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_userrolerelation</td>
<td>
[[UUM|doc:dev/base/uum]] で使用する。<br>
ユーザーとロールのリレーションを保持する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_mailpop3uidtable</td>
<td>
[[メール処理|doc:dev/api/mail]] で使用する。
</td>
</tr>

<tr>
<td nowrap>tab_cb_scheduleevent</td>
<td>
[[スケジューリングサービス|doc:dev/base/schedule]]で使用する。<br>
</td>
</tr>

</table>
[[/html]]


[[テーブル詳細|section:detail]]

テーブルの詳細にかんしては、''desc'' で簡単に確認できます。
 カラム名から意味は推測できると思いますので、詳細な説明は行いません。
 各自で確認してください。

[[src]]
mysql> ''desc tab_cb_logevent;''
+-----------------+--------------+------+-----+---------+----------------+
| Field           | Type         | Null | Key | Default | Extra          |
+-----------------+--------------+------+-----+---------+----------------+
| _id             | bigint(20)   |      | PRI | NULL    | auto_increment |
| col_account     | varchar(100) | YES  |     | NULL    |                |
| col_category    | varchar(255) |      | MUL |         |                |
| col_msg         | text         | YES  |     | NULL    |                |
| col_priority    | int(11)      |      | MUL | 0       |                |
| col_remote_addr | varchar(100) | YES  |     | NULL    |                |
| col_remote_host | varchar(100) | YES  |     | NULL    |                |
| col_timestamp   | int(11)      |      | MUL | 0       |                |
| col_user        | varchar(100) | YES  | MUL | NULL    |                |
+-----------------+--------------+------+-----+---------+----------------+
9 rows in set (0.06 sec)
[[/src]]
