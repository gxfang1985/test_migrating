ユーザー管理用CSVファイルへの書き出し プログラム仕様書

0.目次
-------------------------------------------------------------------
    0.目次
    1.サンプルプログラム
        1-(ア) 組織情報
        1-(イ) 組織の所属ユーザー情報
        1-(ウ) ユーザー情報
        1-(エ) ユーザーの所属組織情報
        1-(オ) ユーザーの所持ロール情報
        1-(カ) ロール情報
        1-(キ) ロールの所持ユーザー情報
        1-(ク) 施設予定情報
    2.ガルーン連携（JAVA）用プログラム
        2-(ア) 組織情報
        2-(イ) 組織の所属ユーザー情報
        2-(ウ) ユーザー情報
        2-(エ) ユーザーの所持組織情報
        2-(オ) ユーザーの所持ロール情報
        2-(カ) ロール情報
        2-(キ) ロールの所持ユーザー情報
        2-(ク) 施設予定情報
    3.ガルーン連携（PHP）用プログラム
        3-(ア) 組織情報
        3-(イ) 組織の所属ユーザー情報
        3-(ウ) ユーザー情報
        3-(エ) ユーザーの所属組織情報
        3-(オ) ユーザーの所持ロール情報
        3-(カ) ロール情報
        3-(キ) ロールの所持ユーザー情報
        3-(ク) 施設予定情報
    4.その他
-------------------------------------------------------------------

1.サンプルプログラム
    (ア) 組織情報
        [ファイル名]
            CmdOrganizationExport.java
        [概要]
            コマンドラインよりガルーン２の組織情報を指定したCSVファイルに書き出しを行う。
        [機能]
            コマンドラインよりガルーン２の組織情報を指定したCSVファイルに書き出すことができる。
            指定できるオプションのガイダンスを表示することができる。
            例外発生時は、エラー内容を表示することができる。
        [仕様]
            メソッド
                ・usage        ガイダンスの表示
                    パラメータ    なし
                    戻り値        なし
                    処理          ガイダンスを標準エラー出力に出力する
                ・main メイン処理
                    パラメータ   String args[]  コマンドライン実行する場合の引数
                        ① -h    （ガイダンスの表示用）
                        ② -o    ガルーン２のURL
                        ③ -u    ガルーン２のログイン名
                        ④ -p    ③のパスワード
                        ⑤ -f    書き出すCSVファイルを指定
                        ⑥ -utf8 指定したファイルに書き出す際の文字エンコードをUTF8にする。
                        ⑦ -he   先頭行に項目名を書き出す場合に指定
                        ※②～⑤は、次の要素に値を指定する(例.-u sato)
                        ※⑥～⑦は、要素のみを指定する(例.-utf8)
                        ※①～⑦は、順不同とする
                    戻り値
                        なし
                    処理
                        ① argsの要素数が０の場合は、ガイダンスを表示し処理を抜ける
                        ② args の要素より規定の文字列があった場合は、次の要素を変数に格納する※
                        ③ ガルーン２へ接続、ログイン   (クラス   CoopLink コンストラクタ呼び出し)
                        ④ ガルーン２へパラメータを送信 (メソッド CoopLink.exportOrganization 呼び出し)
                        ⑤ ガルーン２をログアウト       (メソッド CoopLink.logout 呼び出し)
                    特記事項
                        例外が発生した場合は、エラー内容が標準エラー出力に出力される
                        catchしているエラー
                          ・RemoretException
                          ・IOException
                          ・IllegalArgumentException
                          ・NullPointerException
                        ※URL、ログイン名、パスワード、CSVファイルがそれぞれ指定されて
                          いない場合は、標準入力での再入力を求める
                        ※指定されたパラメータ(①～⑦)以外の引数がargsに渡された場合は、ガイダンス
                          を表示し、処理を抜ける
        [使い方]
            #java CmdOrganizationExport -o http://localhost/cgi-bin/cbgrn/grn.cgi 
                                        -u "Administrator" -p "admin"
                                        -f "/usr/ounits.csv" -utf8 -he
            ※実際には１行。

    (イ) 組織の所属ユーザー情報
        [ファイル名]
            CmdOrganizationUserExport.java
        [概要]
            コマンドラインよりガルーン２の組織の所属ユーザー情報を指定したCSVファイルに書き出しを行う。
        [機能]
            コマンドラインよりガルーン２の組織の所属ユーザー情報を指定したCSVファイルに書き出すことができる。
            指定できるオプションのガイダンスを表示することができる。
            例外発生時は、エラー内容を表示することができる。
        [仕様]
            メソッド
                ・usage        ガイダンスの表示
                    パラメータ    なし
                    戻り値        なし
                    処理          ガイダンスを標準エラー出力に出力する
                ・main メイン処理
                    パラメータ   String args[]  コマンドライン実行する場合の引数
                        ① -h    （ガイダンスの表示用）
                        ② -o    ガルーン２のURL
                        ③ -u    ガルーン２のログイン名
                        ④ -p    ③のパスワード
                        ⑤ -f    書き出すCSVファイルを指定
                        ⑥ -utf8 指定したファイルに書き出す際の文字エンコードをUTF8にする。
                        ⑦ -he   先頭行に項目名を書き出す場合に指定
                        ※②～⑤は、次の要素に値を指定する(例.-u sato)
                        ※⑥～⑦は、要素のみを指定する(例.-utf8)
                        ※①～⑦は、順不同とする
                    戻り値
                        なし
                    処理
                        ① argsの要素数が０の場合は、ガイダンスを表示し処理を抜ける
                        ② args の要素より規定の文字列があった場合は、次の要素を変数に格納する※
                        ③ ガルーン２へ接続、ログイン   (クラス   CoopLink コンストラクタ呼び出し)
                        ④ ガルーン２へパラメータを送信 (メソッド CoopLink.exportOrganizationUser 呼び出し)
                        ⑤ ガルーン２をログアウト       (メソッド CoopLink.logout 呼び出し)
                    特記事項
                        例外が発生した場合は、エラー内容が標準エラー出力に出力される
                        catchしているエラー
                          ・RemoretException
                          ・IOException
                          ・IllegalArgumentException
                          ・NullPointerException
                        ※URL、ログイン名、パスワード、CSVファイルがそれぞれ指定されて
                          いない場合は、標準入力での再入力を求める
                        ※指定されたパラメータ(①～⑦)以外の引数がargsに渡された場合は、ガイダンス
                          を表示し、処理を抜ける
        [使い方]
            #java CmdOrganizationUserExport -o http://localhost/cgi-bin/cbgrn/grn.cgi 
                                            -u "Administrator" -p "admin"
                                            -f "/usr/ounit_users.csv" -utf8 -he
            ※実際には１行。

    (ウ) ユーザー情報
        [ファイル名]
            CmdUserExport.java
        [概要]
            コマンドラインよりガルーン２のユーザー情報を指定したCSVファイルに書き出しを行う。
        [機能]
            コマンドラインよりガルーン２のユーザー情報を指定したCSVファイルに書き出すことができる。
            指定できるオプションのガイダンスを表示することができる。
            例外発生時は、エラー内容を表示することができる。
        [仕様]
            メソッド
                ・usage        ガイダンスの表示
                    パラメータ    なし
                    戻り値        なし
                    処理          ガイダンスを標準エラー出力に出力する
                ・main メイン処理
                    パラメータ   String args[]  コマンドライン実行する場合の引数
                        ① -h    （ガイダンスの表示用）
                        ② -o    ガルーン２のURL
                        ③ -u    ガルーン２のログイン名
                        ④ -p    ③のパスワード
                        ⑤ -f    書き出すCSVファイルを指定
                        ⑥ -utf8 指定したファイルに書き出す際の文字エンコードをUTF8にする。
                        ⑦ -he   先頭行に項目名を書き出す場合に指定
                        ※②～⑤は、次の要素に値を指定する(例.-u sato)
                        ※⑥～⑦は、要素のみを指定する(例.-utf8)
                        ※①～⑦は、順不同とする
                    戻り値
                        なし
                    処理
                        ① argsの要素数が０の場合は、ガイダンスを表示し処理を抜ける
                        ② args の要素より規定の文字列があった場合は、次の要素を変数に格納する※
                        ③ ガルーン２へ接続、ログイン   (クラス   CoopLink コンストラクタ呼び出し)
                        ④ ガルーン２へパラメータを送信 (メソッド CoopLink.exportUser 呼び出し)
                        ⑤ ガルーン２をログアウト       (メソッド CoopLink.logout 呼び出し)
                    特記事項
                        例外が発生した場合は、エラー内容が標準エラー出力に出力される
                        catchしているエラー
                          ・RemoretException
                          ・IOException
                          ・IllegalArgumentException
                          ・NullPointerException
                        ※URL、ログイン名、パスワード、CSVファイルがそれぞれ指定されて
                          いない場合は、標準入力での再入力を求める
                        ※指定されたパラメータ(①～⑦)以外の引数がargsに渡された場合は、ガイダンス
                          を表示し、処理を抜ける
        [使い方]
            #java CmdUserExport -o http://localhost/cgi-bin/cbgrn/grn.cgi 
                                -u "Administrator" -p "admin"
                                -f "/usr/users.csv" -utf8 -he
            ※実際には１行。

    (エ) ユーザーの所属組織情報
        [ファイル名]
            CmdUserOrganizationExport.java
        [概要]
            コマンドラインよりガルーン２のユーザーの所属組織情報を指定したCSVファイルに書き出しを行う。
        [機能]
            コマンドラインよりガルーン２のユーザーの所属組織情報を指定したCSVファイルに書き出すことができる。
            指定できるオプションのガイダンスを表示することができる。
            例外発生時は、エラー内容を表示することができる。
        [仕様]
            メソッド
                ・usage        ガイダンスの表示
                    パラメータ    なし
                    戻り値        なし
                    処理          ガイダンスを標準エラー出力に出力する
                ・main メイン処理
                    パラメータ   String args[]  コマンドライン実行する場合の引数
                        ① -h    （ガイダンスの表示用）
                        ② -o    ガルーン２のURL
                        ③ -u    ガルーン２のログイン名
                        ④ -p    ③のパスワード
                        ⑤ -f    書き出すCSVファイルを指定
                        ⑥ -utf8 指定したファイルに書き出す際の文字エンコードをUTF8にする。
                        ⑦ -he   先頭行に項目名を書き出す場合に指定
                        ※②～⑤は、次の要素に値を指定する(例.-u sato)
                        ※⑥～⑦は、要素のみを指定する(例.-utf8)
                        ※①～⑦は、順不同とする
                    戻り値
                        なし
                    処理
                        ① argsの要素数が０の場合は、ガイダンスを表示し処理を抜ける
                        ② args の要素より規定の文字列があった場合は、次の要素を変数に格納する※
                        ③ ガルーン２へ接続、ログイン   (クラス   CoopLink コンストラクタ呼び出し)
                        ④ ガルーン２へパラメータを送信 (メソッド CoopLink.exportUserOrganization 呼び出し)
                        ⑤ ガルーン２をログアウト       (メソッド CoopLink.logout 呼び出し)
                    特記事項
                        例外が発生した場合は、エラー内容が標準エラー出力に出力される
                        catchしているエラー
                          ・RemoretException
                          ・IOException
                          ・IllegalArgumentException
                          ・NullPointerException
                        ※URL、ログイン名、パスワード、CSVファイルがそれぞれ指定されて
                          いない場合は、標準入力での再入力を求める
                        ※指定されたパラメータ(①～⑦)以外の引数がargsに渡された場合は、ガイダンス
                          を表示し、処理を抜ける
        [使い方]
            #java CmdUserOrganizationExport -o http://localhost/cgi-bin/cbgrn/grn.cgi 
                                            -u "Administrator" -p "admin"
                                            -f "/usr/user_ounits.csv" -utf8 -he
            ※実際には１行。

    (オ) ユーザーの所持ロール情報
        [ファイル名]
            CmdUserRoleExport.java
        [概要]
            コマンドラインよりガルーン２のユーザーの所持ロール情報を指定したCSVファイルに書き出しを行う。
        [機能]
            コマンドラインよりガルーン２のユーザーの所持ロール情報を指定したCSVファイルに書き出すことができる。
            指定できるオプションのガイダンスを表示することができる。
            例外発生時は、エラー内容を表示することができる。
        [仕様]
            メソッド
                ・usage        ガイダンスの表示
                    パラメータ    なし
                    戻り値        なし
                    処理          ガイダンスを標準エラー出力に出力する
                ・main メイン処理
                    パラメータ   String args[]  コマンドライン実行する場合の引数
                        ① -h    （ガイダンスの表示用）
                        ② -o    ガルーン２のURL
                        ③ -u    ガルーン２のログイン名
                        ④ -p    ③のパスワード
                        ⑤ -f    書き出すCSVファイルを指定
                        ⑥ -utf8 指定したファイルに書き出す際の文字エンコードをUTF8にする。
                        ⑦ -he   先頭行に項目名を書き出す場合に指定
                        ※②～⑤は、次の要素に値を指定する(例.-u sato)
                        ※⑥～⑦は、要素のみを指定する(例.-utf8)
                        ※①～⑦は、順不同とする
                    戻り値
                        なし
                    処理
                        ① argsの要素数が０の場合は、ガイダンスを表示し処理を抜ける
                        ② args の要素より規定の文字列があった場合は、次の要素を変数に格納する※
                        ③ ガルーン２へ接続、ログイン   (クラス   CoopLink コンストラクタ呼び出し)
                        ④ ガルーン２へパラメータを送信 (メソッド CoopLink.exportUserRole 呼び出し)
                        ⑤ ガルーン２をログアウト       (メソッド CoopLink.logout 呼び出し)
                    特記事項
                        例外が発生した場合は、エラー内容が標準エラー出力に出力される
                        catchしているエラー
                          ・RemoretException
                          ・IOException
                          ・IllegalArgumentException
                          ・NullPointerException
                        ※URL、ログイン名、パスワード、CSVファイルがそれぞれ指定されて
                          いない場合は、標準入力での再入力を求める
                        ※指定されたパラメータ(①～⑦)以外の引数がargsに渡された場合は、ガイダンス
                          を表示し、処理を抜ける
        [使い方]
            #java CmdUserRoleExport -o http://localhost/cgi-bin/cbgrn/grn.cgi 
                                    -u "Administrator" -p "admin"
                                    -f "/usr/user_roles.csv" -utf8 -he
            ※実際には１行。

    (カ) ロール情報
        [ファイル名]
            CmdRoleExport.java
        [概要]
            コマンドラインよりガルーン２のロール情報を指定したCSVファイルに書き出しを行う。
        [機能]
            コマンドラインよりガルーン２のロール情報を指定したCSVファイルに書き出すことができる。
            指定できるオプションのガイダンスを表示することができる。
            例外発生時は、エラー内容を表示することができる。
        [仕様]
            メソッド
                ・usage        ガイダンスの表示
                    パラメータ    なし
                    戻り値        なし
                    処理          ガイダンスを標準エラー出力に出力する
                ・main メイン処理
                    パラメータ   String args[]  コマンドライン実行する場合の引数
                        ① -h    （ガイダンスの表示用）
                        ② -o    ガルーン２のURL
                        ③ -u    ガルーン２のログイン名
                        ④ -p    ③のパスワード
                        ⑤ -f    書き出すCSVファイルを指定
                        ⑥ -utf8 指定したファイルに書き出す際の文字エンコードをUTF8にする。
                        ⑦ -he   先頭行に項目名を書き出す場合に指定
                        ※②～⑤は、次の要素に値を指定する(例.-u sato)
                        ※⑥～⑦は、要素のみを指定する(例.-utf8)
                        ※①～⑦は、順不同とする
                    戻り値
                        なし
                    処理
                        ① argsの要素数が０の場合は、ガイダンスを表示し処理を抜ける
                        ② args の要素より規定の文字列があった場合は、次の要素を変数に格納する※
                        ③ ガルーン２へ接続、ログイン   (クラス   CoopLink コンストラクタ呼び出し)
                        ④ ガルーン２へパラメータを送信 (メソッド CoopLink.exportRole 呼び出し)
                        ⑤ ガルーン２をログアウト       (メソッド CoopLink.logout 呼び出し)
                    特記事項
                        例外が発生した場合は、エラー内容が標準エラー出力に出力される
                        catchしているエラー
                          ・RemoretException
                          ・IOException
                          ・IllegalArgumentException
                          ・NullPointerException
                        ※URL、ログイン名、パスワード、CSVファイルがそれぞれ指定されて
                          いない場合は、標準入力での再入力を求める
                        ※指定されたパラメータ(①～⑦)以外の引数がargsに渡された場合は、ガイダンス
                          を表示し、処理を抜ける
        [使い方]
            #java CmdRoleExport -o http://localhost/cgi-bin/cbgrn/grn.cgi 
                                -u "Administrator" -p "admin"
                                -f "/usr/roles.csv" -utf8 -he
            ※実際には１行。

    (キ) ロールの所持ユーザー情報
        [ファイル名]
            CmdRoleUserExport.java
        [概要]
            コマンドラインよりガルーン２のロールの所持ユーザー情報を指定したCSVファイルに書き出しを行う。
        [機能]
            コマンドラインよりガルーン２のロールの所持ユーザー情報を指定したCSVファイルに書き出すことができる。
            指定できるオプションのガイダンスを表示することができる。
            例外発生時は、エラー内容を表示することができる。
        [仕様]
            メソッド
                ・usage        ガイダンスの表示
                    パラメータ    なし
                    戻り値        なし
                    処理          ガイダンスを標準エラー出力に出力する
                ・main メイン処理
                    パラメータ   String args[]  コマンドライン実行する場合の引数
                        ① -h    （ガイダンスの表示用）
                        ② -o    ガルーン２のURL
                        ③ -u    ガルーン２のログイン名
                        ④ -p    ③のパスワード
                        ⑤ -f    書き出すCSVファイルを指定
                        ⑥ -utf8 指定したファイルに書き出す際の文字エンコードをUTF8にする。
                        ⑦ -he   先頭行に項目名を書き出す場合に指定
                        ※②～⑤は、次の要素に値を指定する(例.-u sato)
                        ※⑥～⑦は、要素のみを指定する(例.-utf8)
                        ※①～⑦は、順不同とする
                    戻り値
                        なし
                    処理
                        ① argsの要素数が０の場合は、ガイダンスを表示し処理を抜ける
                        ② args の要素より規定の文字列があった場合は、次の要素を変数に格納する※
                        ③ ガルーン２へ接続、ログイン   (クラス   CoopLink コンストラクタ呼び出し)
                        ④ ガルーン２へパラメータを送信 (メソッド CoopLink.exportRoleUser 呼び出し)
                        ⑤ ガルーン２をログアウト       (メソッド CoopLink.logout 呼び出し)
                    特記事項
                        例外が発生した場合は、エラー内容が標準エラー出力に出力される
                        catchしているエラー
                          ・RemoretException
                          ・IOException
                          ・IllegalArgumentException
                          ・NullPointerException
                        ※URL、ログイン名、パスワード、CSVファイルがそれぞれ指定されて
                          いない場合は、標準入力での再入力を求める
                        ※指定されたパラメータ(①～⑦)以外の引数がargsに渡された場合は、ガイダンス
                          を表示し、処理を抜ける
        [使い方]
            #java CmdRoleUserExport -o http://localhost/cgi-bin/cbgrn/grn.cgi 
                                    -u "Administrator" -p "admin"
                                    -f "/usr/role_users.csv" -utf8 -he
            ※実際には１行。

    (ク) 施設予定情報
        [ファイル名]
            CmdFacilityScheduleExport.java
        [概要]
            コマンドラインよりガルーン２の施設予定情報を指定したCSVファイルに書き出しを行う。
        [機能]
            コマンドラインよりガルーン２の施設予定情報を指定したCSVファイルに書き出すことができる。
            指定できるオプションのガイダンスを表示することができる。
            例外発生時は、エラー内容を表示することができる。
        [仕様]
            メソッド
                ・usage        ガイダンスの表示
                    パラメータ    なし
                    戻り値        なし
                    処理          ガイダンスを標準エラー出力に出力する
                ・main メイン処理
                    パラメータ   String args[]  コマンドライン実行する場合の引数
                        ① -h    （ガイダンスの表示用）
                        ② -o    ガルーン２のURL
                        ③ -u    ガルーン２のログイン名
                        ④ -p    ③のパスワード
                        ⑤ -f    書き出すCSVファイルを指定
                        ⑥ -fc   書き出す施設コードを指定
                        ⑦ -sd   書き出す予定期間(開始日)を指定(yyyy-mm-dd形式)
                        ⑧ -ed   書き出す予定期間(終了日)を指定(yyyy-mm-dd形式)
                        ⑨ -utf8 指定したファイルに書き出す際の文字エンコードをUTF8にする。
                        ⑩ -he   先頭行に項目名を書き出す場合に指定
                        ⑪ -ad   追加の書き出し項目の書き出しを指定
                        ※②～⑧は、次の要素に値を指定する(例.-u sato)
                        ※⑨～⑪は、要素のみを指定する(例.-utf8)
                        ※①～⑪は、順不同とする
                    戻り値
                        なし
                    処理
                        ① argsの要素数が０の場合は、ガイダンスを表示し処理を抜ける
                        ② args の要素より規定の文字列があった場合は、次の要素を変数に格納する※
                        ③ ガルーン２へ接続、ログイン   (クラス   CoopLink コンストラクタ呼び出し)
                        ④ ガルーン２へパラメータを送信 (メソッド CoopLink.exportFacilitySchedule 呼び出し)
                        ⑤ ガルーン２をログアウト       (メソッド CoopLink.logout 呼び出し)
                    特記事項
                        例外が発生した場合は、エラー内容が標準エラー出力に出力される
                        catchしているエラー
                          ・ParseException
                          ・RemoretException
                          ・IOException
                          ・NullPointerException
                        ※URL、ログイン名、パスワード、CSVファイル、予定期間がそれぞれ指定されて
                          いない場合は、標準入力での再入力を求める
                        ※施設コードが指定されていない場合は、ガイダンスを表示し処理を抜ける
                        ※指定されたパラメータ(①～⑪)以外の引数がargsに渡された場合は、ガイダンス
                          を表示し、処理を抜ける
        [使い方]
            #java CmdFacilityScheduleExport -o http://localhost/cgi-bin/cbgrn/grn.cgi 
                                            -u "Administrator" -p "admin"
                                            -f "/usr/facility.csv"
                                            -sd "2007-1-10" -ed "2007-1-20"
                                            -utf8 -he -ad
            ※実際には１行。

2.ガルーン連携（JAVA）
    (ア) 組織情報
        [クラス]
            jp.co.cybozu.CoopLink (garoon2.jar)
        [メソッド]
            exportOrganization
        [概要]
            指定したパラメータをガルーン２にHTTPリクエストを送信し、ガルーン２からのレスポンスを取得する
        [機能]
            ガルーン２にパラメータをHTTPでPOSTすることができる
            ガルーン２からのレスポンスを取得し、組織情報を取得することができる
            ガルーン２から取得した組織情報を指定したファイルに書き込みます。
            エラーの場合は、例外をthrowする
        [仕様]
            引数
               String filepath           … 書き出すCSVファイルを指定
               boolean sjisEncode        … 指定したファイルに書き出す際の文字エンコードを指定
                                              true :シフトJIS
                                              false:UTF8
               boolean skip              … 先頭行に項目名を書き出すかの有無
                                              true :有
                                              false:無
            戻り値
               なし 
            例外
               IOException               … 接続が確立できない等通信上のエラーが発生した場合 
               RemoteException           … ガルーン２連携用プログラム上でエラーが発生した場合
               
            特記事項
              [送信処理]
               送信先   … CoopLinkコンストラクタで指定されたガルーン２のURL + "/coop/grnOrganization_export"
               送信方法 … POST(multipart/form-data)
               送信パラメータ
                    【パラメータ名】   【値】
                    "system"            固定値 "1"          … システム管理系で行う処理
                                                                 "1":基本システム管理系で管理権限チェック
                    "manage"            固定値 "user"       … 権限チェックをする管理項目
                    "file"              引数   filepathのFileストリーム
                                        (MIMETYPEは、全て application/octet-stream)
                    "skip"              引数   skipFirst    … 先頭行に項目名を書き出すかの有無
                                                                 true :有(値:"1")
                                                                 false:無(値:"0")
                    "charset"           引数   sjisEncoding … 指定したファイルに書き出す際の文字エンコード
                                                                 true :シフトJIS(値:SJIS-win)
                                                                 false:UTF8     (値:UTF8)

              [受信処理]
                CoopLink.fileWrite(java.net.HttpURLConnection hc, String filepath, boolean sjisEncoding)参照
                取得したHTMLを解析
                 エラー
                    HTTPヘッダより"X-Cybozu-Error"フィールド取得 → フィールド有の場合は
                    RemortException発生
                    エラー文言 "failed to download a CSV file.
                                + (ガルーン２エラーNO)"

                    HTML内より"<Header Data><CR><LF>" と "<Footer Data>"に囲まれた文字列取得
                      (文字列の形式…[要素１],[要素２])
                    要素１が1の場合は、RemortException発生
                    エラー文言 "failed to download a CSV file. 
                                + ([要素２])"
                    
                 正常
                    戻り値なし

              [備考]
                 本文の書式は、テキストとする(HTMLを有効にするパラメータは渡さない)

        [呼び出し方]
            ---------------------------------------------------------------------------------------
            String url = http://localhost/cgi-bin/cbgrn/grn.cgi;   　 // ガルーン２のURL
            String user = "sato";                                     // ログインユーザーアカウント
            String password = "sato";                                 // ログインパスワード
            String filepath = "/usr/ounits.csv";                      // ファイルパス
            boolean sjisEncode = true;                                // エンコード指定(true:Shif_JIS,false:UTF-8)
            boolean skip = false;                                     // 先頭行の有無

            // ガルーン２への接続&認証(ガルーン２のURL,ログイン名,パスワード)
            CoopLink grnLink = new CoopLink(url, user, password);

            // ガルーン２にパラメータを送信
            grnLink.exportOrganization(filepath,                      // ファイルパス
                                       skip,                          // 先頭行に項目名の有無(true:有 false:無)
                                       sjisEncode);                   // エンコード指定  (true:Shif_JIS false:UTF-8)

            // ガルーン２との接続終了
            grnLink.logout();
            ---------------------------------------------------------------------------------------

    (イ) 組織の所属ユーザー情報
        [クラス]
            jp.co.cybozu.CoopLink (garoon2.jar)
        [メソッド]
            exportOrganizationUser
        [概要]
            指定したパラメータをガルーン２にHTTPリクエストを送信し、ガルーン２からのレスポンスを取得する
        [機能]
            ガルーン２にパラメータをHTTPでPOSTすることができる
            ガルーン２からのレスポンスを取得し、組織の所属ユーザー情報を取得することができる
            ガルーン２から取得した組織の所属ユーザー情報を指定したファイルに書き込みます。
            エラーの場合は、例外をthrowする
        [仕様]
            引数
               String filepath           … 書き出すCSVファイルを指定
               boolean sjisEncode        … 指定したファイルに書き出す際の文字エンコードを指定
                                              true :シフトJIS
                                              false:UTF8
               boolean skip              … 先頭行に項目名を書き出すかの有無
                                              true :有
                                              false:無
            戻り値
               なし 
            例外
               IOException               … 接続が確立できない等通信上のエラーが発生した場合 
               RemoteException           … ガルーン２連携用プログラム上でエラーが発生した場合
               
            特記事項
              [送信処理]
               送信先   … CoopLinkコンストラクタで指定されたガルーン２のURL + "/coop/grnOrganizationUser_export"
               送信方法 … POST(multipart/form-data)
               送信パラメータ
                    【パラメータ名】   【値】
                    "system"            固定値 "1"          … システム管理系で行う処理
                                                                 "1":基本システム管理系で管理権限チェック
                    "manage"            固定値 "user"       … 権限チェックをする管理項目
                    "file"              引数   filepathのFileストリーム
                                        (MIMETYPEは、全て application/octet-stream)
                    "skip"              引数   skipFirst    … 先頭行に項目名を書き出すかの有無
                                                                 true :有(値:"1")
                                                                 false:無(値:"0")
                    "charset"           引数   sjisEncoding … 指定したファイルに書き出す際の文字エンコード
                                                                 true :シフトJIS(値:SJIS-win)
                                                                 false:UTF8     (値:UTF8)

              [受信処理]
                CoopLink.fileWrite(java.net.HttpURLConnection hc, String filepath, boolean sjisEncoding)参照
                取得したHTMLを解析
                 エラー
                    HTTPヘッダより"X-Cybozu-Error"フィールド取得 → フィールド有の場合は
                    RemortException発生
                    エラー文言 "failed to download a CSV file.
                                + (ガルーン２エラーNO)"

                    HTML内より"<Header Data><CR><LF>" と "<Footer Data>"に囲まれた文字列取得
                      (文字列の形式…[要素１],[要素２])
                    要素１が1の場合は、RemortException発生
                    エラー文言 "failed to download a CSV file. 
                                + ([要素２])"
                    
                 正常
                    戻り値なし

              [備考]
                 本文の書式は、テキストとする(HTMLを有効にするパラメータは渡さない)

        [呼び出し方]
            ---------------------------------------------------------------------------------------
            String url = http://localhost/cgi-bin/cbgrn/grn.cgi;   　 // ガルーン２のURL
            String user = "sato";                                     // ログインユーザーアカウント
            String password = "sato";                                 // ログインパスワード
            String filepath = "/usr/ounit_users.csv";                 // ファイルパス
            boolean sjisEncode = true;                                // エンコード指定(true:Shif_JIS,false:UTF-8)
            boolean skip = false;                                     // 先頭行の有無

            // ガルーン２への接続&認証(ガルーン２のURL,ログイン名,パスワード)
            CoopLink grnLink = new CoopLink(url, user, password);

            // ガルーン２にパラメータを送信
            grnLink.exportOrganizationUser(filepath,                  // ファイルパス
                                           skip,                      // 先頭行に項目名の有無(true:有 false:無)
                                           sjisEncode);               // エンコード指定  (true:Shif_JIS false:UTF-8)

            // ガルーン２との接続終了
            grnLink.logout();
            ---------------------------------------------------------------------------------------

    (ウ) ユーザー情報
        [クラス]
            jp.co.cybozu.CoopLink (garoon2.jar)
        [メソッド]
            exportUser
        [概要]
            指定したパラメータをガルーン２にHTTPリクエストを送信し、ガルーン２からのレスポンスを取得する
        [機能]
            ガルーン２にパラメータをHTTPでPOSTすることができる
            ガルーン２からのレスポンスを取得し、ユーザー情報を取得することができる
            ガルーン２から取得したユーザー情報を指定したファイルに書き込みます。
            エラーの場合は、例外をthrowする
        [仕様]
            引数
               String filepath           … 書き出すCSVファイルを指定
               boolean sjisEncode        … 指定したファイルに書き出す際の文字エンコードを指定
                                              true :シフトJIS
                                              false:UTF8
               boolean skip              … 先頭行に項目名を書き出すかの有無
                                              true :有
                                              false:無
            戻り値
               なし 
            例外
               IOException               … 接続が確立できない等通信上のエラーが発生した場合 
               RemoteException           … ガルーン２連携用プログラム上でエラーが発生した場合
               
            特記事項
              [送信処理]
               送信先   … CoopLinkコンストラクタで指定されたガルーン２のURL + "/coop/grnUser_export"
               送信方法 … POST(multipart/form-data)
               送信パラメータ
                    【パラメータ名】   【値】
                    "system"            固定値 "1"          … システム管理系で行う処理
                                                                 "1":基本システム管理系で管理権限チェック
                    "manage"            固定値 "user"       … 権限チェックをする管理項目
                    "file"              引数   filepathのFileストリーム
                                        (MIMETYPEは、全て application/octet-stream)
                    "skip"              引数   skipFirst    … 先頭行に項目名を書き出すかの有無
                                                                 true :有(値:"1")
                                                                 false:無(値:"0")
                    "charset"           引数   sjisEncoding … 指定したファイルに書き出す際の文字エンコード
                                                                 true :シフトJIS(値:SJIS-win)
                                                                 false:UTF8     (値:UTF8)

              [受信処理]
                CoopLink.fileWrite(java.net.HttpURLConnection hc, String filepath, boolean sjisEncoding)参照
                取得したHTMLを解析
                 エラー
                    HTTPヘッダより"X-Cybozu-Error"フィールド取得 → フィールド有の場合は
                    RemortException発生
                    エラー文言 "failed to download a CSV file.
                                + (ガルーン２エラーNO)"

                    HTML内より"<Header Data><CR><LF>" と "<Footer Data>"に囲まれた文字列取得
                      (文字列の形式…[要素１],[要素２])
                    要素１が1の場合は、RemortException発生
                    エラー文言 "failed to download a CSV file. 
                                + ([要素２])"
                    
                 正常
                    戻り値なし

              [備考]
                 本文の書式は、テキストとする(HTMLを有効にするパラメータは渡さない)

        [呼び出し方]
            ---------------------------------------------------------------------------------------
            String url = http://localhost/cgi-bin/cbgrn/grn.cgi;   　 // ガルーン２のURL
            String user = "sato";                                     // ログインユーザーアカウント
            String password = "sato";                                 // ログインパスワード
            String filepath = "/usr/users.csv";                       // ファイルパス
            boolean sjisEncode = true;                                // エンコード指定(true:Shif_JIS,false:UTF-8)
            boolean skip = false;                                     // 先頭行の有無

            // ガルーン２への接続&認証(ガルーン２のURL,ログイン名,パスワード)
            CoopLink grnLink = new CoopLink(url, user, password);

            // ガルーン２にパラメータを送信
            grnLink.exportUser(filepath,                              // ファイルパス
                               skip,                                  // 先頭行に項目名の有無(true:有 false:無)
                               sjisEncode);                           // エンコード指定  (true:Shif_JIS false:UTF-8)

            // ガルーン２との接続終了
            grnLink.logout();
            ---------------------------------------------------------------------------------------

    (エ) ユーザーの所属組織情報
        [クラス]
            jp.co.cybozu.CoopLink (garoon2.jar)
        [メソッド]
            exportUserOrganization
        [概要]
            指定したパラメータをガルーン２にHTTPリクエストを送信し、ガルーン２からのレスポンスを取得する
        [機能]
            ガルーン２にパラメータとCSVファイルをHTTPでPOSTすることができる
            ガルーン２からのレスポンスを取得し、ユーザーの所属組織情報を取得することができる
            ガルーン２から取得したユーザーの所属組織情報を指定したファイルに書き込みます。
            エラーの場合は、例外をthrowする
        [仕様]
            引数
               String filepath           … 書き出すCSVファイルを指定
               boolean sjisEncode        … 指定したファイルに書き出す際の文字エンコードを指定
                                              true :シフトJIS
                                              false:UTF8
               boolean skip              … 先頭行に項目名を書き出すかの有無
                                              true :有
                                              false:無
            戻り値
               なし 
            例外
               IOException               … 接続が確立できない等通信上のエラーが発生した場合 
               RemoteException           … ガルーン２連携用プログラム上でエラーが発生した場合
               
            特記事項
              [送信処理]
               送信先   … CoopLinkコンストラクタで指定されたガルーン２のURL + "/coop/grnUserOrganization_export"
               送信方法 … POST(multipart/form-data)
               送信パラメータ
                    【パラメータ名】   【値】
                    "system"            固定値 "1"          … システム管理系で行う処理
                                                                 "1":基本システム管理系で管理権限チェック
                    "manage"            固定値 "user"       … 権限チェックをする管理項目
                    "file"              引数   filepathのFileストリーム
                                        (MIMETYPEは、全て application/octet-stream)
                    "skip"              引数   skipFirst    … 先頭行に項目名を書き出すかの有無
                                                                 true :有(値:"1")
                                                                 false:無(値:"0")
                    "charset"           引数   sjisEncoding … 指定したファイルに書き出す際の文字エンコード
                                                                 true :シフトJIS(値:SJIS-win)
                                                                 false:UTF8     (値:UTF8)

              [受信処理]
                CoopLink.fileWrite(java.net.HttpURLConnection hc, String filepath, boolean sjisEncoding)参照
                取得したHTMLを解析
                 エラー
                    HTTPヘッダより"X-Cybozu-Error"フィールド取得 → フィールド有の場合は
                    RemortException発生
                    エラー文言 "failed to download a CSV file.
                                + (ガルーン２エラーNO)"

                    HTML内より"<Header Data><CR><LF>" と "<Footer Data>"に囲まれた文字列取得
                      (文字列の形式…[要素１],[要素２])
                    要素１が1の場合は、RemortException発生
                    エラー文言 "failed to download a CSV file. 
                                + ([要素２])"
                    
                 正常
                    戻り値なし

              [備考]
                 本文の書式は、テキストとする(HTMLを有効にするパラメータは渡さない)

        [呼び出し方]
            ---------------------------------------------------------------------------------------
            String url = http://localhost/cgi-bin/cbgrn/grn.cgi;   　 // ガルーン２のURL
            String user = "sato";                                     // ログインユーザーアカウント
            String password = "sato";                                 // ログインパスワード
            String filepath = "/usr/user_ounits.csv";                 // ファイルパス
            boolean sjisEncode = true;                                // エンコード指定(true:Shif_JIS,false:UTF-8)
            boolean skip = false;                                     // 先頭行の有無

            // ガルーン２への接続&認証(ガルーン２のURL,ログイン名,パスワード)
            CoopLink grnLink = new CoopLink(url, user, password);

            // ガルーン２にパラメータを送信
            grnLink.exportUserOrganization(filepath,                  // ファイルパス
                                           skip,                      // 先頭行に項目名の有無(true:有 false:無)
                                           sjisEncode);               // エンコード指定  (true:Shif_JIS false:UTF-8)

            // ガルーン２との接続終了
            grnLink.logout();
            ---------------------------------------------------------------------------------------

    (オ) ユーザーの所持ロール情報
        [クラス]
            jp.co.cybozu.CoopLink (garoon2.jar)
        [メソッド]
            exportUserRole
        [概要]
            指定したパラメータをガルーン２にHTTPリクエストを送信し、ガルーン２からのレスポンスを取得する
        [機能]
            ガルーン２にパラメータとCSVファイルをHTTPでPOSTすることができる
            ガルーン２からのレスポンスを取得し、ユーザーの所持ロール情報を取得することができる
            ガルーン２から取得したユーザーの所持ロール情報を指定したファイルに書き込みます。
            エラーの場合は、例外をthrowする
        [仕様]
            引数
               String filepath           … 書き出すCSVファイルを指定
               boolean sjisEncode        … 指定したファイルに書き出す際の文字エンコードを指定
                                              true :シフトJIS
                                              false:UTF8
               boolean skip              … 先頭行に項目名を書き出すかの有無
                                              true :有
                                              false:無
            戻り値
               なし 
            例外
               IOException               … 接続が確立できない等通信上のエラーが発生した場合 
               RemoteException           … ガルーン２連携用プログラム上でエラーが発生した場合
               
            特記事項
              [送信処理]
               送信先   … CoopLinkコンストラクタで指定されたガルーン２のURL + "/coop/grnUserRole_export"
               送信方法 … POST(multipart/form-data)
               送信パラメータ
                    【パラメータ名】   【値】
                    "system"            固定値 "1"          … システム管理系で行う処理
                                                                 "1":基本システム管理系で管理権限チェック
                    "manage"            固定値 "user"       … 権限チェックをする管理項目
                    "file"              引数   filepathのFileストリーム
                                        (MIMETYPEは、全て application/octet-stream)
                    "skip"              引数   skipFirst    … 先頭行に項目名を書き出すかの有無
                                                                 true :有(値:"1")
                                                                 false:無(値:"0")
                    "charset"           引数   sjisEncoding … 指定したファイルに書き出す際の文字エンコード
                                                                 true :シフトJIS(値:SJIS-win)
                                                                 false:UTF8     (値:UTF8)

              [受信処理]
                CoopLink.fileWrite(java.net.HttpURLConnection hc, String filepath, boolean sjisEncoding)参照
                取得したHTMLを解析
                 エラー
                    HTTPヘッダより"X-Cybozu-Error"フィールド取得 → フィールド有の場合は
                    RemortException発生
                    エラー文言 "failed to download a CSV file.
                                + (ガルーン２エラーNO)"

                    HTML内より"<Header Data><CR><LF>" と "<Footer Data>"に囲まれた文字列取得
                      (文字列の形式…[要素１],[要素２])
                    要素１が1の場合は、RemortException発生
                    エラー文言 "failed to download a CSV file. 
                                + ([要素２])"
                    
                 正常
                    戻り値なし

              [備考]
                 本文の書式は、テキストとする(HTMLを有効にするパラメータは渡さない)

        [呼び出し方]
            ---------------------------------------------------------------------------------------
            String url = http://localhost/cgi-bin/cbgrn/grn.cgi;   　 // ガルーン２のURL
            String user = "sato";                                     // ログインユーザーアカウント
            String password = "sato";                                 // ログインパスワード
            String filepath = "/usr/user_roles.csv";                  // ファイルパス
            boolean sjisEncode = true;                                // エンコード指定(true:Shif_JIS,false:UTF-8)
            boolean skip = false;                                     // 先頭行の有無

            // ガルーン２への接続&認証(ガルーン２のURL,ログイン名,パスワード)
            CoopLink grnLink = new CoopLink(url, user, password);

            // ガルーン２にパラメータを送信
            grnLink.exportUserRole(filepath,                          // ファイルパス
                                   skip,                              // 先頭行に項目名の有無(true:有 false:無)
                                   sjisEncode);                       // エンコード指定  (true:Shif_JIS false:UTF-8)

            // ガルーン２との接続終了
            grnLink.logout();
            ---------------------------------------------------------------------------------------

    (カ) ロール情報
        [クラス]
            jp.co.cybozu.CoopLink (garoon2.jar)
        [メソッド]
            exportUserRole
        [概要]
            指定したパラメータをガルーン２にHTTPリクエストを送信し、ガルーン２からのレスポンスを取得する
        [機能]
            ガルーン２にパラメータとCSVファイルをHTTPでPOSTすることができる
            ガルーン２からのレスポンスを取得し、ロール情報を取得することができる
            ガルーン２から取得したロール情報を指定したファイルに書き込みます。
            エラーの場合は、例外をthrowする
        [仕様]
            引数
               String filepath           … 書き出すCSVファイルを指定
               boolean sjisEncode        … 指定したファイルに書き出す際の文字エンコードを指定
                                              true :シフトJIS
                                              false:UTF8
               boolean skip              … 先頭行に項目名を書き出すかの有無
                                              true :有
                                              false:無
            戻り値
               なし 
            例外
               IOException               … 接続が確立できない等通信上のエラーが発生した場合 
               RemoteException           … ガルーン２連携用プログラム上でエラーが発生した場合
               
            特記事項
              [送信処理]
               送信先   … CoopLinkコンストラクタで指定されたガルーン２のURL + "/coop/grnRole_export"
               送信方法 … POST(multipart/form-data)
               送信パラメータ
                    【パラメータ名】   【値】
                    "system"            固定値 "1"          … システム管理系で行う処理
                                                                 "1":基本システム管理系で管理権限チェック
                    "manage"            固定値 "user"       … 権限チェックをする管理項目
                    "file"              引数   filepathのFileストリーム
                                        (MIMETYPEは、全て application/octet-stream)
                    "skip"              引数   skipFirst    … 先頭行に項目名を書き出すかの有無
                                                                 true :有(値:"1")
                                                                 false:無(値:"0")
                    "charset"           引数   sjisEncoding … 指定したファイルに書き出す際の文字エンコード
                                                                 true :シフトJIS(値:SJIS-win)
                                                                 false:UTF8     (値:UTF8)

              [受信処理]
                CoopLink.fileWrite(java.net.HttpURLConnection hc, String filepath, boolean sjisEncoding)参照
                取得したHTMLを解析
                 エラー
                    HTTPヘッダより"X-Cybozu-Error"フィールド取得 → フィールド有の場合は
                    RemortException発生
                    エラー文言 "failed to download a CSV file.
                                + (ガルーン２エラーNO)"

                    HTML内より"<Header Data><CR><LF>" と "<Footer Data>"に囲まれた文字列取得
                      (文字列の形式…[要素１],[要素２])
                    要素１が1の場合は、RemortException発生
                    エラー文言 "failed to download a CSV file. 
                                + ([要素２])"
                    
                 正常
                    戻り値なし

              [備考]
                 本文の書式は、テキストとする(HTMLを有効にするパラメータは渡さない)

        [呼び出し方]
            ---------------------------------------------------------------------------------------
            String url = http://localhost/cgi-bin/cbgrn/grn.cgi;   　 // ガルーン２のURL
            String user = "sato";                                     // ログインユーザーアカウント
            String password = "sato";                                 // ログインパスワード
            String filepath = "/usr/roles.csv";                       // ファイルパス
            boolean sjisEncode = true;                                // エンコード指定(true:Shif_JIS,false:UTF-8)
            boolean skip = false;                                     // 先頭行の有無

            // ガルーン２への接続&認証(ガルーン２のURL,ログイン名,パスワード)
            CoopLink grnLink = new CoopLink(url, user, password);

            // ガルーン２にパラメータを送信
            grnLink.exportRole(filepath,                              // ファイルパス
                               skip,                                  // 先頭行に項目名の有無(true:有 false:無)
                               sjisEncode);                           // エンコード指定  (true:Shif_JIS false:UTF-8)

            // ガルーン２との接続終了
            grnLink.logout();
            ---------------------------------------------------------------------------------------

    (キ) ロールの所持ユーザー情報
        [クラス]
            jp.co.cybozu.CoopLink (garoon2.jar)
        [メソッド]
            exportUserRole
        [概要]
            指定したパラメータをガルーン２にHTTPリクエストを送信し、ガルーン２からのレスポンスを取得する
        [機能]
            ガルーン２にパラメータとCSVファイルをHTTPでPOSTすることができる
            ガルーン２からのレスポンスを取得し、ロールの所持ユーザー情報を取得することができる
            ガルーン２から取得したロールの所持ユーザー情報を指定したファイルに書き込みます。
            エラーの場合は、例外をthrowする
        [仕様]
            引数
               String filepath           … 書き出すCSVファイルを指定
               boolean sjisEncode        … 指定したファイルに書き出す際の文字エンコードを指定
                                              true :シフトJIS
                                              false:UTF8
               boolean skip              … 先頭行に項目名を書き出すかの有無
                                              true :有
                                              false:無
            戻り値
               なし 
            例外
               IOException               … 接続が確立できない等通信上のエラーが発生した場合 
               RemoteException           … ガルーン２連携用プログラム上でエラーが発生した場合
               
            特記事項
              [送信処理]
               送信先   … CoopLinkコンストラクタで指定されたガルーン２のURL + "/coop/grnRoleUser_export"
               送信方法 … POST(multipart/form-data)
               送信パラメータ
                    【パラメータ名】   【値】
                    "system"            固定値 "1"          … システム管理系で行う処理
                                                                 "1":基本システム管理系で管理権限チェック
                    "manage"            固定値 "user"       … 権限チェックをする管理項目
                    "file"              引数   filepathのFileストリーム
                                        (MIMETYPEは、全て application/octet-stream)
                    "skip"              引数   skipFirst    … 先頭行に項目名を書き出すかの有無
                                                                 true :有(値:"1")
                                                                 false:無(値:"0")
                    "charset"           引数   sjisEncoding … 指定したファイルに書き出す際の文字エンコード
                                                                 true :シフトJIS(値:SJIS-win)
                                                                 false:UTF8     (値:UTF8)

              [受信処理]
                CoopLink.fileWrite(java.net.HttpURLConnection hc, String filepath, boolean sjisEncoding)参照
                取得したHTMLを解析
                 エラー
                    HTTPヘッダより"X-Cybozu-Error"フィールド取得 → フィールド有の場合は
                    RemortException発生
                    エラー文言 "failed to download a CSV file.
                                + (ガルーン２エラーNO)"

                    HTML内より"<Header Data><CR><LF>" と "<Footer Data>"に囲まれた文字列取得
                      (文字列の形式…[要素１],[要素２])
                    要素１が1の場合は、RemortException発生
                    エラー文言 "failed to download a CSV file. 
                                + ([要素２])"
                    
                 正常
                    戻り値なし

              [備考]
                 本文の書式は、テキストとする(HTMLを有効にするパラメータは渡さない)

        [呼び出し方]
            ---------------------------------------------------------------------------------------
            String url = http://localhost/cgi-bin/cbgrn/grn.cgi;   　 // ガルーン２のURL
            String user = "sato";                                     // ログインユーザーアカウント
            String password = "sato";                                 // ログインパスワード
            String filepath = "/usr/role_users.csv";                  // ファイルパス
            boolean sjisEncode = true;                                // エンコード指定(true:Shif_JIS,false:UTF-8)
            boolean skip = false;                                     // 先頭行の有無

            // ガルーン２への接続&認証(ガルーン２のURL,ログイン名,パスワード)
            CoopLink grnLink = new CoopLink(url, user, password);

            // ガルーン２にパラメータを送信
            grnLink.exportRoleUser(filepath,                          // ファイルパス
                                   skip,                              // 先頭行に項目名の有無(true:有 false:無)
                                   sjisEncode);                       // エンコード指定  (true:Shif_JIS false:UTF-8)

            // ガルーン２との接続終了
            grnLink.logout();
            ---------------------------------------------------------------------------------------

    (ク) 施設予定情報
        [クラス]
            jp.co.cybozu.CoopLink (garoon2.jar)
        [メソッド]
            exportFacilitySchedule
        [概要]
            指定した抽出条件をガルーン２にHTTPリクエストを送信し、ガルーン２からのレスポンスを取得する
        [機能]
            ガルーン２に抽出条件をHTTPでPOSTすることができる
            ガルーン２からのレスポンスを取得し、指定した抽出条件の施設予定情報を取得することができる
            ガルーン２から取得した施設予定情報を指定したファイルに書き込みます。
            エラーの場合は、例外をthrowする
        [仕様]
            引数
               String filepath           … 書き出すCSVファイルを指定
               Collection facility       … 書き出す施設コードを指定
               Calendar sCal             … 書き出す予定期間(開始日)を指定
               Calendar eCal             … 書き出す予定期間(終了日)を指定
               boolean sjisEncode        … 指定したファイルに書き出す際の文字エンコードを指定
                                              true :シフトJIS(値:SJIS-win)
                                              false:UTF8     (値:UTF8)
               boolean skip              … 先頭行に項目名を書き出すかの有無
                                              true :有(値:"1")
                                              false:無(値:"0")
            戻り値
               なし 
            例外
               IOException               … 接続が確立できない等通信上のエラーが発生した場合 
               RemoteException           … ガルーン２連携用プログラム上でエラーが発生した場合
               NullPointerException      … 必須項目のパラメータがNullの場合にエラーが発生
               
            特記事項
              [送信処理]
               送信先   … CoopLinkコンストラクタで指定されたガルーン２のURL + "/coop/grnFacilitySchedule_export"
               送信方法 … POST(multipart/form-data)
               送信パラメータ
                    【パラメータ名】   【値】
                    "system"            固定値 "2"              … システム管理系で行う処理
                                                                     "2":アプリケーション管理系の管理チェック
                    "manage"            固定値 "schedule"       … 権限チェックをする管理項目
                    "start_year"        引数   startDateのYear  … 書き出す予定期間(開始年)
                                                                   startDateがnullの場合は""(空文字)
                    "start_month"       引数   startDateのMonth … 書き出す予定期間(開始月)
                                                                   startDateがnullの場合は""(空文字)
                    "start_day"         引数   startDateのDay   … 書き出す予定期間(開始日)
                                                                   startDateがnullの場合は""(空文字)
                    "end_year"          引数   endDateのYear    … 書き出す予定期間(終了年)
                                                                   endDateがnullの場合は""(空文字)
                    "end_month"         引数   endDateのMonth   … 書き出す予定期間(開始月)
                                                                   endDateがnullの場合は""(空文字)
                    "end_day"           引数   endDateのDay     … 書き出す予定期間(開始日)
                                                                   endDateがnullの場合は""(空文字)
                    "creator"           引数   creator          … 追加の書き出す項目の有無
                                                                     true :有(値:"1")
                                                                     false:無(値:"0")
                    "target[0-n]"       引数   facility         … 書き出す施設コード("facility:" + [施設コード])
                                                                   要素は、String型またはtoString()で施設コードを取得できるObject
                    "item_name"         引数   skipFirst        … 先頭行に項目名を書き出すかの有無
                                                                     true :有(値:"1")
                                                                     false:無(値:"0")
                    "charset"           引数   sjisEncoding     … 指定したファイルに書き出す際の文字エンコード
                                                                     true :シフトJIS(値:SJIS-win)
                                                                     false:UTF8     (値:UTF8)

              [受信処理]
                CoopLink.fileWrite(java.net.HttpURLConnection hc, String filepath, boolean sjisEncoding)参照
                取得したHTMLを解析
                 エラー
                    HTTPヘッダより"X-Cybozu-Error"フィールド取得 → フィールド有の場合は
                    RemortException発生
                    エラー文言 "failed to download a CSV file.
                                + (ガルーン２エラーNO)"

                    HTML内より"<Header Data><CR><LF>" と "<Footer Data>"に囲まれた文字列取得
                      (文字列の形式…[要素１],[要素２])
                    要素１が1の場合は、RemortException発生
                    エラー文言 "failed to download a CSV file. 
                                + ([要素２])"
                    
                 正常
                    戻り値なし

              [備考]
                 本文の書式は、テキストとする(HTMLを有効にするパラメータは渡さない)

        [呼び出し方]
            ---------------------------------------------------------------------------------------
            String url = http://localhost/cgi-bin/cbgrn/grn.cgi;   　 // ガルーン２のURL
            String user = "sato";                                     // ログインユーザーアカウント
            String password = "sato";                                 // ログインパスワード
            String filepath = "/usr/facility.csv";                    // ファイルパス
            boolean sjisEncode = true;                                // エンコード指定(true:Shif_JIS,false:UTF-8)
            boolean skip = false;                                     // 先頭行に項目名の有無
            boolean add = false;                                      // 追加の書き出し項目の有無
            Collection facility = new ArrayList();                    // 施設コード
            facility.add("kaigi");
            Calender sCal = null;                                     // 書き出す予定期間(開始日)
            Calender eCal = null;                                     // 書き出す予定期間(終了日)
            SimpleDateFormat sdf = new SimpleDateFormat();
            sdf.setLenient(false);
            sdf.applyPattern("yyyy-MM-dd");
            sCal = Calender.getInstance();                            // 書き出す予定期間(開始日)
            sCal.clear();
            sCal.setTime(sdf.parse("2007-1-10"));
            eCal = Calender.getInstance();                            // 書き出す予定期間(終了日)
            eCal.clear();
            eCal.setTime(sdf.parse("2007-1-20"));

            // ガルーン２への接続&認証(ガルーン２のURL,ログイン名,パスワード)
            CoopLink grnLink = new CoopLink(url, user, password);

            // ガルーン２にパラメータを送信
            grnLink.exportFacilitySchedule(filepath,                  // ファイルパス
                                           facility,                  // 施設コード
                                           sCal,                      // 書き出す予定期間(開始日)
                                           eCal,                      // 書き出す予定期間(終了日)
                                           skip,                      // 先頭行に項目名の有無(true:有 false:無)
                                           add,                       // 追加の書き出し項目の有無(true:有 false:無)
                                           sjisEncode);               // エンコード指定  (true:Shif_JIS false:UTF-8)

            // ガルーン２との接続終了
            grnLink.logout();
            ---------------------------------------------------------------------------------------

3.ガルーン連携（PHP）
    (ア) 組織情報
        [ファイル名]
            grnOrganization_export.csp
        [概要]
            ガルーン２の組織情報を取得し、送信を行います。
        [機能]
            ガルーン２における組織情報書き出し処理(grn/_export_organization.csp)と同等の機能
        [仕様]
            受信データ仕様
                項目名      |説明
                ------------+--------------------------------------------------
                system      |coopLoginにて使用(固定値:"1")
                            |システム管理系で行う処理(基本システム管理系で管理権限チェック)
                manage      |coopLoginにて使用(固定値:"user")
                            |権限チェックをする管理項目
                charset     |指定したファイルに書き出す際の文字エンコードを指定
                            |  SJIS-win:文字エンコード(シフトJIS)
                            |  UTF8    :文字エンコード(UTF8)
                title       |先頭行に項目名を書き出すかの有無
                            |  "1":有
                            |  "0":無

            処理
              同フォルダ内のcoopLogin.csp をincludeする(ログインチェック、管理権限チェック)
                →ファイルがなければ "PageNotFound"エラー
              ---coopLogin.csp内処理-------------------------------------------------
                  セッションIDよりログインチェック
                  パラメータ["manage"]の管理権限チェック
              -----------------------------------------------------------------------
              組織情報を取得し、送信を行う。
              ガルーン２からの書き出しは、組織情報書き出し処理(grn/_export_organization.csp)で行っています。
              ※指定したファイルへの書き出しは、ガルーン連携（JAVA）用プログラムで行っています。

    (イ) 組織の所属ユーザー情報
        [ファイル名]
            grnOrganizationUser_export.csp
        [概要]
            ガルーン２の組織の所属ユーザー情報を取得し、送信を行います。
        [機能]
            ガルーン２における組織の所属ユーザー情報書き出し処理(grn/_export_organization_user.csp)と同等の機能
        [仕様]
            受信データ仕様
                項目名      |説明
                ------------+--------------------------------------------------
                system      |coopLoginにて使用(固定値:"1")
                            |システム管理系で行う処理(基本システム管理系で管理権限チェック)
                manage      |coopLoginにて使用(固定値:"user")
                            |権限チェックをする管理項目
                charset     |指定したファイルに書き出す際の文字エンコードを指定
                            |  SJIS-win:文字エンコード(シフトJIS)
                            |  UTF8    :文字エンコード(UTF8)
                title       |先頭行に項目名を書き出すかの有無
                            |  "1":有
                            |  "0":無

            処理
              同フォルダ内のcoopLogin.csp をincludeする(ログインチェック、管理権限チェック)
                →ファイルがなければ "PageNotFound"エラー
              ---coopLogin.csp内処理-------------------------------------------------
                  セッションIDよりログインチェック
                  パラメータ["manage"]の管理権限チェック
              -----------------------------------------------------------------------
              組織の所属ユーザー情報を取得し、送信を行う。
              ガルーン２からの書き出しは、組織の所属ユーザー情報書き出し処理(grn/_export_organization_user.csp)で行っています。
              ※指定したファイルへの書き出しは、ガルーン連携（JAVA）用プログラムで行っています。

    (ウ) ユーザー情報
        [ファイル名]
            grnUser_export.csp
        [概要]
            ガルーン２のユーザー情報を取得し、送信を行います。
        [機能]
            ガルーン２におけるユーザー情報書き出し処理(grn/_export_user.csp)と同等の機能
        [仕様]
            受信データ仕様
                項目名      |説明
                ------------+--------------------------------------------------
                system      |coopLoginにて使用(固定値:"1")
                            |システム管理系で行う処理(基本システム管理系で管理権限チェック)
                manage      |coopLoginにて使用(固定値:"user")
                            |権限チェックをする管理項目
                charset     |指定したファイルに書き出す際の文字エンコードを指定
                            |  SJIS-win:文字エンコード(シフトJIS)
                            |  UTF8    :文字エンコード(UTF8)
                title       |先頭行に項目名を書き出すかの有無
                            |  "1":有
                            |  "0":無

            処理
              同フォルダ内のcoopLogin.csp をincludeする(ログインチェック、管理権限チェック)
                →ファイルがなければ "PageNotFound"エラー
              ---coopLogin.csp内処理-------------------------------------------------
                  セッションIDよりログインチェック
                  パラメータ["manage"]の管理権限チェック
              -----------------------------------------------------------------------
              ユーザー情報を取得し、送信を行う。
              ガルーン２からの書き出しは、ユーザー情報書き出し処理(grn/_export_user.csp)で行っています。
              ※指定したファイルへの書き出しは、ガルーン連携（JAVA）用プログラムで行っています。

    (エ) ユーザーの所属組織情報
        [ファイル名]
            grnUserOrganization_export.csp
        [概要]
            ガルーン２のユーザーの所属組織情報を取得し、送信を行います。
        [機能]
            ガルーン２におけるユーザーの所属組織情報書き出し処理(grn/_export_user_organization.csp)と同等の機能
        [仕様]
            受信データ仕様
                項目名      |説明
                ------------+--------------------------------------------------
                system      |coopLoginにて使用(固定値:"1")
                            |システム管理系で行う処理(基本システム管理系で管理権限チェック)
                manage      |coopLoginにて使用(固定値:"user")
                            |権限チェックをする管理項目
                charset     |指定したファイルに書き出す際の文字エンコードを指定
                            |  SJIS-win:文字エンコード(シフトJIS)
                            |  UTF8    :文字エンコード(UTF8)
                title       |先頭行に項目名を書き出すかの有無
                            |  "1":有
                            |  "0":無

            処理
              同フォルダ内のcoopLogin.csp をincludeする(ログインチェック、管理権限チェック)
                →ファイルがなければ "PageNotFound"エラー
              ---coopLogin.csp内処理-------------------------------------------------
                  セッションIDよりログインチェック
                  パラメータ["manage"]の管理権限チェック
              -----------------------------------------------------------------------
              ユーザーの所属組織情報を取得し、送信を行う。
              ガルーン２からの書き出しは、ユーザーの所属組織情報書き出し処理(grn/_export_user_organization.csp)で行っています。
              ※指定したファイルへの書き出しは、ガルーン連携（JAVA）用プログラムで行っています。

    (オ) ユーザーの所持ロール情報
        [ファイル名]
            grnUserRole_export.csp
        [概要]
            ガルーン２のユーザーの所持ロール情報を取得し、送信を行います。
        [機能]
            ガルーン２におけるユーザーの所持ロール情報書き出し処理(grn/_export_user_role.csp)と同等の機能
        [仕様]
            受信データ仕様
                項目名      |説明
                ------------+--------------------------------------------------
                system      |coopLoginにて使用(固定値:"1")
                            |システム管理系で行う処理(基本システム管理系で管理権限チェック)
                manage      |coopLoginにて使用(固定値:"user")
                            |権限チェックをする管理項目
                charset     |指定したファイルに書き出す際の文字エンコードを指定
                            |  SJIS-win:文字エンコード(シフトJIS)
                            |  UTF8    :文字エンコード(UTF8)
                title       |先頭行に項目名を書き出すかの有無
                            |  "1":有
                            |  "0":無

            処理
              同フォルダ内のcoopLogin.csp をincludeする(ログインチェック、管理権限チェック)
                →ファイルがなければ "PageNotFound"エラー
              ---coopLogin.csp内処理-------------------------------------------------
                  セッションIDよりログインチェック
                  パラメータ["manage"]の管理権限チェック
              -----------------------------------------------------------------------
              ユーザーの所持ロール情報を取得し、送信を行う。
              ガルーン２からの書き出しは、ユーザーの所持ロール情報書き出し処理(grn/_export_user_role.csp)で行っています。
              ※指定したファイルへの書き出しは、ガルーン連携（JAVA）用プログラムで行っています。

    (カ) ロール情報
        [ファイル名]
            grnRole_export.csp
        [概要]
            ガルーン２のロール情報を取得し、送信を行います。
        [機能]
            ガルーン２におけるロール情報書き出し処理(grn/_export_role.csp)と同等の機能
        [仕様]
            受信データ仕様
                項目名      |説明
                ------------+--------------------------------------------------
                system      |coopLoginにて使用(固定値:"1")
                            |システム管理系で行う処理(基本システム管理系で管理権限チェック)
                manage      |coopLoginにて使用(固定値:"user")
                            |権限チェックをする管理項目
                charset     |指定したファイルに書き出す際の文字エンコードを指定
                            |  SJIS-win:文字エンコード(シフトJIS)
                            |  UTF8    :文字エンコード(UTF8)
                title       |先頭行に項目名を書き出すかの有無
                            |  "1":有
                            |  "0":無

            処理
              同フォルダ内のcoopLogin.csp をincludeする(ログインチェック、管理権限チェック)
                →ファイルがなければ "PageNotFound"エラー
              ---coopLogin.csp内処理-------------------------------------------------
                  セッションIDよりログインチェック
                  パラメータ["manage"]の管理権限チェック
              -----------------------------------------------------------------------
              ロール情報を取得し、送信を行う。
              ガルーン２からの書き出しは、ロール情報書き出し処理(grn/_export_role.csp)で行っています。
              ※指定したファイルへの書き出しは、ガルーン連携（JAVA）用プログラムで行っています。

    (キ) ロールの所持ユーザー情報
        [ファイル名]
            grnRoleUser_export.csp
        [概要]
            ガルーン２のロールの所持ユーザー情報を取得し、送信を行います。
        [機能]
            ガルーン２におけるロールの所持ユーザー情報書き出し処理(grn/_export_role_user.csp)と同等の機能
        [仕様]
            受信データ仕様
                項目名      |説明
                ------------+--------------------------------------------------
                system      |coopLoginにて使用(固定値:"1")
                            |システム管理系で行う処理(基本システム管理系で管理権限チェック)
                manage      |coopLoginにて使用(固定値:"user")
                            |権限チェックをする管理項目
                charset     |指定したファイルに書き出す際の文字エンコードを指定
                            |  SJIS-win:文字エンコード(シフトJIS)
                            |  UTF8    :文字エンコード(UTF8)
                title       |先頭行に項目名を書き出すかの有無
                            |  "1":有
                            |  "0":無

            処理
              同フォルダ内のcoopLogin.csp をincludeする(ログインチェック、管理権限チェック)
                →ファイルがなければ "PageNotFound"エラー
              ---coopLogin.csp内処理-------------------------------------------------
                  セッションIDよりログインチェック
                  パラメータ["manage"]の管理権限チェック
              -----------------------------------------------------------------------
              ロールの所持ユーザー情報を取得し、送信を行う。
              ガルーン２からの書き出しは、(grn/_export_role_user.csp)で行っています。
              ※指定したファイルへの書き出しは、ガルーン連携（JAVA）用プログラムで行っています。

    (ク) 施設予定情報
        [ファイル名]
            grnFacilitySchedule_export.csp
        [概要]
            送信された抽出条件を元にガルーン２の施設予定情報を取得し、送信を行います。
        [機能]
            ガルーン２における施設予定書き出し処理(/schedule/system/command_export2.csp)と同等の機能
        [仕様]
            受信データ仕様
                項目名      |説明
                ------------+--------------------------------------------------
                system      |coopLoginにて使用(固定値:"2")
                            |システム管理系で行う処理(アプリケーション管理系で管理権限チェック)
                manage      |coopLoginにて使用(固定値:"schedule")
                            |権限チェックをする管理項目
                start_year  |書き出す予定期間(開始年)
                start_month |書き出す予定期間(開始月)
                start_day   |書き出す予定期間(開始日)
                end_year    |書き出す予定期間(終了年)
                end_month   |書き出す予定期間(終了月)
                end_day     |書き出す予定期間(終了日)
                creator     |追加の書き出す項目の有無
                            |  "1":有
                            |  "0":無
                target[0-n] |書き出す施設コード("facility:" + [施設コード])
                item_name   |先頭行に項目名を書き出すかの有無
                            |  "1":有
                            |  "0":無
                charset     |指定したファイルに書き出す際の文字エンコードを指定
                            |  SJIS-win:文字エンコード(シフトJIS)
                            |  UTF8    :文字エンコード(UTF8)

            処理
              同フォルダ内のcoopLogin.csp をincludeする(ログインチェック、管理権限チェック)
                →ファイルがなければ "PageNotFound"エラー
              ---coopLogin.csp内処理-------------------------------------------------
                  セッションIDよりログインチェック
                  パラメータ["manage"]の管理権限チェック
              -----------------------------------------------------------------------
              アプリケーションの使用/停止状態のチェックを行う。
                →FW00008:スケジュールが停止状態の場合にエラーが発生します。
              書き出す予定期間の日付チェックを行う。
                →GRN_SCHD_13004:開始日付が不正です。
                →GRN_SCHD_13005:終了日付が不正です。
              抽出条件を元にガルーン２の施設予定情報の取得を行います。
              ※指定したファイルへの書き出しは、ガルーン連携（JAVA）用プログラムで行っています。
            備考
              日付のチェック → 以下いづれかに該当する場合は、エラー
                                 システム日付 < 開始日
                                 システム日付 < 終了日
                                 開始日 > 終了日
                                 開始日 > 2030/12/31
                                 終了日 > 2030/12/31
                                 日付でない(ex 2006/12/a)

4.その他
    [環境]
        ・ガルーンサーバー側
            →以下のフォルダにガルーン連携(PHP)用プログラム cspファイル配置
              [ガルーン２インストールディレクトリ]/code/doc_root/coop/grnOrganization_export.csp     (組織情報)
                                                                      grnOrganizationUser_export.csp (組織の所属ユーザー情報)
                                                                      grnUser_export.csp             (ユーザー情報)
                                                                      grnUserOrganization_export.csp (ユーザーの所属組織情報)
                                                                      grnUserRole_export.csp         (ユーザーの所持ロール情報)
                                                                      grnRole_export.csp             (ロール情報)
                                                                      grnRoleUser_export.csp         (ロールの所持ユーザー情報)
                                                                      grnFacilitySchedule_export.csp (施設予定情報)
                                                                      coopLogin.csp                  (全アプリ共通処理)
        ・連携用マシン(ガルーンサーバと兼ねても可)
            jre1.4以降をインストール
            [jreインストールディレクトリ]/lib/ext/にガルーン連携（JAVA）用プログラムgaroon2.jarをコピーもしくは、
            実行時にクラスパスを通す
            サンプルプログラムについては、適当なディレクトリにあれば良し

    [注意事項]
        ・サンプルプログラムについて
            →あくまでもガルーン連携（JAVA）用プログラムgaroon2.jarの使い方の一例としてのプログラム
